'use strict';var Lg;m("mr.IssueSeverity",{Lpa:"fatal",mta:"warning",lra:"notification"},void 0);m("mr.IssueAction",{Apa:"dismiss",Jqa:"learn_more"},void 0);var Mg=function(a,b,c){this.routeId=null;this.severity=b;this.isBlocking="fatal"==this.severity?!0:!1;this.title=a;this.message=null;this.defaultAction=c;this.helpPageId=this.secondaryActions=null};Mg.prototype.Zia=function(a){this.helpPageId=a;return this};Mg.prototype.Fka=function(a){this.secondaryActions=a;return this};
Mg.prototype.OH=function(a){this.message=a;return this};Mg.prototype.eja=function(a){if(!a&&"fatal"==this.severity)throw Error("All FATAL issues must be blocking.");this.isBlocking=a;return this};var Ng=function(a,b){var c=this;this.Is=void 0===b?null:b;this.promise=new Promise(function(b,f){var e=function(a){c.Is=null;f(a)};c.Hfa=e;a(function(a){c.Is=null;b(a)},e)})};Ng.prototype.cancel=function(a){this.Hfa(a);if(this.Is){var b=this.Is;this.Is=null;setTimeout(function(){return b(a)},0)}};
Ng.prototype.nB=function(a,b){b=void 0===b?null:b;var c=this;return new Ng(function(e,f){c.promise.then(function(b){if(a)try{e(a(b))}catch(k){f(k)}else e(b)},function(a){if(b)try{e(b(a))}catch(k){f(k)}else f(a)})},function(a){c.cancel(a)})};Ng.prototype.then=function(a,b){return this.nB(a,void 0===b?null:b)};Ng.prototype.catch=function(a){return this.nB(null,a)};
var Og=function(a){return new Ng(function(b){b(a)})},Pg=function(a){return new Ng(function(b,c){c(a)})},Qg=function(a){return new Ng(function(b,c){a.then(b,c)})},Rg=function(a,b){var c=!1,e=null;return new Ng(function(f,h){a.then(function(a){c||(e=b(a),e.promise.then(f,h))},h)},function(a){e?e.cancel(a):c=!0})};var Sg=function(){return null!=Qb&&-1!=Qb.indexOf("CrOS")},Tg=function(){var a=Qb;if("string"!=typeof a)return!1;a=a.match(/Windows NT \d+.\d+/);if(!(a instanceof Array))return!1;a=a[0];a=a.match(/\d+.\d+/);if(!(a instanceof Array))return!1;a=a[0];return 6.2<=parseFloat(a)},Ug=function(){return Sg()?"ChromeOS":gc?"Windows":fc?"Mac":hc?"Linux":"Other"};var Vg="undefined"!=typeof chrome&&!!chrome.networkingPrivate&&!!chrome.networkingPrivate.setWifiTDLSEnabledState&&Sg(),Wg=Sg()||gc;var Xg=function(a,b,c,e){this.RK=a;this.mf=b;this.lba=c||null;this.vea=e||null};d=Xg.prototype;d.NR=function(){return"tab"==this.RK};d.IR=function(){return"offscreen_tab"==this.RK};d.wI=function(a){return this.NR()?this.VX():this.IR()?this.Hma():this.Fma(a)};d.VX=function(){var a={audio:this.mf.shouldCaptureAudio,video:this.mf.shouldCaptureVideo};this.mf.shouldCaptureVideo&&(a.videoConstraints={mandatory:{enableAutoThrottling:!0}},this.SV(a.videoConstraints.mandatory));return a};
d.Hma=function(){var a=this.VX();a.presentationId=this.vea;return a};d.Fma=function(a){var b={audio:!1,video:!1};this.mf.shouldCaptureVideo&&(b.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:a}},this.SV(b.video.mandatory));Wg&&this.mf.shouldCaptureAudio&&(b.audio={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:a}});return b};
d.SV=function(a){var b=this.mf.minWidth,c=this.mf.minHeight;this.mf.senderSideLetterboxing&&(c=this.mf.nP(),b=c.width,c=c.height);Object.assign(a,{minWidth:b,minHeight:c,maxWidth:this.mf.maxWidth,maxHeight:this.mf.maxHeight,maxFrameRate:this.mf.maxFrameRate})};var Yg=function(a){this.Ja=a;this.yk=Date.now()};Yg.prototype.RC=function(a,b){null!=b&&(a+="_"+b);return a};Yg.prototype.Ap=function(a){this.Ja=a};Yg.prototype.end=function(a){Zg(this.RC(this.Ja,a),Date.now()-this.yk)};var Zg=function(a,b){0>b&&($g.u("Timing analytics event with negative time"),b=0);1E4<b&&(b=1E4);try{chrome.metricsPrivate.recordTime(a,b)}catch(c){$g.u("Failed to record time "+b+" in "+a)}},$g=D("mr.Timing"),ah=function(a){Yg.call(this,a)};ja(ah,Yg);
ah.prototype.end=function(a){a=this.RC(this.Ja,a);var b=Date.now()-this.yk;if(0>b)bh.u("Timing analytics event with negative time");else{1E4>b&&(b=1E4);18E4<b&&(b=18E4);try{chrome.metricsPrivate.recordMediumTime(a,b)}catch(c){bh.u("Failed to record time "+b+" in "+a)}}};var bh=D("mr.MediumTiming"),ch=function(a){Yg.call(this,a)};ja(ch,Yg);
ch.prototype.end=function(a){a=this.RC(this.Ja,a);var b=Date.now()-this.yk;if(0>b)dh.u("Timing analytics event with negative time");else{18E4>b&&(b=18E4);36E5<b&&(b=36E5);try{chrome.metricsPrivate.recordLongTime(a,b)}catch(c){dh.u("Failed to record time "+b+" in "+a)}}};
var dh=D("mr.LongTiming"),eh=D("mr.Analytics"),fh=function(a){try{chrome.metricsPrivate.recordUserAction(a)}catch(b){eh.u("Failed to record event "+a)}},gh=function(a,b,c){var e,f=0,h;for(h in c)f++,c[h]==b&&(e=h);if(e){c={metricName:a,type:"histogram-linear",min:1,max:f,buckets:f+1};try{chrome.metricsPrivate.recordValue(c,b)}catch(k){eh.u("Failed to record enum value "+e+" ("+b+") in "+a,k)}}else eh.error("Unknown analytics value, "+b+" for histogram, "+a,Error())},hh=function(a,b){try{if(0>b)throw Error("Invalid count for "+
a+": "+b);100<b&&eh.u("Small count for "+a+" exceeded limits: "+b,Error());chrome.metricsPrivate.recordSmallCount(a,b)}catch(c){eh.u("Failed to record small count "+a+" ("+b+")",c)}};var ih={apa:0,Yoa:1,cpa:2,Zoa:3,Boa:4,bpa:5,kqa:6,Qsa:7,upa:8,QJ:9},jh=function(a,b){a=Error.call(this,a);this.message=a.message;"stack"in a&&(this.stack=a.stack);this.reason=0<=b&&9>=b?b:9};ja(jh,Error);var kh=function(a){this.An=a;this.rc=this.bp=null;this.a=D("mr.mirror.MirrorMediaStream")};d=kh.prototype;d.KW=function(a){this.bp=a};d.start=function(){return this.An.NR()?this.bma():this.An.IR()?this.Sla():this.Pla()};
d.bma=function(){var a=this,b=this.An.wI();this.a.info("Starting tab capture with constraints "+JSON.stringify(b));return new Promise(function(c,e){chrome.tabCapture.capture(b,function(b){b?(a.aI(b),c(a)):e(a.QL())});window.setTimeout(function(){e(new jh("chrome.tabCapture.capture failed to call its callback",2))},5E3)})};d.D9=function(a){a&&this.a.info(function(){return"Track "+JSON.stringify(a.target)+" ended"});this.stop()};
d.QL=function(){return chrome.runtime.lastError&&chrome.runtime.lastError.message?new jh(chrome.runtime.lastError.message,7):new jh("empty_stream",0)};
d.Pla=function(){var a=this;return(new Promise(function(a,c){var b=["screen","audio"];"Linux"==Ug()&&b.push("window");var f=chrome.desktopCapture.chooseDesktopMedia(b,a);window.setTimeout(function(){chrome.desktopCapture.cancelChooseDesktopMedia(f);c(new jh("timeout",1))},6E4)})).then(function(b){if(!b)throw new jh("User cancelled capture dialog",3);var c=a.An.wI(b);a.a.info(function(){return"Starting desktop capture with constraints "+JSON.stringify(c)});return new Promise(function(a,b){navigator.webkitGetUserMedia(c,
a,function(a){var c=8;if("PermissionDeniedError"==a.name||"NotAllowedError"==a.name)c=3;b(new jh(a.name+" "+a.constraintName+": "+a.message,c))})})}).then(function(b){if(b)a.aI(b);else throw new jh("empty_stream",8);return a})};d.Sla=function(){var a=this,b=this.An.wI();this.a.info(function(){return"Starting offscreen tab capture with constraints "+JSON.stringify(b)});return new Promise(function(c,e){chrome.tabCapture.captureOffscreenTab(a.An.lba.toString(),b,function(b){b?(a.aI(b),c(a)):e(a.QL())})})};
d.aI=function(a){var b=this;this.rc=a;a.getTracks().forEach(function(a){a.onended=b.D9.bind(b)})};d.stop=function(){this.rc&&(this.rc.getTracks().forEach(function(a){a.onended=null;a.stop()}),this.rc=null,this.bp&&this.bp())};var lh,mh={Qqa:0,dpa:1,epa:2,wpa:3,xpa:4,Spa:5,lqa:6,Pqa:7,cra:8,dra:9,Zra:10,usa:11,vsa:12,Esa:13,Psa:14},nh=function(a){void 0==lh&&(gh("MediaRouter.Provider.WakeEvent",a,mh),lh=a)};var qh=function(a){return oh(a)||ph(a)},rh=function(a){if(!Da(a,"http:")&&!Da(a,"https:"))return!1;var b=document.createElement("a");b.href=a;return"http:"!=b.protocol&&"https:"!=b.protocol?!1:-1==b.hash.indexOf("__castAppId__")},sh=["https://docs.google.com"],oh=function(a){return Da(a,"urn:x-org.chromium.media:source:tab:")||-1!=a.indexOf("0F5096E8")},ph=function(a){return"urn:x-org.chromium.media:source:desktop"==a};var th=function(a){return(new Promise(function(b){chrome.tabs.get(a,b)})).then(function(b){if(!b)throw Error("No such tab "+a);return b})};var uh=function(){},zh=function(a){vh.info("Loading module "+a);var b=wh.get(a)||null;if(b)return Promise.resolve(b);b=xh.get(a);b||(b=new Ec,xh.set(a,b),yh(a,b));return b.promise},yh=function(a,b){var c=Ah.get(a)||null;if(!c)b.reject(Error("No corresponding bundle for "+a));else if(!Bh.has(c)){var e=Ch.get(c);e||(vh.info("Loading bundle "+c+" for module "+a),e=Dh(c),Ch.set(c,e));e.catch(function(a){b.reject(a)})}},Dh=function(a){var b=new Ec;b.promise.then(function(){vh.info("Bundle "+a+" loaded")},
function(b){vh.error("Failed to load bundle "+a);throw b;});var c=document.createElement("script");c.src=chrome.extension.getURL(a);c.setAttribute("type","text/javascript");c.async=!0;c.onload=function(){return b.resolve(void 0)};c.onerror=function(){return b.reject(Error("Failed to load bundle "+a))};document.head.appendChild(c);return b.promise},Eh=function(a,b){if(wh.has(a))throw Error("Duplicate module "+a);wh.set(a,b);(a=xh.get(a))&&a.resolve(b)};
uh.prototype.handleEvent=function(a,b){for(var c=1;c<arguments.length;++c);throw Error("Not implemented");};
var Ah=new Map([["mr.cast.SinkDiscoveryService","background_script.js"],["mr.mirror.cast.Service","mirroring_cast_streaming.js"],["mr.cloud.discovery.CloudSinkDiscoveryService","background_script.js"],["mr.dial.SinkDiscoveryService","background_script.js"],["mr.mirror.hangouts.HangoutsService","mirroring_hangouts.js"],["mr.mirror.hangouts.MeetingsService","mirroring_hangouts.js"],["mr.ProviderManager","background_script.js"],["mr.mirror.webrtc.WebRtcService","mirroring_webrtc.js"]]),Bh=new Set(["background_script.js"]),
vh=D("mr.Module"),wh=new Map,xh=new Map,Ch=new Map;var Fh=chrome.i18n.getMessage("545449835455981095");var Gh=function(a,b){this.ng=a;this.vx=b||null;this.Mg=this.Ma=null;this.A=D("mr.mirror.Service."+a);this.PF=t(this.B9,this);this.ds=!1};ja(Gh,uh);d=Gh.prototype;d.Tb=function(a){this.ds||(this.vx=a,this.ds=!0,this.wv())};d.wv=function(){};d.getName=function(){return this.ng};
d.Kt=function(a,b,c,e,f){var h=this;this.A.info("Start mirroring on route "+a.id);return this.ds?Qg(this.uM(b,a.lf.tabId).then(function(){return h.CX()}).then(function(){var a=Hh(b,c,e);return(new kh(a)).start()}).then(function(b){h.Mg=b;b.KW(function(){h.bp(b)});return f?f(a).promise:a}).then(function(a){if(h.Ma)throw new jh("Cannot start multiple sessions");h.Ma=h.hv(c,a);return h.Ma.start(h.Mg.rc)}).then(function(){oh(b)&&!chrome.tabs.onUpdated.hasListener(h.PF)&&chrome.tabs.onUpdated.addListener(h.PF);
return h.eU(a,b,c)}).then(null,function(a){h.PT(a);return h.kj().then(function(){throw a;})})):Pg(Error("Not initialized"))};d.Mz=function(a,b,c,e,f,h){this.A.info("Update mirroring on route "+a.id);return this.ds?Qg(this.uM(b,f).then(this.R3.bind(this,a,b,c,e,h))):Pg(Error("Not initialized"))};d.uM=function(a,b){return oh(a)?b?th(b).then(function(a){if(!a.active)throw new jh("Tab to be mirrored is not active",7);}):Promise.reject(new jh("BUG: Tab ID is required.")):Promise.resolve()};
d.R3=function(a,b,c,e,f){var h=this;if(!this.Ma)return Promise.reject(new jh("No session to update streams on",7));if(!this.Ma.JX())return Promise.reject(new jh("Session does not support updating stream",7));var k=!1;return Promise.resolve().then(function(){var a=Hh(b,c,e);return(new kh(a)).start()}).then(function(b){var c=h.Mg;h.Mg=b;b.KW(t(h.bp,h,b));k=!0;c.stop();return f?f(a).promise:a}).then(function(a){if(!h.Ma)throw new jh("Session ended while updating stream");h.Ma.zka(a);return h.Ma.uY(h.Mg.rc)}).then(this.eU.bind(this,
a,b,c)).then(null,function(a){h.PT(a);if(k)return h.kj().then(function(){throw a;});throw a;})};
d.eU=function(a,b,c){var e=this;return new Promise(function(f,h){if(e.Ma)if(oh(b))e.Ma.mna(a.lf.tabId).then(function(){e.Ma.ry();e.Zx();f(e.Ma.ki())},function(a){e.A.error("Failed to obtain initial tab info.",a);h(a)});else{if(rh(b)){var k="Capturing "+a.mediaSource;e.Ma.PH(k,k,null);e.Ma.ry();e.EG()}else e.Ma.PH("Capturing Desktop","Capturing Desktop",null),e.Ma.ry(),e.Vx();e.c2(c,e.Mg);f(e.Ma.ki())}else h(new jh("Session gone before executing post-startup steps",7))})};
d.PT=function(a){a.reason=null!=a.reason?a.reason:9;this.A.error("Failed to start mirroring: "+a.message+",  reason = "+a.reason+": "+a.stack);this.Xx(a.reason)};d.bp=function(a){this.Mg==a&&(this.Yx(),this.kj())};d.CX=function(){var a=this;return this.ds?this.kj().then(function(b){b&&a.Wx();return b}):Promise.reject("Not initialized")};
d.kj=function(){var a=this;chrome.tabs.onUpdated.removeListener(this.PF);this.Mg&&(this.Mg.stop(),this.Mg=null);if(!this.Ma)return Promise.resolve(!1);var b=this.Ma;this.Ma=null;return this.SA(b).catch(function(b){return a.A.error("Error in before-cleanup steps",b)}).then(function(){return b.stop()}).catch(function(b){return a.A.error("Error stopping session",b)}).then(function(){a.vx.IF(b.ki().id)}).catch(function(b){return a.A.error("Error in ended callbacks",b)}).then(function(){return!0})};
d.SA=function(){return Promise.resolve()};d.B9=function(a,b,c){nh(14);this.Ma&&this.Ma.tabId&&this.Ma.tabId==a&&("complete"==b.status||b.favIconUrl&&"complete"==c.status)&&(this.Ma.wY(c),this.vx.zT(this.Ma.ki()),this.Ma.ry())};var Hh=function(a,b,c){if(oh(a))return new Xg("tab",b);if(ph(a))return new Xg("desktop",b);if(rh(a)){if(!c)throw new jh("Missing offscreen tab presentation id");return new Xg("offscreen_tab",b,a,c)}throw new jh("Source URN does not suggest a known capture type.");};d=Gh.prototype;
d.c2=function(a,b){a.shouldCaptureAudio&&b.rc&&!b.rc.getAudioTracks().length&&this.vx.ei().send(new Mg(Fh,"notification","dismiss"))};d.hv=function(){};d.Zx=function(){};d.Vx=function(){};d.EG=function(){};d.Wx=function(){};d.Xx=function(){};d.Yx=function(){};d.Ge=function(){return Promise.reject("Not implemented")};var Ih=function(a){this.Gb=a;this.Kw=!1;this.tabId=this.dy=this.iconUrl=null};d=Ih.prototype;d.PH=function(a,b,c){this.Gb.description=a;this.Kw||this.Gb.offTheRecord?this.iconUrl=this.dy=null:(this.dy=b,this.iconUrl=c)};d.ry=function(){this.Kw||this.Gb.offTheRecord||this.sV()};d.mna=function(a){this.tabId=a;return th(a).then(this.wY.bind(this))};d.wY=function(a){this.Kw=a.incognito;this.PH(a.title,Da(a.url,"file://")?"Local content (Tab)":Gc(a.url.match(Fc)[3]||null,!0)+" (Tab)",a.favIconUrl)};
d.ki=function(){return this.Gb};d.zka=function(a){this.Gb=a};d.start=function(){};d.JX=function(){return!1};d.uY=function(){};d.stop=function(){return Promise.resolve()};d.sV=function(){};var Kh=function(){var a=this;this.maxWidth=1920;this.maxHeight=1080;this.minHeight=this.minWidth=180;this.senderSideLetterboxing=!1;this.maxFrameRate=30;this.minVideoBitrate=300;this.maxVideoBitrate=5E3;this.audioBitrate=0;this.maxLatencyMillis=800;this.animatedLatencyMillis=this.minLatencyMillis=400;this.dscpEnabled=fc||hc||Sg()||Tg();this.enableLogging=!0;this.useTdls=!1;this.shouldCaptureAudio=this.shouldCaptureVideo=!0;var b=window.localStorage?window.localStorage.getItem(Jh):null;if(b)try{var c=
JSON.parse(String(b));if(c instanceof Object)this.zY(c),D("mr.mirror.Settings").u(function(){return"Initial mr.mirror.Settings overridden to: "+a.Fz()});else throw Error("localStorage["+Jh+"] does not parse as an Object: "+b);}catch(e){throw D("mr.mirror.Settings").error(Jh+' must be of the form \'{"maxWidth":640, "maxHeight":360}\'.',e),Error("Overrides not parseable.  See ERROR log for details.");}};d=Kh.prototype;d.clone=function(){var a=new Kh;a.zY(this);return a};
d.Fz=function(){return JSON.stringify(this,function(a,b){if(0==a.length||!a.endsWith("_"))return b})};d.zY=function(a){for(var b=ia(Object.keys(a)),c=b.next();!c.done;c=b.next())c=c.value,c.endsWith("_")||typeof a[c]!==typeof this[c]||(this[c]=a[c])};d.vS=function(){this.i2();Object.freeze(this)};
d.i2=function(){var a=screen.width,b=screen.height;this.maxHeight*a<this.maxWidth*b?(a=Math.min(this.maxWidth,a),a-=a%160,b=90*a/160):(b=Math.min(this.maxHeight,b),b-=b%90,a=160*b/90);if(a<Math.max(160,this.minWidth)||b<Math.max(90,this.minHeight))a=Math.max(160,this.minWidth),b=Math.max(90,this.minHeight);this.maxWidth=a;this.maxHeight=b};
d.nP=function(){if(this.Zaa())return{width:this.minWidth,height:this.minHeight};for(var a=this.maxWidth,b=this.maxHeight;0!=b;)var c=a%b,a=b,b=c;b=this.maxWidth/a;a=this.maxHeight/a;if(b<this.minWidth||a<this.minHeight)if(c=Math.max(this.minWidth/b,this.minHeight/a),b*=c,a*=c,b>this.maxWidth||a>this.maxHeight)b=this.maxWidth,a=this.maxHeight;b=Math.round(b);a=Math.round(a);return{width:b,height:a}};
d.Zaa=function(){return 0==this.minHeight||0==this.maxHeight?!1:Math.floor(100*this.minWidth/this.minHeight)==Math.floor(100*this.maxWidth/this.maxHeight)};var Jh="mr.mirror.Settings.Overrides";var Lh=function(a,b){this.type=a;this.data=b},Mh=function(a){a=JSON.parse(a);if(!a.type)throw Error("Invalid message");return new Lh(a.type,a.data)},Nh=function(a,b,c,e){this.description=a;this.settings=b||null;this.mediaConstraints=c||null;this.presentationUrl=e||null};var Ph=function(a,b){this.a=D("cv2.PeerConnection");this.Jaa=Oh;this.R=this.Z2(b);this.KB=this.Q2(a);this.b4=!0;this.BV=new Ec;this.qH=!1;this.zx=0;this.Bw=null;this.YR=this.AF=0;this.ie=!1;this.oT=this.pT=this.DF=this.AT=this.Gba=na};d=Ph.prototype;d.HW=function(a){this.DF=a};d.GW=function(a){this.pT=a};d.FW=function(a){this.oT=a};d.JW=function(a){this.AT=a};d.IW=function(a){this.KB.onmessage=function(b){a(b.data)}};d.Jj=function(){return this.ie};
d.j7=function(a){var b={};b.iceServers=[{url:"stun:stun.l.google.com:19302"}].concat(a);return b};d.Z2=function(a){var b=this.j7(a);a=new webkitRTCPeerConnection(b);a.onicecandidate=t(this.Ls,this);a.sBa=t(this.cca,this);a.oniceconnectionstatechange=t(this.bca,this);this.a.info(function(){return"Created webkitRTCPeerConnnection with config: "+JSON.stringify(b)});return a};d.Q2=function(a){return this.R.createDataChannel(a,{reliable:!1})};d.fha=function(a){"string"==typeof a?this.KB.send(a):this.KB.send(JSON.stringify(a))};
d.start=function(){this.ie||(this.ie=!0,this.iv())};d.stop=function(){this.a.info("Stopping peer connection...");this.ie&&(this.ie=!1,"closed"!=this.R.signalingState&&this.R.close());this.R=null};d.addStream=function(a){this.R.addStream(a)};d.removeStream=function(a){this.ie&&this.R.removeStream(a)};d.iv=function(){var a=this;this.a.info("Sending offer to peer.");this.AF=Date.now();this.R.createOffer(t(this.rW,this),function(b){a.a.u("Error creating offer.",b)},this.Jaa);this.BV.promise.then(function(b){a.AT(b)})};
d.rW=function(a){var b=this;this.a.info(function(){return"Setting local description: "+JSON.stringify(a)});this.R.setLocalDescription(a,function(){b.a.info("Local description set successfully")},function(a){b.a.u("Error setting local description.",a)})};d.N4=function(a){return{type:a.type,sdp:a.sdp}};
d.setRemoteDescription=function(a){var b=this;this.a.C(function(){return"<===: "+JSON.stringify(a)});var c=new RTCSessionDescription(a);this.a.info(function(){return"Setting remote description: "+JSON.stringify(c)});this.R.setRemoteDescription(c,function(){b.a.info("Remote description set successfully.")},function(a){b.a.u("Error setting remote description.",a)})};
d.Ls=function(a){var b=this;a.candidate?(this.zx++,this.YR=Date.now(),1==this.zx?this.Bw=le(function(){b.a.info("ICE candidate gathering timed out.");b.Bw=null;b.eH()},5E3):this.qH&&this.a.u("Received ICE candidate after resolving session description.")):(this.a.info("End of ICE candidates."),Zg("MediaRouter.WebRtc.IceCandidateGathering.Duration.Reported",Date.now()-this.AF),this.eH(),0<this.zx&&Zg("MediaRouter.WebRtc.IceCandidateGathering.Duration.Real",this.YR-this.AF))};
d.cca=function(){"completed"==this.R.iceGatheringState&&this.eH()};d.eH=function(){me(this.Bw);this.Bw=null;this.qH||(this.a.info("Resolving sesion description after gathering "+this.zx+" ICE candidates."),this.BV.resolve(this.N4(this.R.localDescription)),this.qH=!0)};
d.bca=function(a){var b=this;if(this.R){var c=this.R.iceConnectionState;this.a.info("New ICE connection state: "+c+".");"connected"==c?this.DF("iceconnected"):"completed"==c?this.DF("icecompleted"):"failed"==c?(this.a.u(function(){return"Ice connection failed: "+JSON.stringify(a)}),this.pT("icefailed")):"closed"==c?this.oT("iceclosed"):"disconnected"==c&&(this.a.u("Ice connection state is bad."),this.b4&&this.Jj()?(this.a.info("Restarting ICE."),this.R.createOffer(t(this.rW,this),function(a){b.a.u("Error creating new offer.",
a)},Qh)):this.Gba())}};var Oh={mandatory:{OfferToReceiveAudio:!0,OfferToReceiveVideo:!0}},Qh={mandatory:{IceRestart:!0,OfferToReceiveAudio:!0,OfferToReceiveVideo:!0}};na.EX=window.localStorage;
var Rh=0,Th=function(a){return(a=window.localStorage.getItem(Sh(a,!1)))?JSON.parse(a):null},Uh=function(a){return(a=window.localStorage.getItem(Sh(a,!0)))?JSON.parse(a):null},Wh=function(a){if(Vh.has(a.Ca()))throw Error("Duplicate instance name "+a.Ca());Vh.set(a.Ca(),a);a.tb()},bi=function(a){for(var b=0,c=ia(Object.keys(na.EX)),e=c.next();!e.done;e=c.next()){var e=e.value,f=e.length+window.localStorage.getItem(e).length;e.startsWith("mr.")?Rh+=f:b+=f}Xh=a;(window.localStorage.getItem("version")&&window.localStorage.getItem("version")!==
chrome.runtime.getManifest().version||Yh(a))&&Zh();$h.info("initialize: "+Rh+" bytes used, "+b+" other bytes");chrome.runtime.onSuspend.addListener(ai)},Xh=null,$h=D("mr.PersistentDataManager"),Vh=new Map,Sh=function(a,b){return"mr."+(b?"persistent.":"temp.")+a.Ca()},Yh=function(a){return!!window.localStorage.getItem("mrInstanceId")&&window.localStorage.getItem("mrInstanceId")!==a},ai=function(){$h.info("onSuspend");ci("version",chrome.runtime.getManifest().version);Xh&&ci("mrInstanceId",Xh);Vh.forEach(di)},
di=function(a){var b=a.getData();b&&void 0!=b[0]&&ci(Sh(a,!1),JSON.stringify(b[0]));b&&void 0!=b[1]&&ci(Sh(a,!0),JSON.stringify(b[1]))},ci=function(a,b){var c;c=window.localStorage.getItem(a);c=void 0!=c?b.length-c.length:a.length+b.length;52E5<=Rh+c&&($h.u("Unable to write "+c+" bytes"),Zh());52E5<=Rh+c?$h.error("Unable to write "+c+" bytes after clearing temporary"):(window.localStorage.setItem(a,b),Rh+=c)},Zh=function(){for(var a=ia(Object.keys(na.EX)),b=a.next();!b.done;b=a.next())b=b.value,b.startsWith("mr.temp.")&&
(Rh-=b.length+window.localStorage.getItem(b).length,delete window.localStorage[b]);$h.info("removeTemporary_: "+Rh+" bytes used")};var ei=C("Firefox"),fi=Ub()||C("iPod"),gi=C("iPad"),hi=C("Android")&&!(Tb()||C("Firefox")||C("Opera")||C("Silk")),ii=Tb(),ji=C("Safari")&&!(Tb()||C("Coast")||C("Opera")||C("Edge")||C("Silk")||C("Android"))&&!(Ub()||C("iPad")||C("iPod"));var ki=function(){},li=function(a){if(!Da(a,"urn:x-org.chromium:media:route:"))return null;var b=a.substring(31);if(!b)return null;b=Ua(b,"/",2);if(3!=b.length)return null;var c=Ua(b[1],"-",1);if(2!=c.length)return null;var e=new ki;e.iDa=a;e.hU=b[0];e.nCa=c[0];e.LDa=c[1];e.wk=b[2];return e};ki.prototype.V=function(){return this.wk};var mi=function(a,b,c,e,f,h){this.id=a;this.sinkId=b;this.mediaSource=c;this.isLocal=e;this.description=f;this.iconUrl=h;this.allowStop=!0;this.customControllerPath=null;this.forDisplay=!0;this.offTheRecord=!1;this.Ln=e;this.isOffscreenPresentation=!1},ni=function(a,b,c,e,f,h,k){return new mi("urn:x-org.chromium:media:route:"+a+"/"+b+"-"+c+"/"+e,c,e,f,h,k)};var oi=function(a){this.mma=a;this.Wo=1E3*Math.floor(1E6*Math.random())};d=oi.prototype;d.d4=function(){Wh(this)};d.Fr=function(){var a=this.Wo++;0==a&&(a=this.Wo++);return a};d.Ca=function(){return"IdGenerator."+this.mma};d.getData=function(){return[this.Wo]};d.tb=function(){var a=Th(this);a&&(this.Wo=a)};window.navigator.userAgent.match(/Chrome\/([0-9]+)/);var pi=function(a,b){this.type=a;this.entryPoint=b};m("castApp.frontEnd.ExtensionMessage",pi,void 0);var qi=function(a){return"urn:x-cast:com.google.cast."+a},ri=qi("tp.connection"),si=qi("receiver"),ti=qi("remoting"),ui=qi("media"),vi=qi("webrtc"),wi=qi("broadcast"),xi=Nb({Usa:ri,Vsa:qi("tp.heartbeat"),dsa:si,isa:ti,OZ:ui,Sqa:qi("media.universalRemote.optIn"),ota:vi,Poa:wi});var yi=function(a){return"available"==a||"available_rescan"==a};var zi=function(a,b,c,e,f){this.id=a;this.friendlyName=b;this.iconType=void 0===c?"generic":c;this.description=void 0===e?null:e;this.domain=void 0===f?null:f};var Ai=function(a){return y(a,function(a){a=a.toString(16);return 1<a.length?a:"0"+a}).join("")},Bi=function(a){for(var b=[],c=0,e=0;e<a.length;e++){var f=a.charCodeAt(e);128>f?b[c++]=f:(2048>f?b[c++]=f>>6|192:(55296==(f&64512)&&e+1<a.length&&56320==(a.charCodeAt(e+1)&64512)?(f=65536+((f&1023)<<10)+(a.charCodeAt(++e)&1023),b[c++]=f>>18|240,b[c++]=f>>12&63|128):b[c++]=f>>12|224,b[c++]=f>>6&63|128),b[c++]=f&63|128)}return b},Ci=function(a){for(var b=[],c=0,e=0;c<a.length;){var f=a[c++];if(128>f)b[e++]=
String.fromCharCode(f);else if(191<f&&224>f){var h=a[c++];b[e++]=String.fromCharCode((f&31)<<6|h&63)}else if(239<f&&365>f){var h=a[c++],k=a[c++],n=a[c++],f=((f&7)<<18|(h&63)<<12|(k&63)<<6|n&63)-65536;b[e++]=String.fromCharCode(55296+(f>>10));b[e++]=String.fromCharCode(56320+(f&1023))}else h=a[c++],k=a[c++],b[e++]=String.fromCharCode((f&15)<<12|(h&63)<<6|k&63)}return b.join("")};var Di=null,Ei=null,Fi=null,Gi=ac||bc&&!ji||Yb||!ji&&!Zb&&"function"==typeof g.atob,Ii=function(a,b){Hi();b=b?Fi:Di;for(var c=[],e=0;e<a.length;e+=3){var f=a[e],h=e+1<a.length,k=h?a[e+1]:0,n=e+2<a.length,q=n?a[e+2]:0,z=f>>2,f=(f&3)<<4|k>>4,k=(k&15)<<2|q>>6,q=q&63;n||(q=64,h||(k=64));c.push(b[z],b[f],b[k],b[q])}return c.join("")},Ki=function(a,b){if(Gi&&!b)return g.atob(a);var c="";Ji(a,function(a){c+=String.fromCharCode(a)});return c},Li=function(a){var b=new Uint8Array(Math.ceil(3*a.length/4)),c=
0;Ji(a,function(a){b[c++]=a});return b.subarray(0,c)},Ji=function(a,b){function c(b){for(;e<a.length;){var c=a.charAt(e++),f=Ei[c];if(null!=f)return f;if(!Ga(c))throw Error("Unknown base64 encoding at char: "+c);}return b}Hi();for(var e=0;;){var f=c(-1),h=c(0),k=c(64),n=c(64);if(64===n&&-1===f)break;b(f<<2|h>>4);64!=k&&(b(h<<4&240|k>>2),64!=n&&b(k<<6&192|n))}},Hi=function(){if(!Di){Di={};Ei={};Fi={};for(var a=0;65>a;a++)Di[a]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(a),
Ei[Di[a]]=a,Fi[a]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_.".charAt(a),62<=a&&(Ei["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_.".charAt(a)]=a)}};var Mi=function(){this.fd=-1};var Ni=function(){this.fd=64;this.ya=[];this.dB=[];this.Q_=[];this.Hx=[];this.Hx[0]=128;for(var a=1;a<this.fd;++a)this.Hx[a]=0;this.Iz=this.Bo=0;this.reset()};v(Ni,Mi);Ni.prototype.reset=function(){this.ya[0]=1732584193;this.ya[1]=4023233417;this.ya[2]=2562383102;this.ya[3]=271733878;this.ya[4]=3285377520;this.Iz=this.Bo=0};
Ni.prototype.mj=function(a,b){b||(b=0);var c=this.Q_;if(p(a))for(var e=0;16>e;e++)c[e]=a.charCodeAt(b)<<24|a.charCodeAt(b+1)<<16|a.charCodeAt(b+2)<<8|a.charCodeAt(b+3),b+=4;else for(e=0;16>e;e++)c[e]=a[b]<<24|a[b+1]<<16|a[b+2]<<8|a[b+3],b+=4;for(e=16;80>e;e++){var f=c[e-3]^c[e-8]^c[e-14]^c[e-16];c[e]=(f<<1|f>>>31)&4294967295}a=this.ya[0];b=this.ya[1];for(var h=this.ya[2],k=this.ya[3],n=this.ya[4],q,e=0;80>e;e++)40>e?20>e?(f=k^b&(h^k),q=1518500249):(f=b^h^k,q=1859775393):60>e?(f=b&h|k&(b|h),q=2400959708):
(f=b^h^k,q=3395469782),f=(a<<5|a>>>27)+f+n+q+c[e]&4294967295,n=k,k=h,h=(b<<30|b>>>2)&4294967295,b=a,a=f;this.ya[0]=this.ya[0]+a&4294967295;this.ya[1]=this.ya[1]+b&4294967295;this.ya[2]=this.ya[2]+h&4294967295;this.ya[3]=this.ya[3]+k&4294967295;this.ya[4]=this.ya[4]+n&4294967295};
Ni.prototype.update=function(a,b){if(null!=a){l(b)||(b=a.length);for(var c=b-this.fd,e=0,f=this.dB,h=this.Bo;e<b;){if(0==h)for(;e<=c;)this.mj(a,e),e+=this.fd;if(p(a))for(;e<b;){if(f[h]=a.charCodeAt(e),++h,++e,h==this.fd){this.mj(f);h=0;break}}else for(;e<b;)if(f[h]=a[e],++h,++e,h==this.fd){this.mj(f);h=0;break}}this.Bo=h;this.Iz+=b}};
Ni.prototype.digest=function(){var a=[],b=8*this.Iz;56>this.Bo?this.update(this.Hx,56-this.Bo):this.update(this.Hx,this.fd-(this.Bo-56));for(var c=this.fd-1;56<=c;c--)this.dB[c]=b&255,b/=256;this.mj(this.dB);for(c=b=0;5>c;c++)for(var e=24;0<=e;e-=8)a[b]=this.ya[c]>>e&255,++b;return a};var Pi=function(){this.BG=Ra();this.sm=new Oi(null,null);this.rm=new Oi(null,null);this.jC=[];this.Vw=this.Cn=0;Wh(this)};d=Pi.prototype;d.Zn=function(a){a=a.toLowerCase();var b=new Ni;b.update(a);b.update(this.BG);return"r"+Ii(b.digest(),!0)};d.x7=function(){return this.sm.model?this.sm:this.rm.model?this.rm:new Oi(null,null)};d.Ca=function(){return"SinkUtils"};
d.getData=function(){return[{recentLaunchedDevice:this.sm,recentDiscoveredDevice:this.rm},{receiverIdToken:this.BG,fixedIpList:this.jC.join(","),castControlPort:this.Cn,lastCloudSinkCheckTimeMillis:this.Vw}]};
d.tb=function(){var a=Th(this);a&&(this.sm=a.recentLaunchedDevice||new Oi(null,null),this.rm=a.recentDiscoveredDevice||new Oi(null,null));if(a=Uh(this))this.BG=a.receiverIdToken||Ra(),this.jC=a.fixedIpList&&a.fixedIpList.split(",")||[],this.Cn=a.castControlPort||0,this.Vw=a.lastCloudSinkCheckTimeMillis||0};oa(Pi);var Oi=function(a,b){this.model=a;this.ip=b};var Qi=function(a,b){this.xd=this.Rh=this.qj=this.ab=this.Ga=null;this.pf=new zi(Pi.ga().Zn(b),a);this.Yd={};this.Bu={};this.Op=!1};d=Qi.prototype;d.Bj=function(){return this.pf};d.jo=function(){return this.pf.friendlyName};d.yja=function(a){this.xd=a;return this};d.getId=function(){return this.pf.id};d.Iy=function(a){this.pf.id=a;return this};d.kX=function(a){this.Op=a;return this};
d.update=function(a){if(this.getId()!=a.getId())return!1;var b=!1;this.pf.friendlyName!=a.pf.friendlyName&&(this.pf.friendlyName=a.pf.friendlyName,b=!0);this.qj!=a.qj&&(this.qj=a.qj,b=!0);this.Rh!=a.Rh&&(this.Rh=a.Rh,b=!0);this.Ga!=a.Ga&&(this.Ga=a.Ga,b=!0);this.ab!=a.ab&&(this.ab=a.ab,b=!0);return b};d.dja=function(a){this.Ga=a;return this};d.sb=function(){return this.ab};d.Cp=function(a){this.ab=a;return this};d.Dia=function(a){this.qj=a;return this};d.Bia=function(a){this.Rh=a;return this};
d.Pf=function(a){return this.Yd[a]||"unknown"};d.f5=function(a){return this.Bu[a]||null};d.rt=function(a,b){this.Yd[a]=b;this.Bu[a]=Date.now();return this};d.SX=function(){return"name = "+this.pf.friendlyName+(this.Ga?", ip = "+this.Ga:"")+(this.xd?", model = "+this.xd:"")+", apps = "+JSON.stringify(this.Yd)};var Ri=function(a){var b=new Qi(a.pf.friendlyName,"");b.pf.id=a.pf.id;b.Ga=a.Ga;b.ab=a.ab;b.qj=a.qj;b.Rh=a.Rh;b.xd=a.xd;b.Yd=a.Yd;b.Bu=a.Bu;b.Op=a.Op;return b};var Si=function(a,b,c,e,f,h){a=Pi.ga().Zn(a);this.sg=new zi(a,b,this.fQ(e));this.xd=c||null;this.Zd=e||null;this.Ga=f||null;this.ab=h||null;this.Yd={};this.Rn=!1},Ti=function(a){if(!a.xd||!a.Ga)return null;var b=new Si(a.Bj().id,a.Bj().friendlyName,a.xd,void 0,a.Ga,Pi.ga().Cn||8009);b.sg.id=a.Bj().id;b.EH(!0);return b};d=Si.prototype;d.bna=function(a){(a=this.update(a.jo(),a.Ga,a.sb(),a.Zd))&&this.EH(!1);return a};
d.update=function(a,b,c,e){var f=!1;this.sg.friendlyName!=a&&(this.sg.friendlyName=a,f=!0);null!=b&&this.Ga!=b&&(this.Ga=b,f=!0);null!=c&&this.ab!=c&&(this.ab=c,f=!0);null!=e&&this.Zd!=e&&(this.Zd=e,f=!0);return f};d.Bj=function(){return this.sg};d.jo=function(){return this.sg.friendlyName};d.fQ=function(a){return a&1?"cast":a&32?"cast_audio_group":"cast_audio"};d.bia=function(a){this.Zd=a;this.sg.iconType=this.fQ(this.Zd)};d.getId=function(){return this.sg.id};
var Ui=function(a){var b=new Si("",a.friendlyName,a.modelName,a.capabilities,a.ip,a.port);b.sg.id=a.id;b.EH(a.discoveredByDial);b.Yd=a.appStatusMap;for(var c in b.Yd)"unavailable"==b.Yd[c]&&(b.Yd[c]="unavailable_rescan");return b};d=Si.prototype;d.sb=function(){return this.ab};d.Pf=function(a){return this.Yd[a]||"unknown"};d.rt=function(a,b){this.Yd[a]=b};
d.SX=function(){return"name = "+this.sg.friendlyName+(this.Ga?", ip = "+this.Ga:"")+(this.xd?", model = "+this.xd:"")+", capabilities = "+this.Zd+", apps = "+JSON.stringify(this.Yd)};d.EH=function(a){this.Rn=a};var Vi={Iqa:0,zqa:1},Wi={jta:0,l_:1,esa:2},Xi={DIAL:0,Nqa:1,Oqa:2,vpa:3},Yi={sra:0,TIMEOUT:1,FAILED:2},Zi={QJ:0,Eoa:1,lpa:2,Tpa:3,fpa:4,bra:5,opa:6,Qra:7},$i={AZ:0,SUCCESS:1},aj=function(a){gh("MediaRouter.Cast.Session.Ended",a,Wi)},bj=function(a){gh("MediaRouter.Cast.Channel.ConnectResult",a,$i)},cj=function(a){gh("MediaRouter.Cast.Discovery.Type",a,Xi)},dj=function(a){gh("MediaRouter.Cast.Session.Fail",a,Yi)};var ej=function(a,b,c,e,f){for(var h=[],k=4;k<arguments.length;++k)h[k-4]=arguments[k];var n=this;this.Wn=a;this.Ja=b;this.wx=c;this.Pa=e;this.caa=h;this.yo=!1;this.ti=function(a){for(var b=[],c=0;c<arguments.length;++c)b[c-0]=arguments[c];return n.D3.apply(n,[].concat(ka(b)))}};d=ej.prototype;d.o0=function(){Wh(this)};d.L3=function(){this.Pa.addListener.apply(this.Pa,[].concat([this.ti],ka(this.caa)))};d.addListener=function(){this.yo||(this.yo=!0,this.L3())};
d.removeListener=function(){this.yo&&(this.Pa.removeListener(this.ti),this.yo=!1)};d.Tz=function(a){for(var b=0;b<arguments.length;++b);return!0};d.D3=function(a){for(var b=[],c=0;c<arguments.length;++c)b[c-0]=arguments[c];var e=this;nh(this.Wn);if(!this.Tz.apply(this,[].concat(ka(b))))return!1;zh(this.wx).then(function(a){return a.handleEvent.apply(a,[].concat([e.Pa],ka(b)))});return this.MB()};d.Go=function(){return this.yo};d.Ca=function(){return"mr.EventListener."+this.Ja};d.getData=function(){return[this.yo]};
d.tb=function(){Th(this)&&this.addListener()};d.MB=function(){};var fj={serviceType:"_googlecast._tcp.local"},gj=null,hj=function(){gj||(gj=new ej(7,"CastMdnsEventListener","mr.cast.SinkDiscoveryService",chrome.mdns.onServiceList,fj));return gj},ij=null,jj=function(){ij||(ij=Sg()?new ej(9,"CastNetworkListChangedEventListener","mr.cast.SinkDiscoveryService",chrome.networkingPrivate.onNetworkListChanged):new ej(8,"CastNetworksChangedEventListener","mr.cast.SinkDiscoveryService",chrome.networkingPrivate.onNetworksChanged));return ij};var kj=function(a){return Promise.all(a.map(function(a){return a.then(function(a){return{gl:!0,value:a}},function(a){return{gl:!1,reason:a}})}))};var lj=function(a,b){this.he=b;this.TK=a;this.TK.pa=this.pa.bind(this);this.Ud=new H;this.Jp=new H;this.Yj=new H;this.IS=null;this.ls=this.Uj="";this.Mn=null;this.rE=this.bs=!1;this.UL=[];this.a=D("mr.cast.SinkDiscoveryService");this.tv=new Set;this.Ng={vn:0,Lo:0};this.Ip=this.Yw=0};ja(lj,uh);d=lj.prototype;d.init=function(){Wh(this);this.bs&&(this.nS(),this.eN());Eh("mr.cast.SinkDiscoveryService",this)};d.nS=function(){this.a.info("Start listening to network changes");jj().addListener()};
d.start=function(){var a=Date.now(),b=hj();if(b.Go()){if(6E4>a-this.IS)return;this.a.info("Forcing mdns discovery");this.L4()}else this.a.info("Adding mdns listener"),b.addListener();this.IS=a};d.L4=function(){chrome.mdns.forceDiscovery(na);var a=hj();a.removeListener();a.addListener()};
d.handleEvent=function(a,b){for(var c=[],e=1;e<arguments.length;++e)c[e-1]=arguments[e];if(a==chrome.mdns.onServiceList)this.DU.apply(this,[].concat(ka(c)));else if(a==chrome.networkingPrivate.onNetworksChanged||a==chrome.networkingPrivate.onNetworkListChanged)this.eN();else throw Error("Unhandled event");};
d.e3=function(a){if(-1==a.serviceName.indexOf("._googlecast."))return null;var b={};a.serviceData.forEach(function(a){0==a.search(/[a-z]{2}=.+/)&&(b[a.substring(0,2)]=a.substring(3))});var c=b.id;if(!c)return this.a.u("Missing ID"),null;Pi.ga().Zn(c);var e=Number(a.serviceHostPort.substring(a.serviceHostPort.indexOf(":")+1));if(isNaN(e)||0>e||65535<e)return this.a.u("Missing or invalid port"),null;var f=b.fn;if(!f||!a.ipAddress)return this.a.u("Missing friendly name or IP address"),null;var h=Number(b.ca);
return new Si(c,f,b.md||"",isNaN(h)?0:h,a.ipAddress,e)};d.refresh=function(){this.a.C("Executing forceDiscovery.");chrome.mdns.forceDiscovery(na)};d.DU=function(a){var b=this;this.a.info("Registering "+a.length+" devices");0!=this.Ip&&(clearTimeout(this.Ip),this.Ip=0);a=this.f3(a).map(function(a){return b.qB(a,!0)});kj(a).then(function(){b.Ng={vn:b.SD(),Lo:b.D6()};b.Eaa()})};d.Eaa=function(){var a=this;0!=this.Ip||36E5>Date.now()-this.Yw||(this.Ip=setTimeout(function(){return a.O3()},5E3))};
d.O3=function(){var a=this.Ng;hh("MediaRouter.Cast.Discovery.KnownDevicesCount",a.Lo);hh("MediaRouter.Cast.Discovery.ConnectedDevicesCount",a.vn);this.Yw=Date.now();this.Ip=0};d.D6=function(){var a=this,b=this.tv.size;re(this.ul(),function(c){a.tv.has(c.getId())||b++});return b};d.xfa=function(a){this.DU(a);this.UL=a};
d.qB=function(a,b){var c=this;if(this.Yj.Wa(a.getId()))return Promise.resolve();this.Yj.set(a.getId(),a);return this.Cq(a).then(function(e){e?(e=c.Ud.get(a.getId()),b&&(e?e.Rn&&cj(3):cj(1)),c.rq(a)):(c.a.info("Inaccessible sink: "+a.getId()),c.wm(a.getId()));c.Yj.remove(a.getId())})};d.o$=function(a){return void 0!=this.UL.find(function(b){return b.ipAddress==a.ipAddress})};
d.f3=function(a){var b=this,c=[];this.tv.clear();a.forEach(function(a){if(!b.o$(a)&&(a=b.e3(a))){var e=a.getId();b.tv.add(e);if(b.Yj.Wa(e)){var h=b.Yj.get(e);if(h.Ga==a.Ga&&h.sb()==a.sb()){b.a.info("Sink has pending connection "+e);return}b.a.u("Pending sink changed ip "+e);b.Yj.remove(e)}(e=b.Ud.get(e))?e.bna(a)&&b.he.Ee(e):c.push(a)}});return c};
d.kM=function(a){var b=this.Ud.get(a.getId()),c=null,e=a.Ga,f=a.sb();null!=e&&null!=f&&(c=this.Jp.get(e+":"+f));if(b&&!c){var h=a.Ga,k=a.sb();h&&k&&this.Jp.remove(h+":"+k)}c&&!b&&this.Ud.remove(c.getId());this.Ud.set(a.getId(),a);null!=e&&null!=f&&this.Jp.set(e+":"+f,a)};d.rq=function(a){this.a.info("Adding sink "+a.getId());this.kM(a);this.bs||(this.bs=!0,this.nS());this.he.fm(a);Pi.ga().rm=new Oi(a.xd,a.Ga)};d.BF=function(a){this.a.info("Channel error for sink "+a);this.wm(a)};
d.wm=function(a){var b=this.Ud.get(a);if(b){this.a.info("Removing sink "+a);this.Ud.remove(a);a=b.Ga;var c=b.sb();null!=a&&null!=c&&this.Jp.remove(a+":"+c);this.he.Fx(b)}};d.Kfa=function(){var a=this.Ud.T();this.Ud.clear();this.Jp.clear();a.forEach(this.he.Fx,this.he)};d.Cq=function(a){this.a.C("Checking access to "+a.getId());return this.TK.Jn(a).then(function(b){if(a.Rn){var c=4;b.audioOnly||(c|=1);a.bia(c)}return!0},function(){return!1})};
d.Rx=function(){var a=this;this.a.info("Pruning inactive sinks.");re(this.ul(),function(b){a.Yj.set(b.getId(),b);a.Cq(b).then(function(c){c||a.wm(b.getId());a.Yj.remove(b.getId())})})};d.pa=function(a){return this.Ud.get(a,null)};d.X7=function(a,b){return this.Jp.get(a+":"+b)};d.Y7=function(a){var b=[];re(this.ul(),function(c){yi(c.Pf(a))&&b.push(c)});return b};d.ul=function(){return this.Ud.eE()};d.SD=function(){return this.Ud.ma()};d.Ee=function(a){this.he.Ee(a)};d.gf=function(){return this.Ud.T()};
d.Ca=function(){return"cast.SinkDiscoveryService"};d.getData=function(){var a=this,b={};re(this.Ud.KO(),function(c){var e;e=a.Ud.get(c);e={id:e.getId(),ip:e.Ga,port:e.sb(),friendlyName:e.jo(),modelName:e.xd,capabilities:e.Zd,discoveredByDial:e.Rn,appStatusMap:e.Yd};b[c]=e});return[new mj(b,this.ls,this.Ng),new nj(this.bs,this.Yw)]};
d.tb=function(){var a=Th(this);a&&3==a.version&&(this.ls=a.networkIds,this.Ng=a.deviceCounts,this.a$(a.sinkMap));if(a=Uh(this))this.bs=a.hasSavedSinks,this.Yw=a.lastSinkCountMetricRecordTime||0};d.a$=function(a){this.rE=0<Object.keys(a).length;for(var b in a){var c=Ui(a[b]);this.pa(c.getId())||this.kM(c)}this.Rx()};d.laa=function(a){this.rE=0<Object.keys(a).length;for(var b in a){var c=Ui(a[b]);this.pa(c.getId())||this.qB(c,!1)}};
d.eN=function(){var a=this;this.a.info("Fetching networks state");this.Mn&&di(this.Mn);chrome.networkingPrivate.getNetworks({networkType:"All",visible:!0,configured:!0},function(b){for(var c=[],e=0;e<b.length;e++)"Connected"==b[e].ConnectionState&&c.push(b[e].GUID);a.Yma(c.sort().join(","))})};
d.Yma=function(a){this.a.info(function(){return"Update current network "+oj(a)});a!=this.Uj&&(this.Mn&&(Vh.delete(this.Mn.Ca()),this.Mn=null),a?(this.ls&&a!=this.ls?this.Kfa():this.Rx(),this.ls=this.Uj=a,this.Mn=new pj(this,this.Uj)):this.Uj="")};
var oj=function(a){for(var b=0,c=0;c<a.length;c++)b+=a.charCodeAt(c);return b},mj=function(a,b,c){this.sinkMap=a;this.networkIds=b;this.deviceCounts=c;this.version=3},nj=function(a,b){this.hasSavedSinks=a;this.lastSinkCountMetricRecordTime=b},pj=function(a,b){this.Mi=a;this.Uj=b;Wh(this)};pj.prototype.Ca=function(){return"cast.NetworkSink."+this.Uj};
pj.prototype.getData=function(){var a=this,b=null,c=this.Mi.getData();c&&(this.Mi.rE||0<this.Mi.SD())&&(b=c[0]);this.Mi.a.info(function(){return"Saving sink data for network "+oj(a.Uj)});return[null,b]};pj.prototype.tb=function(){var a=this;this.Mi.a.info(function(){return"Restoring sink data for network "+oj(a.Uj)});var b=Uh(this);b&&3==b.version&&this.Mi.laa(b.sinkMap)};var qj={STOP_MEDIA:"STOP",MEDIA_SET_VOLUME:"SET_VOLUME",MEDIA_GET_STATUS:"GET_STATUS"};var rj=function(){this.type="GET_STATUS";this.requestId=0};var sj=function(a,b,c){this.type="APPLICATION_BROADCAST";this.requestId=0;this.appIds=a;this.namespace=b;this.message=c};var tj=function(a){this.type="LAUNCH";this.requestId=0;this.appId=a;this.language=null};var uj=function(a){this.type="STOP";this.requestId=0;this.sessionId=a||null};var vj=function(a,b){this.requestId=a;this.Ema=b;this.QX=null};vj.prototype.EF=function(){};var wj=function(){this.uc=new H};wj.prototype.gK=function(a){var b=this;this.uc.set(a.requestId,a);a.QX=setTimeout(function(){return b.Vca(a)},a.Ema)};wj.prototype.ct=function(a){var b=this.uc.get(a);if(!b)return null;clearTimeout(b.QX);this.uc.remove(a);return b};wj.prototype.ji=function(a){return this.uc.get(a,null)};wj.prototype.Vca=function(a){this.uc.remove(a.requestId);a.EF()};var xj=function(a,b){this.ae=a;this.Ke=b;this.km=new wj;this.SU=new oi("cast.RequestIdGenerator")};d=xj.prototype;d.init=function(){this.SU.d4()};d.hK=function(a,b,c){var e=this.SU.Fr();a.requestId=e;a=new Ec;b=new yj(e,a,r(b)&&0<b?b:6E5,c);this.km.gK(b);return b};d.OG=function(a){this.km.ct(a.requestId)};d.ct=function(a){return this.km.ct(a)};
d.sendRequest=function(a,b,c,e,f,h){var k=this;if(!xi.hasOwnProperty(c))return Promise.reject(Error("Custom namespace is not supported"));var n=this.hK(a,l(e)?e:3E3,f),q=n.Pb;this.ae.Hm(b,c,a,f||this.Ke,h).then(null,function(){k.OG(n);q.reject(zj)});return q.promise};d.sendMessage=function(a,b,c,e,f,h){var k=this,n=this.hK(a,l(e)?e:3E3,f),q=n.Pb;this.ae.Hm(b,c,a,f||this.Ke,h).then(function(){k.OG(n);q.resolve(!0)},function(){k.OG(n);q.reject(zj)});return q.promise};
d.ega=function(a,b){var c=new tj(a.appId);c.language=a.language?a.language:chrome.i18n.getUILanguage?chrome.i18n.getUILanguage():chrome.runtime.getManifest().default_locale;return this.sendRequest(c,b,si,a.requestSessionTimeout)};d.gga=function(a,b){return this.sendRequest(new uj(a),b,si)};d.bha=function(a,b){return this.sendMessage(a,b,wi)};var Aj=Error("Timeout"),zj=Error("Failed to send message"),yj=function(a,b,c,e){vj.call(this,a,c);this.Pb=b;this.sourceId=e};ja(yj,vj);yj.prototype.EF=function(){this.Pb.reject(Aj)};var Bj=function(a,b){this.type="cast_app";this.originId=window["castApp.eventPage.Message.OriginID"]||void 0;this.subtype=a;this.devices=b;this.logRecord=this.deviceJustSetUp=void 0};m("castApp.eventPage.Message",Bj,void 0);var Cj=function(a,b,c){this.ipAddress=a;this.appId=b;this.sessionId=c};Bj.DeviceData=Cj;Bj.DeviceJustSetUp=function(a,b,c,e){this.ipAddress=a;this.name=b;this.udn=c;this.modelName=e};Bj.DeviceCapabilities=function(){};
Bj.LogRecord=function(a,b,c,e){this.levelValue=a;this.msg=b;this.loggerName=c;this.time=e};var Dj=function(a,b){this.Dd=a;this.re=b;this.Qn=new H;this.Pn=new Ee;this.aS=0;this.Vaa=new H("serviceCheck",this.k9.bind(this),"startDeviceMonitor",this.y9.bind(this),"releaseDeviceMonitor",this.e9.bind(this),"deviceJustSetUp",this.K8.bind(this),"logRecord",this.T8.bind(this));chrome.runtime.onMessage.addListener(this.Y8.bind(this));chrome.runtime.onMessageExternal.addListener(this.N8.bind(this));this.ph("serviceReady")};d=Dj.prototype;d.a=D("castApp.eventPage.Service");d.QZ=3E4;
d.r9=function(){if(this.aL()){var a=new Ee;re(this.Dd.ul(),function(b){var c=b.Ga;a.add(c);this.Qn.Wa(c)||this.re.sendRequest(new rj,b,si)}.bind(this));var b=!1;this.Qn.xb().forEach(function(c){a.contains(c)||(this.Qn.remove(c),b=!0)}.bind(this));b&&this.aB()}};
d.E8=function(a,b){if(this.aL()&&xi.hasOwnProperty(b.namespace_)&&(a=a.Ga)&&(b=JSON.parse(b.data),"RECEIVER_STATUS"===b.type)){var c=b.status&&b.status.applications&&b.status.applications[0],e=b=null;c&&(c.appId&&(b=c.appId),c.sessionId&&(e=c.sessionId));c=this.Qn.get(a);this.Qn.set(a,new Cj(a,b,e));c&&c.appId===b||this.aB()}};
d.aL=function(){if(0===this.Pn.ma())return!1;var a=u();a-this.aS>this.QZ&&(this.aS=a,chrome.tabs.query({url:["chrome://cast/*","chrome-extension://"+chrome.runtime.id+"/cast_setup/*"]},function(a){0===a.length?(this.a.info("No tabs found. Clearing device monitor clients."),this.Pn.clear()):this.a.info(function(){return"Tab check found active tabs: "+a.map(function(a){return a.id})})}.bind(this)));a=this.Pn.ma();this.a.info("Monitor client count: "+a);return 0<a};
d.Y8=function(a,b,c){if("object"!==typeof a||"cast_app"!==a.type)return!1;var e=this.Vaa.get(a.subtype);if(!e)return!1;if(!a.originId)return w("Missing origin ID in the incoming message."),!1;try{var f=e(a,b,c);f&&c(f)}catch(h){this.a.error("Error while handling request",h)}return!1};d.ph=function(a,b){var c=new Bj(a,b);this.a.C(function(){return"Sending message: "+JSON.stringify(c)});chrome.runtime.sendMessage(c)};d.k9=function(){this.ph("serviceReady")};
d.y9=function(a){this.Pn.contains(a.originId)?this.a.info("Client: "+a.originId+"already registered, dispatching current device list."):(this.a.info("Registering monitor client: "+a.originId),this.Pn.add(a.originId));this.aB();this.rfa()};d.e9=function(a){this.a.info("Unregistering monitor client: "+a.originId);this.Pn.remove(a.originId)};
d.K8=function(a){a=a.deviceJustSetUp;var b=a.udn.replace(/-/g,"").toLowerCase(),c;a.capabilities&&(c=(a.capabilities.audioOutSupported?4:0)|(a.capabilities.videoOutSupported?1:0));c=new Si(b,a.name,a.modelName,c,a.ipAddress,Pi.ga().Cn||8009);this.Dd.qB(c,!0)};d.T8=function(a){a=a.logRecord;Ac({level:Dc(a.levelValue),A:a.loggerName,time:a.time,message:a.msg})};d.aB=function(){var a=this.Qn.T();this.ph("devices",a)};
d.rfa=function(){this.Dd.refresh();this.Dd.gf().forEach(function(a){this.re.sendRequest(new rj,a,si)}.bind(this))};d.N8=function(a,b,c){switch(a.type){case "handshake":c(new pi("handshake"));break;case "launch":b=b.tab&&r(b.tab.id)?b.tab.id:null,null===b||"setup"!==a.entryPoint&&"offers"!==a.entryPoint&&"devices"!==a.entryPoint||chrome.tabs.update(b,{url:"chrome://cast#"+a.entryPoint})}};chrome.cast.Ch={CUSTOM_CONTROLLER_SCOPED:"custom_controller_scoped",TAB_AND_ORIGIN_SCOPED:"tab_and_origin_scoped",ORIGIN_SCOPED:"origin_scoped",PAGE_SCOPED:"page_scoped"};m("chrome.cast.AutoJoinPolicy",chrome.cast.Ch,void 0);chrome.cast.mu={CREATE_SESSION:"create_session",CAST_THIS_TAB:"cast_this_tab"};m("chrome.cast.DefaultActionPolicy",chrome.cast.mu,void 0);chrome.cast.Yi={VIDEO_OUT:"video_out",AUDIO_OUT:"audio_out",VIDEO_IN:"video_in",AUDIO_IN:"audio_in",MULTIZONE_GROUP:"multizone_group"};
m("chrome.cast.Capability",chrome.cast.Yi,void 0);chrome.cast.Dh={CANCEL:"cancel",TIMEOUT:"timeout",API_NOT_INITIALIZED:"api_not_initialized",INVALID_PARAMETER:"invalid_parameter",EXTENSION_NOT_COMPATIBLE:"extension_not_compatible",EXTENSION_MISSING:"extension_missing",RECEIVER_UNAVAILABLE:"receiver_unavailable",SESSION_ERROR:"session_error",CHANNEL_ERROR:"channel_error",LOAD_MEDIA_FAILED:"load_media_failed"};m("chrome.cast.ErrorCode",chrome.cast.Dh,void 0);chrome.cast.n_={AVAILABLE:"available",UNAVAILABLE:"unavailable"};
m("chrome.cast.ReceiverAvailability",chrome.cast.n_,void 0);chrome.cast.B_={CHROME:"chrome",IOS:"ios",ANDROID:"android"};m("chrome.cast.SenderPlatform",chrome.cast.B_,void 0);chrome.cast.ou={CAST:"cast",DIAL:"dial",HANGOUT:"hangout",CUSTOM:"custom"};m("chrome.cast.ReceiverType",chrome.cast.ou,void 0);chrome.cast.vZ={RUNNING:"running",STOPPED:"stopped",ERROR:"error"};m("chrome.cast.DialAppState",chrome.cast.vZ,void 0);chrome.cast.nq={CAST:"cast",STOP:"stop"};
m("chrome.cast.ReceiverAction",chrome.cast.nq,void 0);chrome.cast.MJ={CONNECTED:"connected",DISCONNECTED:"disconnected",STOPPED:"stopped"};m("chrome.cast.SessionStatus",chrome.cast.MJ,void 0);chrome.cast.VERSION=[1,2];m("chrome.cast.VERSION",chrome.cast.VERSION,void 0);chrome.cast.xna=!0;m("chrome.cast.usingPresentationApi",chrome.cast.xna,void 0);chrome.cast.Error=function(a,b,c){this.code=a;this.description=b||null;this.details=c||null};m("chrome.cast.Error",chrome.cast.Error,void 0);chrome.cast.A_=function(a){this.platform=a;this.packageId=this.url=null};m("chrome.cast.SenderApplication",chrome.cast.A_,void 0);chrome.cast.Image=function(a){this.url=a;this.width=this.height=null};
m("chrome.cast.Image",chrome.cast.Image,void 0);chrome.cast.Volume=function(a,b){this.level=l(a)?a:null;this.muted=l(b)?b:null};m("chrome.cast.Volume",chrome.cast.Volume,void 0);chrome.cast.nZ=function(a,b,c,e,f){this.sessionRequest=a;this.sessionListener=b;this.receiverListener=c;this.autoJoinPolicy=e||chrome.cast.Ch.TAB_AND_ORIGIN_SCOPED;this.defaultActionPolicy=f||chrome.cast.mu.CREATE_SESSION;this.customDialLaunchCallback=null;this.invisibleSender=!1;this.additionalSessionRequests=[]};m("chrome.cast.ApiConfig",chrome.cast.nZ,void 0);chrome.cast.xZ=function(a,b){this.appName=a;this.launchParameter=b||null};m("chrome.cast.DialRequest",chrome.cast.xZ,void 0);
chrome.cast.BJ=function(a,b,c){this.receiver=a;this.appState=b;this.extraData=c||null};m("chrome.cast.DialLaunchData",chrome.cast.BJ,void 0);chrome.cast.wZ=function(a,b){this.doLaunch=a;this.launchParameter=b||null};m("chrome.cast.DialLaunchResponse",chrome.cast.wZ,void 0);chrome.cast.LJ=function(a,b,c){this.appId=a;this.capabilities=ra(b)?b:[chrome.cast.Yi.VIDEO_OUT,chrome.cast.Yi.AUDIO_OUT];this.requestSessionTimeout=c||chrome.cast.timeout.requestSession;this.dialRequest=this.language=null};
m("chrome.cast.SessionRequest",chrome.cast.LJ,void 0);
chrome.cast.rA=function(a,b,c,e){this.label=a;a=b;Oa.test(a)&&(-1!=a.indexOf("&")&&(a=a.replace(Ia,"&amp;")),-1!=a.indexOf("<")&&(a=a.replace(Ja,"&lt;")),-1!=a.indexOf(">")&&(a=a.replace(Ka,"&gt;")),-1!=a.indexOf('"')&&(a=a.replace(La,"&quot;")),-1!=a.indexOf("'")&&(a=a.replace(Ma,"&#39;")),-1!=a.indexOf("\x00")&&(a=a.replace(Na,"&#0;")));this.friendlyName=a;this.capabilities=c||[];this.volume=e||null;this.receiverType=chrome.cast.ou.CAST;this.displayStatus=this.isActiveInput=null};
m("chrome.cast.Receiver",chrome.cast.rA,void 0);chrome.cast.o_=function(a,b){this.statusText=a;this.appImages=b;this.showStop=null};m("chrome.cast.ReceiverDisplayStatus",chrome.cast.o_,void 0);chrome.cast.PJ=function(){this.requestSession=6E4;this.sendCustomMessage=this.setReceiverVolume=this.stopSession=this.leaveSession=3E3};m("chrome.cast.Timeout",chrome.cast.PJ,void 0);chrome.cast.timeout=new chrome.cast.PJ;m("chrome.cast.timeout",chrome.cast.timeout,void 0);chrome.cast.vJ="auto-join";
chrome.cast.IJ="cast-session_";chrome.cast.media.mq={PAUSE:"pause",SEEK:"seek",STREAM_VOLUME:"stream_volume",STREAM_MUTE:"stream_mute"};m("chrome.cast.media.MediaCommand",chrome.cast.media.mq,void 0);chrome.cast.media.Bf={GENERIC:0,MOVIE:1,TV_SHOW:2,MUSIC_TRACK:3,PHOTO:4};m("chrome.cast.media.MetadataType",chrome.cast.media.Bf,void 0);chrome.cast.media.nu={IDLE:"IDLE",PLAYING:"PLAYING",PAUSED:"PAUSED",BUFFERING:"BUFFERING"};m("chrome.cast.media.PlayerState",chrome.cast.media.nu,void 0);
chrome.cast.media.sA={OFF:"REPEAT_OFF",ALL:"REPEAT_ALL",SINGLE:"REPEAT_SINGLE",ALL_AND_SHUFFLE:"REPEAT_ALL_AND_SHUFFLE"};m("chrome.cast.media.RepeatMode",chrome.cast.media.sA,void 0);chrome.cast.media.p_={PLAYBACK_START:"PLAYBACK_START",PLAYBACK_PAUSE:"PLAYBACK_PAUSE"};m("chrome.cast.media.ResumeState",chrome.cast.media.p_,void 0);chrome.cast.media.NJ={BUFFERED:"BUFFERED",LIVE:"LIVE",OTHER:"OTHER"};m("chrome.cast.media.StreamType",chrome.cast.media.NJ,void 0);
chrome.cast.media.GZ={CANCELLED:"CANCELLED",INTERRUPTED:"INTERRUPTED",FINISHED:"FINISHED",ERROR:"ERROR"};m("chrome.cast.media.IdleReason",chrome.cast.media.GZ,void 0);chrome.cast.media.M_={TEXT:"TEXT",AUDIO:"AUDIO",VIDEO:"VIDEO"};m("chrome.cast.media.TrackType",chrome.cast.media.M_,void 0);chrome.cast.media.J_={SUBTITLES:"SUBTITLES",CAPTIONS:"CAPTIONS",DESCRIPTIONS:"DESCRIPTIONS",CHAPTERS:"CHAPTERS",METADATA:"METADATA"};m("chrome.cast.media.TextTrackType",chrome.cast.media.J_,void 0);
chrome.cast.media.F_={NONE:"NONE",OUTLINE:"OUTLINE",DROP_SHADOW:"DROP_SHADOW",RAISED:"RAISED",DEPRESSED:"DEPRESSED"};m("chrome.cast.media.TextTrackEdgeType",chrome.cast.media.F_,void 0);chrome.cast.media.K_={NONE:"NONE",NORMAL:"NORMAL",ROUNDED_CORNERS:"ROUNDED_CORNERS"};m("chrome.cast.media.TextTrackWindowType",chrome.cast.media.K_,void 0);
chrome.cast.media.G_={SANS_SERIF:"SANS_SERIF",MONOSPACED_SANS_SERIF:"MONOSPACED_SANS_SERIF",SERIF:"SERIF",MONOSPACED_SERIF:"MONOSPACED_SERIF",CASUAL:"CASUAL",CURSIVE:"CURSIVE",SMALL_CAPITALS:"SMALL_CAPITALS"};m("chrome.cast.media.TextTrackFontGenericFamily",chrome.cast.media.G_,void 0);chrome.cast.media.H_={NORMAL:"NORMAL",BOLD:"BOLD",BOLD_ITALIC:"BOLD_ITALIC",ITALIC:"ITALIC"};m("chrome.cast.media.TextTrackFontStyle",chrome.cast.media.H_,void 0);chrome.cast.media.CZ=function(){this.customData=null};m("chrome.cast.media.GetStatusRequest",chrome.cast.media.CZ,void 0);chrome.cast.media.ZZ=function(){this.customData=null};m("chrome.cast.media.PauseRequest",chrome.cast.media.ZZ,void 0);chrome.cast.media.b_=function(){this.customData=null};m("chrome.cast.media.PlayRequest",chrome.cast.media.b_,void 0);chrome.cast.media.z_=function(){this.customData=this.resumeState=this.currentTime=null};m("chrome.cast.media.SeekRequest",chrome.cast.media.z_,void 0);
chrome.cast.media.C_=function(){this.customData=null};m("chrome.cast.media.StopRequest",chrome.cast.media.C_,void 0);chrome.cast.media.P_=function(a){this.volume=a;this.customData=null};m("chrome.cast.media.VolumeRequest",chrome.cast.media.P_,void 0);chrome.cast.media.KZ=function(a){this.type="LOAD";this.requestId=0;this.sessionId=null;this.media=a;this.activeTrackIds=null;this.autoplay=!0;this.customData=this.currentTime=null};m("chrome.cast.media.LoadRequest",chrome.cast.media.KZ,void 0);
chrome.cast.media.csa=function(a){this.type="PRECACHE";this.requestId=0;this.data=a};chrome.cast.media.zZ=function(a,b){this.requestId=0;this.activeTrackIds=a||null;this.textTrackStyle=b||null};m("chrome.cast.media.EditTracksInfoRequest",chrome.cast.media.zZ,void 0);chrome.cast.media.BZ=function(){this.metadataType=this.type=chrome.cast.media.Bf.GENERIC;this.releaseDate=this.releaseYear=this.images=this.subtitle=this.title=null};m("chrome.cast.media.GenericMediaMetadata",chrome.cast.media.BZ,void 0);
chrome.cast.media.SZ=function(){this.metadataType=this.type=chrome.cast.media.Bf.MOVIE;this.releaseDate=this.releaseYear=this.images=this.subtitle=this.studio=this.title=null};m("chrome.cast.media.MovieMediaMetadata",chrome.cast.media.SZ,void 0);chrome.cast.media.N_=function(){this.metadataType=this.type=chrome.cast.media.Bf.TV_SHOW;this.originalAirdate=this.releaseYear=this.images=this.episode=this.episodeNumber=this.season=this.seasonNumber=this.episodeTitle=this.title=this.seriesTitle=null};
m("chrome.cast.media.TvShowMediaMetadata",chrome.cast.media.N_,void 0);chrome.cast.media.TZ=function(){this.metadataType=this.type=chrome.cast.media.Bf.MUSIC_TRACK;this.releaseDate=this.releaseYear=this.images=this.discNumber=this.trackNumber=this.artistName=this.songName=this.composer=this.artist=this.albumArtist=this.title=this.albumName=null};m("chrome.cast.media.MusicTrackMediaMetadata",chrome.cast.media.TZ,void 0);
chrome.cast.media.a_=function(){this.metadataType=this.type=chrome.cast.media.Bf.PHOTO;this.creationDateTime=this.height=this.width=this.longitude=this.latitude=this.images=this.location=this.artist=this.title=null};m("chrome.cast.media.PhotoMediaMetadata",chrome.cast.media.a_,void 0);chrome.cast.media.RZ=function(a,b){this.contentId=a;this.streamType=chrome.cast.media.NJ.BUFFERED;this.contentType=b;this.customData=this.textTrackStyle=this.tracks=this.duration=this.metadata=null};
m("chrome.cast.media.MediaInfo",chrome.cast.media.RZ,void 0);chrome.cast.media.d_=function(a){this.itemId=null;this.media=a;this.autoplay=!0;this.startTime=0;this.playbackDuration=null;this.preloadTime=0;this.customData=this.activeTrackIds=null};m("chrome.cast.media.QueueItem",chrome.cast.media.d_,void 0);chrome.cast.media.tZ="CC1AD845";m("chrome.cast.media.DEFAULT_MEDIA_RECEIVER_APP_ID",chrome.cast.media.tZ,void 0);chrome.cast.media.timeout={};
m("chrome.cast.media.timeout",chrome.cast.media.timeout,void 0);chrome.cast.media.timeout.load=0;chrome.cast.media.timeout.load=chrome.cast.media.timeout.load;chrome.cast.media.timeout.Sa=0;chrome.cast.media.timeout.getStatus=chrome.cast.media.timeout.Sa;chrome.cast.media.timeout.play=0;chrome.cast.media.timeout.play=chrome.cast.media.timeout.play;chrome.cast.media.timeout.pause=0;chrome.cast.media.timeout.pause=chrome.cast.media.timeout.pause;chrome.cast.media.timeout.seek=0;
chrome.cast.media.timeout.seek=chrome.cast.media.timeout.seek;chrome.cast.media.timeout.stop=0;chrome.cast.media.timeout.stop=chrome.cast.media.timeout.stop;chrome.cast.media.timeout.Fp=0;chrome.cast.media.timeout.setVolume=chrome.cast.media.timeout.Fp;chrome.cast.media.timeout.UB=0;chrome.cast.media.timeout.editTracksInfo=chrome.cast.media.timeout.UB;chrome.cast.media.timeout.Nea=0;chrome.cast.media.timeout.queue=chrome.cast.media.timeout.Nea;
chrome.cast.media.L_=function(a,b){this.trackId=a;this.trackContentType=this.trackContentId=null;this.type=b;this.customData=this.subtype=this.language=this.name=null};m("chrome.cast.media.Track",chrome.cast.media.L_,void 0);chrome.cast.media.I_=function(){this.customData=this.fontStyle=this.fontGenericFamily=this.fontFamily=this.fontScale=this.windowRoundedCornerRadius=this.windowColor=this.windowType=this.edgeColor=this.edgeType=this.backgroundColor=this.foregroundColor=null};
m("chrome.cast.media.TextTrackStyle",chrome.cast.media.I_,void 0);chrome.cast.media.f_=function(a){this.type="QUEUE_LOAD";this.sessionId=this.requestId=null;this.items=a;this.startIndex=0;this.repeatMode=chrome.cast.media.sA.OFF;this.customData=null};m("chrome.cast.media.QueueLoadRequest",chrome.cast.media.f_,void 0);chrome.cast.media.c_=function(a){this.type="QUEUE_INSERT";this.sessionId=this.requestId=null;this.items=a;this.customData=this.insertBefore=null};
m("chrome.cast.media.QueueInsertItemsRequest",chrome.cast.media.c_,void 0);chrome.cast.media.j_=function(a){this.type="QUEUE_UPDATE";this.sessionId=this.requestId=null;this.items=a;this.customData=null};m("chrome.cast.media.QueueUpdateItemsRequest",chrome.cast.media.j_,void 0);chrome.cast.media.e_=function(){this.type="QUEUE_UPDATE";this.customData=this.jump=this.currentItemId=this.sessionId=this.requestId=null};m("chrome.cast.media.QueueJumpRequest",chrome.cast.media.e_,void 0);
chrome.cast.media.i_=function(){this.type="QUEUE_UPDATE";this.customData=this.repeatMode=this.sessionId=this.requestId=null};m("chrome.cast.media.QueueSetPropertiesRequest",chrome.cast.media.i_,void 0);chrome.cast.media.g_=function(a){this.type="QUEUE_REMOVE";this.sessionId=this.requestId=null;this.itemIds=a;this.customData=null};m("chrome.cast.media.QueueRemoveItemsRequest",chrome.cast.media.g_,void 0);
chrome.cast.media.h_=function(a){this.type="QUEUE_REORDER";this.sessionId=this.requestId=null;this.itemIds=a;this.customData=this.insertBefore=null};m("chrome.cast.media.QueueReorderItemsRequest",chrome.cast.media.h_,void 0);chrome.cast.media.J=function(a,b){this.sessionId=a;this.mediaSessionId=b;this.media=null;this.playbackRate=1;this.playerState=chrome.cast.media.nu.IDLE;this.currentTime=0;this.SR=-1;this.supportedMediaCommands=[];this.volume=new chrome.cast.Volume;this.items=this.preloadedItemId=this.loadingItemId=this.currentItemId=this.customData=this.activeTrackIds=this.idleReason=null;this.repeatMode=chrome.cast.media.sA.OFF};m("chrome.cast.media.Media",chrome.cast.media.J,void 0);
chrome.cast.media.J.prototype.Sa=function(){};chrome.cast.media.J.prototype.getStatus=chrome.cast.media.J.prototype.Sa;chrome.cast.media.J.prototype.play=function(){};chrome.cast.media.J.prototype.play=chrome.cast.media.J.prototype.play;chrome.cast.media.J.prototype.pea=function(){};chrome.cast.media.J.prototype.playWithContext=chrome.cast.media.J.prototype.pea;chrome.cast.media.J.prototype.pause=function(){};chrome.cast.media.J.prototype.pause=chrome.cast.media.J.prototype.pause;
chrome.cast.media.J.prototype.gea=function(){};chrome.cast.media.J.prototype.pauseWithContext=chrome.cast.media.J.prototype.gea;chrome.cast.media.J.prototype.seek=function(){};chrome.cast.media.J.prototype.seek=chrome.cast.media.J.prototype.seek;chrome.cast.media.J.prototype.stop=function(){};chrome.cast.media.J.prototype.stop=chrome.cast.media.J.prototype.stop;chrome.cast.media.J.prototype.Fp=function(){};chrome.cast.media.J.prototype.setVolume=chrome.cast.media.J.prototype.Fp;
chrome.cast.media.J.prototype.UB=function(){};chrome.cast.media.J.prototype.editTracksInfo=chrome.cast.media.J.prototype.UB;chrome.cast.media.J.prototype.Qea=function(){};chrome.cast.media.J.prototype.queueInsertItems=chrome.cast.media.J.prototype.Qea;chrome.cast.media.J.prototype.Oea=function(){};chrome.cast.media.J.prototype.queueAppendItem=chrome.cast.media.J.prototype.Oea;chrome.cast.media.J.prototype.afa=function(){};chrome.cast.media.J.prototype.queueUpdateItems=chrome.cast.media.J.prototype.afa;
chrome.cast.media.J.prototype.Vea=function(){};chrome.cast.media.J.prototype.queuePrev=chrome.cast.media.J.prototype.Vea;chrome.cast.media.J.prototype.Uea=function(){};chrome.cast.media.J.prototype.queueNext=chrome.cast.media.J.prototype.Uea;chrome.cast.media.J.prototype.Rea=function(a){this.bD(a)};chrome.cast.media.J.prototype.queueJumpToItem=chrome.cast.media.J.prototype.Rea;chrome.cast.media.J.prototype.Zea=function(){};chrome.cast.media.J.prototype.queueSetRepeatMode=chrome.cast.media.J.prototype.Zea;
chrome.cast.media.J.prototype.Xea=function(){};chrome.cast.media.J.prototype.queueRemoveItems=chrome.cast.media.J.prototype.Xea;chrome.cast.media.J.prototype.Wea=function(a){this.bD(a)};chrome.cast.media.J.prototype.queueRemoveItem=chrome.cast.media.J.prototype.Wea;chrome.cast.media.J.prototype.Yea=function(){};chrome.cast.media.J.prototype.queueReorderItems=chrome.cast.media.J.prototype.Yea;
chrome.cast.media.J.prototype.Tea=function(a,b,c,e){a=this.bD(a);0>a||(0>b?e&&e(new chrome.cast.Error(chrome.cast.Dh.INVALID_PARAMETER)):a==b&&c&&c())};chrome.cast.media.J.prototype.queueMoveItemToNewIndex=chrome.cast.media.J.prototype.Tea;chrome.cast.media.J.prototype.tma=function(a){return-1<this.supportedMediaCommands.indexOf(a)};chrome.cast.media.J.prototype.supportsCommand=chrome.cast.media.J.prototype.tma;
chrome.cast.media.J.prototype.k6=function(){if(this.playerState==chrome.cast.media.nu.PLAYING&&0<=this.SR){var a=this.currentTime+(Date.now()-this.SR)/1E3*this.playbackRate;this.media&&null!=this.media.duration&&a>this.media.duration&&(a=this.media.duration);0>a&&(a=0);return a}return this.currentTime};chrome.cast.media.J.prototype.getEstimatedTime=chrome.cast.media.J.prototype.k6;chrome.cast.media.J.prototype.EA=function(){};chrome.cast.media.J.prototype.addUpdateListener=chrome.cast.media.J.prototype.EA;
chrome.cast.media.J.prototype.FA=function(){};chrome.cast.media.J.prototype.addUpdateListenerWithContext=chrome.cast.media.J.prototype.FA;chrome.cast.media.J.prototype.PG=function(){};chrome.cast.media.J.prototype.removeUpdateListener=chrome.cast.media.J.prototype.PG;chrome.cast.media.J.prototype.QG=function(){};chrome.cast.media.J.prototype.removeUpdateListenerWithContext=chrome.cast.media.J.prototype.QG;
chrome.cast.media.J.prototype.bD=function(a){return db(this.items,function(b){return b.itemId==a})};var Ej=function(a,b,c){this.sessionId=a;this.namespaceName=b;this.message=c};var Fj=function(a){this.re=a;this.a=D("mr.cast.ReceiverStatusQuerier")};Fj.prototype.Ula=function(a){var b=this;return(new Ge(t(this.Mea,this,a),3500,5)).yy(2).start().then(null,function(c){b.a.info("Failed to get receiver status from "+a.getId());throw c;})};Fj.prototype.Mea=function(a){this.a.info("Query receiver status: "+a.getId());return this.re.sendRequest(new rj,a,si)};var Gj=function(a,b){this.type="SET_VOLUME";this.requestId=0;this.volume=a;this.expectedVolume=b||null};chrome.cast.M=function(a,b,c,e,f){this.sessionId=a;this.appId=b;this.displayName=c;this.statusText=null;this.appImages=e;this.receiver=f;this.senderApps=[];this.namespaces=[];this.media=[];this.status=chrome.cast.MJ.CONNECTED;this.transportId=""};m("chrome.cast.Session",chrome.cast.M,void 0);chrome.cast.M.prototype.pka=function(a,b,c){this.TW(null,a,b,c)};chrome.cast.M.prototype.setReceiverVolumeLevel=chrome.cast.M.prototype.pka;
chrome.cast.M.prototype.TW=function(a,b,c,e){b=new Gj(new chrome.cast.Volume(b,null),this.receiver.volume);a.setReceiverVolume(this.sessionId,b,c,e)};chrome.cast.M.prototype.setReceiverVolumeLevelWithContext=chrome.cast.M.prototype.TW;chrome.cast.M.prototype.oka=function(a,b,c){this.SW(null,a,b,c)};chrome.cast.M.prototype.setReceiverMuted=chrome.cast.M.prototype.oka;
chrome.cast.M.prototype.SW=function(a,b,c,e){a=new Gj(new chrome.cast.Volume(null,b),this.receiver.volume);null.setReceiverVolume(this.sessionId,a,c,e)};chrome.cast.M.prototype.setReceiverMutedWithContext=chrome.cast.M.prototype.SW;chrome.cast.M.prototype.leave=function(a,b){null.leaveSession(this.sessionId,a,b)};chrome.cast.M.prototype.leave=chrome.cast.M.prototype.leave;chrome.cast.M.prototype.stop=function(){};chrome.cast.M.prototype.stop=chrome.cast.M.prototype.stop;
chrome.cast.M.prototype.lma=function(){};chrome.cast.M.prototype.stopWithContext=chrome.cast.M.prototype.lma;chrome.cast.M.prototype.sendMessage=function(){};chrome.cast.M.prototype.sendMessage=chrome.cast.M.prototype.sendMessage;chrome.cast.M.prototype.nha=function(){};chrome.cast.M.prototype.sendMessageWithContext=chrome.cast.M.prototype.nha;chrome.cast.M.prototype.EA=function(){};chrome.cast.M.prototype.addUpdateListener=chrome.cast.M.prototype.EA;chrome.cast.M.prototype.FA=function(){};
chrome.cast.M.prototype.addUpdateListenerWithContext=chrome.cast.M.prototype.FA;chrome.cast.M.prototype.PG=function(){};chrome.cast.M.prototype.removeUpdateListener=chrome.cast.M.prototype.PG;chrome.cast.M.prototype.QG=function(){};chrome.cast.M.prototype.removeUpdateListenerWithContext=chrome.cast.M.prototype.QG;chrome.cast.M.prototype.l0=function(){};chrome.cast.M.prototype.addMessageListener=chrome.cast.M.prototype.l0;chrome.cast.M.prototype.m0=function(){};
chrome.cast.M.prototype.addMessageListenerWithContext=chrome.cast.M.prototype.m0;chrome.cast.M.prototype.i0=function(){};chrome.cast.M.prototype.addMediaListener=chrome.cast.M.prototype.i0;chrome.cast.M.prototype.j0=function(){};chrome.cast.M.prototype.addMediaListenerWithContext=chrome.cast.M.prototype.j0;chrome.cast.M.prototype.Tfa=function(){};chrome.cast.M.prototype.removeMediaListener=chrome.cast.M.prototype.Tfa;chrome.cast.M.prototype.Ufa=function(){};
chrome.cast.M.prototype.removeMediaListenerWithContext=chrome.cast.M.prototype.Ufa;chrome.cast.M.prototype.Vfa=function(){};chrome.cast.M.prototype.removeMessageListener=chrome.cast.M.prototype.Vfa;chrome.cast.M.prototype.Wfa=function(){};chrome.cast.M.prototype.removeMessageListenerWithContext=chrome.cast.M.prototype.Wfa;chrome.cast.M.prototype.haa=function(a){a.sessionId=this.sessionId};chrome.cast.M.prototype.loadMedia=chrome.cast.M.prototype.haa;
chrome.cast.M.prototype.Sea=function(a){a.sessionId=this.sessionId};chrome.cast.M.prototype.queueLoad=chrome.cast.M.prototype.Sea;var Jj=function(a,b){if(!b.applications||1!=b.applications.length)return null;var c=b.applications[0];a=Hj(a);a=new chrome.cast.M(c.sessionId,c.appId,c.displayName,c.appImages,a);a.senderApps=c.senderApps;a.namespaces=c.namespaces||[];a.transportId=c.transportId;a.statusText=c.statusText;if(!a.sessionId||!(a.namespaces&&0!=a.namespaces.length||Ij(a)))return null;a.receiver.volume=b.volume;"boolean"==typeof b.isActiveInput&&(a.receiver.isActiveInput=b.isActiveInput);return a},Kj=function(a){var b=
[];if(!a)return b;a&1&&b.push(chrome.cast.Yi.VIDEO_OUT);a&2&&b.push(chrome.cast.Yi.VIDEO_IN);a&4&&b.push(chrome.cast.Yi.AUDIO_OUT);a&8&&b.push(chrome.cast.Yi.AUDIO_IN);a&32&&b.push(chrome.cast.Yi.MULTIZONE_GROUP);return b},Hj=function(a){return new chrome.cast.rA(a.getId(),a.jo(),Kj(a.Zd))},Lj=function(a,b){if(a.statusText!=b.statusText)return!0;var c=a.namespaces||[],e=b.namespaces||[];if(c.length!=e.length)return!0;for(var f={index:0};f.index<c.length;f={index:f.index},f.index++)if(!e.some(function(a){return function(b){return b.name==
c[a.index].name}}(f)))return!0;return a.receiver.volume.level!==b.receiver.volume.level||a.receiver.volume.muted!==b.receiver.volume.muted?!0:!1},Mj=function(a){ra(a)?a.forEach(Mj):ua(a)&&Object.keys(a).forEach(function(b){null===a[b]?delete a[b]:(ua(a[b])||ra(a[b]))&&Mj(a[b])})},Nj=function(a,b){return a.namespaces.some(function(a){return a.name==b})},Oj=["MultizoneLeader","MultizoneFollower"],Ij=function(a){return null!==a&&"MultizoneLeader"==a.appId},Pj=function(a){return"E8C28D3C"==a||"00000000-0000-0000-0000-000000000000"==
a};var Qj=function(a){this.re=a;this.a=D("mr.cast.SessionLauncher")};Qj.prototype.YE=function(a,b){gh("MediaRouter.Cast.Session.Type",0,Vi);return this.re.ega(a,b).then(this.Q8.bind(this,b),function(a){a&&Aj==a?dj(1):dj(0);throw a;})};Qj.prototype.Q8=function(a,b){this.a.C("Got launch result from "+a.getId());if("LAUNCH_ERROR"==b.type)throw dj(2),Error(b.reason);a=Jj(a,b.status);this.a.info("Launched session: "+a.sessionId);return a};var Rj=function(a,b,c,e){this.type=a;this.message=b;this.sequenceNumber=l(c)?c:-1;this.timeoutMillis=e||0;this.clientId=""};var Sj=function(a,b){this.Zj=a;this.jc=b;this.pS=[];this.km=new wj};d=Sj.prototype;d.KD=function(a){return(a=this.jc.xe(a))?a.routeId:null};d.listen=function(a,b){this.pS[a]=b};d.Jc=function(a,b,c){Tj.C("Sending to "+b);Tj.C(JSON.stringify(c));c.clientId=b;this.Zj.F3(a,c)};d.mk=function(a,b){var c=this,e=this.jc.xe(a);e&&e.isConnected?this.Jc(e.routeId,a,b):this.connect(a).then(function(e){e?(e=c.KD(a))?c.Jc(e,a,b):Tj.u("No route for "+a):Tj.u("No connected client "+a)},null)};
d.Js=function(a){Tj.C("App "+a);var b=this.jc.xe(a);b?(b.isConnected=!0,(a=this.km.ct(b.routeId))&&a.Pb.resolve(!0)):Tj.u("Client not found "+a)};d.qba=function(a){Tj.C("Received: "+a);a=JSON.parse(a);var b=a.clientId;"client_connect"==a.type?this.Js(b):this.KD(b)?(b=this.pS[a.type])&&b(a):Tj.u("No route for "+b)};
d.connect=function(a){if(this.n$(a))return Promise.resolve(!0);var b=this.KD(a);if(!b)return Tj.u("No route for client "+a),Promise.resolve(!1);if(a=this.km.ji(b))return a.Pb.promise;a=new Ec;this.km.gK(new Uj(b,a));return a.promise};d.n$=function(a){a=this.jc.xe(a);return null!=a&&a.isConnected};var Tj=D("mr.cast.ApiMessenger"),Uj=function(a,b){vj.call(this,a,3E4);this.Pb=b};ja(Uj,vj);Uj.prototype.EF=function(){this.Pb.resolve(!1)};var Vj=function(a,b){this.Vn=this.yh=this.Ki="";this.ab=null;this.fl=this.Hc="";this.jf=this.z$=!1;var c;a instanceof Vj?(this.jf=l(b)?b:a.jf,this.Yy(a.Ki),this.eI(a.Wr()),this.xp(a.xj()),this.Cp(a.sb()),this.Oi(a.Hc),this.Ty(a.Ci.clone()),this.Gy(a.fl)):a&&(c=String(a).match(Fc))?(this.jf=!!b,this.Yy(c[1]||"",!0),this.eI(c[2]||"",!0),this.xp(c[3]||"",!0),this.Cp(c[4]),this.Oi(c[5]||"",!0),this.Ty(c[6]||"",!0),this.Gy(c[7]||"",!0)):(this.jf=!!b,this.Ci=new Wj(null,null,this.jf))};d=Vj.prototype;
d.toString=function(){var a=[],b=this.Ki;b&&a.push(Xj(b,Yj,!0),":");var c=this.xj();if(c||"file"==b)a.push("//"),(b=this.Wr())&&a.push(Xj(b,Yj,!0),"@"),a.push(encodeURIComponent(String(c)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),c=this.sb(),null!=c&&a.push(":",String(c));if(c=this.Hc)this.yw()&&"/"!=c.charAt(0)&&a.push("/"),a.push(Xj(c,"/"==c.charAt(0)?Zj:ak,!0));(c=this.i6())&&a.push("?",c);(c=this.fl)&&a.push("#",Xj(c,bk));return a.join("")};
d.resolve=function(a){var b=this.clone(),c=a.L9();c?b.Yy(a.Ki):c=a.M9();c?b.eI(a.Wr()):c=a.yw();c?b.xp(a.xj()):c=a.iR();var e=a.Hc;if(c)b.Cp(a.sb());else if(c=a.hR()){if("/"!=e.charAt(0))if(this.yw()&&!this.hR())e="/"+e;else{var f=b.Hc.lastIndexOf("/");-1!=f&&(e=b.Hc.substr(0,f+1)+e)}f=e;if(".."==f||"."==f)e="";else if(-1!=f.indexOf("./")||-1!=f.indexOf("/.")){for(var e=Da(f,"/"),f=f.split("/"),h=[],k=0;k<f.length;){var n=f[k++];"."==n?e&&k==f.length&&h.push(""):".."==n?((1<h.length||1==h.length&&
""!=h[0])&&h.pop(),e&&k==f.length&&h.push("")):(h.push(n),e=!0)}e=h.join("/")}else e=f}c?b.Oi(e):c=a.K9();c?b.Ty(a.Ci.clone()):c=a.H9();c&&b.Gy(a.fl);return b};d.clone=function(){return new Vj(this)};d.Yy=function(a,b){this.al();if(this.Ki=b?ck(a,!0):a)this.Ki=this.Ki.replace(/:$/,"");return this};d.L9=function(){return!!this.Ki};d.Wr=function(){return this.yh};d.eI=function(a,b){this.al();this.yh=b?ck(a):a;return this};d.M9=function(){return!!this.yh};d.xj=function(){return this.Vn};
d.xp=function(a,b){this.al();this.Vn=b?ck(a,!0):a;return this};d.yw=function(){return!!this.Vn};d.sb=function(){return this.ab};d.Cp=function(a){this.al();if(a){a=Number(a);if(isNaN(a)||0>a)throw Error("Bad port number "+a);this.ab=a}else this.ab=null;return this};d.iR=function(){return null!=this.ab};d.Oi=function(a,b){this.al();this.Hc=b?ck(a,!0):a;return this};d.hR=function(){return!!this.Hc};d.K9=function(){return""!==this.Ci.toString()};
d.Ty=function(a,b){this.al();a instanceof Wj?(this.Ci=a,this.Ci.HH(this.jf)):(b||(a=Xj(a,dk)),this.Ci=new Wj(a,null,this.jf));return this};d.i6=function(){return this.Ci.toString()};d.Gy=function(a,b){this.al();this.fl=b?ck(a):a;return this};d.H9=function(){return!!this.fl};d.al=function(){if(this.z$)throw Error("Tried to modify a read-only Uri");};d.HH=function(a){this.jf=a;this.Ci&&this.Ci.HH(a);return this};
var ck=function(a,b){return a?b?decodeURI(a.replace(/%25/g,"%2525")):decodeURIComponent(a):""},Xj=function(a,b,c){return p(a)?(a=encodeURI(a).replace(b,ek),c&&(a=a.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),a):null},ek=function(a){a=a.charCodeAt(0);return"%"+(a>>4&15).toString(16)+(a&15).toString(16)},Yj=/[#\/\?@]/g,ak=/[\#\?:]/g,Zj=/[\#\?]/g,dk=/[\#\?@]/g,bk=/#/g,Wj=function(a,b,c){this.rb=this.Vb=null;this.sj=a||null;this.jf=!!c};
Wj.prototype.Uh=function(){if(!this.Vb&&(this.Vb=new H,this.rb=0,this.sj)){var a=this;Hc(this.sj,function(b,c){a.add(decodeURIComponent(b.replace(/\+/g," ")),c)})}};var fk=function(a,b,c){b=ze(a);if("undefined"==typeof b)throw Error("Keys are undefined");c=new Wj(null,null,c);a=ye(a);for(var e=0;e<b.length;e++){var f=b[e],h=a[e];ra(h)?c.oX(f,h):c.add(f,h)}return c};d=Wj.prototype;d.ma=function(){this.Uh();return this.rb};
d.add=function(a,b){this.Uh();this.Co();a=this.no(a);var c=this.Vb.get(a);c||this.Vb.set(a,c=[]);c.push(b);this.rb+=1;return this};d.remove=function(a){this.Uh();a=this.no(a);return this.Vb.Wa(a)?(this.Co(),this.rb-=this.Vb.get(a).length,this.Vb.remove(a)):!1};d.clear=function(){this.Co();this.Vb=null;this.rb=0};d.Ec=function(){this.Uh();return 0==this.rb};d.Wa=function(a){this.Uh();a=this.no(a);return this.Vb.Wa(a)};d.Kn=function(a){var b=this.T();return gb(b,a)};
d.xb=function(){this.Uh();for(var a=this.Vb.T(),b=this.Vb.xb(),c=[],e=0;e<b.length;e++)for(var f=a[e],h=0;h<f.length;h++)c.push(b[e]);return c};d.T=function(a){this.Uh();var b=[];if(p(a))this.Wa(a)&&(b=qb(b,this.Vb.get(this.no(a))));else{a=this.Vb.T();for(var c=0;c<a.length;c++)b=qb(b,a[c])}return b};d.set=function(a,b){this.Uh();this.Co();a=this.no(a);this.Wa(a)&&(this.rb-=this.Vb.get(a).length);this.Vb.set(a,[b]);this.rb+=1;return this};
d.get=function(a,b){a=a?this.T(a):[];return 0<a.length?String(a[0]):b};d.oX=function(a,b){this.remove(a);0<b.length&&(this.Co(),this.Vb.set(this.no(a),A(b)),this.rb+=b.length)};d.toString=function(){if(this.sj)return this.sj;if(!this.Vb)return"";for(var a=[],b=this.Vb.xb(),c=0;c<b.length;c++)for(var e=b[c],f=encodeURIComponent(String(e)),e=this.T(e),h=0;h<e.length;h++){var k=f;""!==e[h]&&(k+="="+encodeURIComponent(String(e[h])));a.push(k)}return this.sj=a.join("&")};d.Co=function(){this.sj=null};
d.clone=function(){var a=new Wj;a.sj=this.sj;this.Vb&&(a.Vb=this.Vb.clone(),a.rb=this.rb);return a};d.no=function(a){a=String(a);this.jf&&(a=a.toLowerCase());return a};d.HH=function(a){a&&!this.jf&&(this.Uh(),this.Co(),this.Vb.forEach(function(a,c){var b=c.toLowerCase();c!=b&&(this.remove(c),this.oX(b,a))},this));this.jf=a};d.extend=function(a){for(var b=0;b<arguments.length;b++)Be(arguments[b],function(a,b){this.add(b,a)},this)};var gk=function(a,b,c,e,f,h,k,n,q,z){this.LA=a;this.Ve=b||null;this.Hu=c||null;this.qv=e||null;this.dx=l(f)?f:null;this.MA=h||null;this.eM=k||null;this.xE=n||!1;this.cB=q||null;this.bB=z||null},hk=function(a,b){return(a=a.match(b+"=([^/]*)"))?a[1]:null},jk=function(a){a=a.match(/__castAppId__=([^/]*)/g);return null==a?[]:$a(y(a,function(a){a=hk(a,"__castAppId__");if(!a)return null;a=a.match(ik);if(!a||0==a.length)return null;var b=[];3==a.length&&a[2]&&(b=a[2].split(","));return{appId:a[1],capabilities:b}}),
function(a){return null!=a})},kk=function(a){return hk(a,"__castClientId__")};d=gk.prototype;d.gr=function(){return y(this.LA,function(a){return a.appId})};d.iN=function(){return this.MA};d.ld=function(){return this.Ve};d.vC=function(){return this.Hu?this.Hu:chrome.cast.Ch.TAB_AND_ORIGIN_SCOPED};d.S5=function(){return this.qv?this.qv:chrome.cast.mu.CREATE_SESSION};d.F6=function(){return null==this.dx?chrome.cast.timeout.requestSession:this.dx};
d.toString=function(){var a=new Vj;a.Yy("https");a.xp("google.com");a.Oi("/cast");var b=[];x(this.LA,function(a){var c="__castAppId__="+a.appId;a.capabilities&&0<a.capabilities.length&&(c=c+"("+a.capabilities.join(","),c+=")");b.push(c)});this.Ve&&b.push("__castClientId__="+this.Ve);this.Hu&&b.push("__castAutoJoinPolicy__="+this.Hu);this.qv&&b.push("__castDefaultActionPolicy__="+this.qv);null!=this.dx&&b.push("__castLaunchTimeout__="+this.dx);this.MA&&b.push("__dialAppName__="+this.MA);this.eM&&b.push("__dialPostData__="+
this.eM);this.xE&&b.push("__castInvisibleSender__=true");this.cB&&(b.push("__castBroadcastNamespace__="+this.cB),b.push("__castBroadcastId__="+Math.random()));this.bB&&b.push("__castBroadcastMessage__="+encodeURIComponent(JSON.stringify(this.bB)));a.Gy(b.join("/"));return a.toString()};d.F$=function(a){var b=this.gr(),c=lk(a);return bb(b,function(a){return gb(c,a)})};
var mk=function(a){a=new Vj(a);if("https"!=a.Ki||"google.com"!=a.xj()||"/cast"!=a.Hc)return null;var b=a.fl;a=jk(b);if(!a||0==a.length)return null;var c=kk(b),e=hk(b,"__castAutoJoinPolicy__"),f=hk(b,"__castDefaultActionPolicy__"),h;h=hk(b,"__castLaunchTimeout__");null==h?h=null:(h=Number(h),h=!isNaN(h)&&0<=h?h:null);var k=hk(b,"__dialAppName__"),n=hk(b,"__dialPostData__"),q=hk(b,"__castInvisibleSender__"),q=null===q?null:"true"==q,z=hk(b,"__castBroadcastNamespace__"),b=(b=hk(b,"__castBroadcastMessage__"))?
JSON.parse(decodeURIComponent(b)):null;return new gk(a,c,e,f,h,k,n,q,z,b)},lk=function(a){return(a=mk(a))?a.gr():null},nk=function(a){return(a=mk(a))?a.ld():null},ik=/(^\w+)(?:\(([\w,\ ]*)\))?$/;var ok=function(a,b,c,e,f,h){this.Hi=a;this.sa=b;this.jc=c;this.Ka=e;this.ae=f;this.Zj=h;this.Ue=new Sj(h,c);this.ifa=new Fj(this.Hi);this.Dha=new Qj(this.Hi)};d=ok.prototype;d.init=function(){this.jc.init();this.Ue.listen("v2_message",this.Yca.bind(this));this.Ue.listen("app_message",this.vba.bind(this));this.Ue.listen("leave_session",this.fca.bind(this))};d.eg=function(a,b){this.Ue.qba(b)};d.rV=function(a,b,c){var e=this;this.Ka.GN(a).slice().forEach(function(a){a!=c&&e.kH(a,b)})};
d.kH=function(a,b){b.clientId=a;this.Ue.mk(a,b)};d.vV=function(a,b,c){b={receiver:Hj(b),action:c};this.kH(a,new Rj("receiver_action",b))};
d.Yca=function(a){var b=a.message,c=b.sessionId;if(c){var e=this.Ka.QD(c);if(e)if(c=this.Ka.gQ(c))if(c=this.sa.pa(c))switch(b.type){case "STOP":this.sba(a,c);break;case "LOAD":case "PAUSE":case "PLAY":case "SEEK":case "STOP_MEDIA":case "MEDIA_SET_VOLUME":case "MEDIA_GET_STATUS":case "EDIT_TRACKS_INFO":case "QUEUE_LOAD":case "QUEUE_INSERT":case "QUEUE_UPDATE":case "QUEUE_REMOVE":case "QUEUE_REORDER":case "PRECACHE":this.pba(a,c,e);break;case "SET_VOLUME":this.rba(a,c);break;default:pk.u("Unknown request")}else this.tp(a,
chrome.cast.Dh.INVALID_PARAMETER,"No receiver");else this.tp(a,chrome.cast.Dh.INVALID_PARAMETER,"No sink ID");else this.tp(a,chrome.cast.Dh.INVALID_PARAMETER,"Unknown session ID")}else this.tp(a,chrome.cast.Dh.INVALID_PARAMETER,"No session ID")};d.tp=function(a,b,c){b=new chrome.cast.Error(b,c);this.jH(a,b)};d.jH=function(a,b){this.Ue.mk(a.clientId,new Rj("error",b,a.sequenceNumber))};
d.sba=function(a,b){var c=this,e=a.message;fh("MediaRouter.Cast.Session.End");var f=e.sessionId,h=this.Ka.Wf(f);h&&(h.Ow=!0);h=function(){c.mp(f,a)};this.Hi.sendRequest(e,b,si,a.timeoutMillis,a.clientId).then(h,h)};d.pba=function(a,b,c){var e=this,f=a.message,h=f.type;h in qj&&(f.type=qj[h]);this.Hi.sendRequest(f,b,ui,a.timeoutMillis,a.clientId,c.transportId).then(function(b){e.oU(c,b);e.Ue.mk(a.clientId,new Rj("v2_message",b,a.sequenceNumber))},function(b){e.jH(a,b)})};
d.rba=function(a,b){var c=this,e=a.message;delete e.sessionId;this.Hi.sendRequest(e,b,si,a.timeoutMillis,a.clientId).then(function(){c.Ue.mk(a.clientId,new Rj("v2_message",null,a.sequenceNumber))},function(b){c.jH(a,b)})};
d.vba=function(a){var b=this,c=a.message,e=c.sessionId;if(e){var f=this.Ka.gQ(e);f?(f=this.sa.pa(f))?(e=this.Ka.QD(e),eb(e.namespaces,function(a){return a.name==c.namespaceName})?this.ae.Hm(f,c.namespaceName,c.message,a.clientId,e.transportId).then(function(){b.Ue.mk(a.clientId,new Rj("app_message",null,a.sequenceNumber))},function(){b.tp(a,chrome.cast.Dh.CHANNEL_ERROR,"Channel to receiver not available")}):this.tp(a,chrome.cast.Dh.INVALID_PARAMETER,"Invalid namespace")):pk.u("No receiver from sinkId"):
pk.u("No sinkId from sessionId")}else pk.u("No sessionId")};d.Fx=function(a){(a=this.Ka.Kr(a))&&a.session&&this.mp(a.session.sessionId)};
d.fca=function(a){var b=this;pk.info("Leave session");var c=this.Ka.Wf(a.message);if(c){var e=a.clientId,f=this.jc.xe(e);if(f){var h=[],k=[],n=f.tabId,q=f.origin,z=f.autoJoinPolicy;c.Lh.forEach(function(a){var c=b.jc.xe(a);z==chrome.cast.Ch.TAB_AND_ORIGIN_SCOPED&&n==c.tabId&&q==c.origin||z==chrome.cast.Ch.ORIGIN_SCOPED&&q==c.origin?(c.DR=!0,h.push(a)):k.push(a)});this.Ue.mk(e,new Rj("leave_session",null,a.sequenceNumber));h.forEach(function(a){(a=b.jc.xe(a))&&b.Zj.vm(a.routeId,!0,!0)});c.Lh=k}else pk.u("No client record")}else pk.u("No session")};
d.qU=function(a,b){Nj(a,ui)&&this.Hi.sendRequest(new rj,b,ui,void 0,void 0,a.transportId).catch(na)};d.rU=function(a,b){var c=this,e=a.getId();pk.info("Query status for "+e);this.ifa.Ula(a).then(function(f){c.JT(e,f);b&&(f=c.Ka.rw(e))&&c.qU(f,a)},na)};d.Ica=function(a,b){xi.hasOwnProperty(b.namespace_)?this.Fca(a,b):this.Eca(a,b)};d.L$=function(a){if("*"==a.destinationId)return!0;a=a.destinationId;if(a==this.ae.cQ()||null!=this.jc.xe(a))return!0;pk.info("Invalid destination "+a);return!1};
d.Fca=function(a,b){var c=this;pk.C(function(){return"Cast message: "+JSON.stringify(b)});if(this.L$(b))if(b.namespace_==ti||b.namespace_==vi)(a=this.Ka.Kr(a))&&a.yf.forEach(function(a){c.Zj.E3(a,b)});else{var e=JSON.parse(b.data),f=this.c9(e),f=f?f.sourceId:void 0;switch(e.type){case "RECEIVER_STATUS":this.JT(a,e);break;case "MEDIA_STATUS":this.Hca(a,b,f)}}else this.ae.oL(a,b.destinationId,b.sourceId,!1)};
d.c9=function(a){var b=this.Hi.ct(a.requestId);if(!b)return null;var c=b.Pb;switch(a.type){case "LAUNCH_ERROR":case "INVALID_REQUEST":case "LOAD_CANCELLED":case "LOAD_FAILED":case "INVALID_PLAYER_STATE":delete a.requestId;c.reject(new chrome.cast.Error(chrome.cast.Dh.SESSION_ERROR,a.reason||a.type,a));break;default:c.resolve(a)}return b};
d.Eca=function(a,b){var c=this;pk.C(function(){return"App message: "+JSON.stringify(b)});if(a=this.Ka.rw(a)){var e;e="*"==b.destinationId?this.Ka.GN(a.sessionId):[b.destinationId];var f=new Ej(a.sessionId,b.namespace_,b.data);e.forEach(function(a){c.Ue.mk(a,new Rj("app_message",f))})}else pk.u("No session for incoming app message")};
var qk=function(a,b){a.forEach(function(a){a.sessionId=b;var c=a.supportedMediaCommands,f=[];c&1&&f.push(chrome.cast.media.mq.PAUSE);c&2&&f.push(chrome.cast.media.mq.SEEK);c&4&&f.push(chrome.cast.media.mq.STREAM_VOLUME);c&8&&f.push(chrome.cast.media.mq.STREAM_MUTE);a.supportedMediaCommands=f});return a};d=ok.prototype;d.oU=function(a,b){a=a.sessionId;b.sessionId=a;this.Ka.Kka(a,qk(b.status,a))};d.pca=function(a,b,c){this.Ue.mk(c,new Rj("new_session",a));this.qU(a,b)};
d.MU=function(a){if(a=this.Ka.rw(a)){a=a.sessionId;var b=this.Ka.Wf(a);b&&b.Ow||this.mp(a)}};d.mp=function(a,b){var c=this;b&&this.kH(b.clientId,b);(b=this.Ka.Wf(a))&&b.yf.slice().forEach(function(a){c.Zj.vm(a,!0)});this.Ka.mp(a)};
d.JT=function(a,b){pk.C("Receiver status for "+a);var c=b.status;if(c)if(b=this.sa.pa(a)){var c=Jj(b,c),e=this.Ka.Kr(a);e?c?c.sessionId==e.session.sessionId?this.q9(e,c):(this.aR(a),this.Zj.Dg(null,b,null,c)):this.aR(a):c&&this.Zj.Dg(null,b,null,c)}else fh("MediaRouter.Cast.Error.Sink.Missing.From.Discovery.Service"),pk.u("Got message from receiver "+a+", but sink is no longer available.")};
d.q9=function(a,b){var c=a.session;Lj(c,b)&&(pk.C("Updating session "+b.sessionId),c.statusText=b.statusText,c.namespaces=b.namespaces,c.receiver.volume=b.receiver.volume,this.Zj.hna(a),this.rV(c.sessionId,new Rj("update_session",c)))};d.aR=function(a){this.MU(a);aj(1)};d.Hca=function(a,b,c){if(a=this.Ka.rw(a))if(b=JSON.parse(b.data))this.oU(a,b),this.rV(b.sessionId,new Rj("v2_message",b),c)};
d.h2=function(a,b){var c=Kj(b.Zd);return(b=eb(a.LA,function(a){return cb(a.capabilities,function(a){return gb(c,a)})}))?b.appId:a.gr()[0]};d.YE=function(a,b){var c=mk(a);if(!c)return Promise.reject(Error("Invalid source "+a));a=this.h2(c,b);var e=new Yg("MediaRouter.Cast.Session.Launch");return this.Dha.YE(new chrome.cast.LJ(a,void 0,c.F6()),b).then(function(a){e.end("Success");return a},function(a){e.end("Failure");throw a;})};var pk=D("mr.cast.ApiHandler");var rk=D("mr.RuntimeErrorUtils"),sk=function(){chrome.runtime.lastError&&rk.C(chrome.runtime.lastError.message||"unknown runtime error")};var tk=function(){this.kG=new H;this.lG=new H;this.Qs=new H};d=tk.prototype;d.Jn=function(a,b){b=void 0===b?!1:b;var c=this,e=a.getId(),f=a.Ga+":"+a.sb(),h=this.kG.get(e);if(h){if(this.Qs.get(e)==f)return uk.C("Using pending creation to "+e),h;uk.info("Device "+e+" IP changed from "+this.Qs.get(a.getId())+" to "+f);this.R_(a)}a=this.M3(a,b?15E3:1E4).then(function(a){c.tB(e);bj(1);return a},function(a){f==c.Qs.get(e)&&c.tB(e);bj(0);return Promise.reject(a)});this.kG.set(e,a);this.Qs.set(e,f);return a};
d.R_=function(a){a=a.getId();uk.C("Aborting connection to device "+a);var b=this.lG.get(a);b&&b.abort();this.tB(a)};d.tB=function(a){this.kG.remove(a);this.lG.remove(a);this.Qs.remove(a)};d.M3=function(a,b){var c=this,e=new Ge(function(){return c.ada(a,b)},1E3,3);this.lG.set(a.getId(),e);return e.yy(1.5).start().then(null,function(b){uk.info("Failed to create channel to "+a.getId());return Promise.reject(b)})};
d.ada=function(a,b){var c=vk++;uk.info("Connecting to (id "+c+") "+a.getId());var e=new Yg("MediaRouter.Cast.Mdns.Channel.Open");return this.cda(a,b).then(function(a){uk.info(function(){return"Channel opened (id "+c+"): "+JSON.stringify(a)});e.end("Success");return a},function(a){uk.info("Channel did not open (id "+c+").");e.end("Failure");return Promise.reject(a)})};
d.cda=function(a,b){var c={ipAddress:a.Ga,port:a.sb(),auth:"ssl_verified",timeout:1E4,livenessTimeout:b,pingInterval:5E3,capabilities:0};uk.info(function(){return"Opening channel to "+JSON.stringify(c)});var e=new Ec;chrome.cast.channel.open(c,function(a){sk();"open"==a.readyState?e.resolve(a):(chrome.cast.channel.close(a,function(){chrome.runtime.lastError||uk.C("Channel close success")}),e.reject(Error(a.errorState)))});return e.promise};var uk=D("mr.cast.ChannelFactory"),vk=0;var wk=function(a,b,c,e){return{namespace_:a,data:p(b)?b:JSON.stringify(b),sourceId:c,destinationId:e}};var xk=function(a){this.type="CLOSE";this.reasonCode=a};var yk=function(a){return(a=a.exec(Qb))?a[1]:""},zk=function(){if(ei)return yk(/Firefox\/([0-9.]+)/);if(Zb||$b||Yb)return rc;if(ii)return yk(/Chrome\/([0-9.]+)/);if(ji&&!(Ub()||C("iPad")||C("iPod")))return yk(/Version\/([0-9.]+)/);if(fi||gi){var a=/Version\/(\S+).*Mobile\/(\S+)/.exec(Qb);if(a)return a[1]+"."+a[2]}else if(hi)return(a=yk(/Android\s+([0-9.]+)/))?a:yk(/Version\/([0-9.]+)/);return""}();var Bk=function(a){this.type="CONNECT";this.origin={};this.userAgent=Qb;var b=this.userAgent.indexOf("(")+1,b=this.userAgent.substr(b,this.userAgent.indexOf(")",b)-1-b+1);this.senderInfo={sdkType:2,version:chrome.runtime.getManifest().version,browserVersion:zk,platform:Ak(),systemVersion:b,connectionType:1};this.connType=a?0:2},Ak=function(){switch(Ug()){case "ChromeOS":return 5;case "Windows":return 3;case "Mac":return 4;case "Linux":return 6}return 0};var Ck=function(){this.Wi=new H};d=Ck.prototype;d.init=function(){Wh(this)};d.TF=function(a,b,c,e){if(!this.kR(a,b,c)){var f=wk(ri,new Bk(e),b,c);chrome.cast.channel.send(a,f,sk);this.Wi.set(this.GE(a,b,c),e)}};d.t2=function(a,b,c,e){this.kR(a,b,c)&&(this.NU(a,b,c),b=wk(ri,new xk(e?5:0),b,c),chrome.cast.channel.send(a,b,sk))};d.NU=function(a,b,c){this.Wi.remove(this.GE(a,b,c))};d.Zfa=function(a){var b=this;this.Wi.xb().forEach(function(c){c.split("#")[0]==a.channelId.toString()&&b.Wi.remove(c)})};
d.gba=function(a,b){var c=this;this.Wi.forEach(function(e,f){var h=f.split("#");h[0]==a.channelId.toString()&&(c.TF(b,h[1],h[2],e),c.Wi.remove(f))})};d.h4=function(a,b,c){this.TF(a,b,c,0==c.indexOf("receiver-0"))};d.kR=function(a,b,c){return this.Wi.Wa(this.GE(a,b,c))};d.GE=function(a,b,c){return[a.channelId,b,c].join("#")};d.Ca=function(){return"cast.VirtualConnectionManager"};d.getData=function(){var a=this.Wi.g();return[new Dk(a)]};
d.tb=function(){var a=Th(this);if(a)for(var b in a.NY)this.Wi.set(b,a.NY[b])};oa(Ck);var Dk=function(a){this.NY=a};var Ek=function(a,b){this.pB=b;this.Ke=a;this.gk=new H;this.jj=new H;this.en=Ck.ga();this.X1=new tk;this.pa=null};d=Ek.prototype;d.init=function(){chrome.cast.channel.onMessage.addListener(this.Dba.bind(this));chrome.cast.channel.onError.addListener(this.Bba.bind(this));this.en.init();Wh(this)};d.cQ=function(){return this.Ke};d.Hm=function(a,b,c,e,f){var h=this,k=e||this.Ke,n=f||"receiver-0";return this.Jn(a).then(function(a){return h.uha(a,b,c,k,n)})};
d.dda=function(a,b,c,e){var f=this;return this.Jn(a).then(function(a){return f.en.TF(a,b,c,e)})};d.oL=function(a,b,c,e){(a=this.gk.get(a))&&this.en.t2(a,b,c,e)};
d.Dba=function(a,b){nh(2);var c=this.jj.get(a.channelId);if(c){var e=this.pa(c);if(e){if(xi.hasOwnProperty(b.namespace_)){c=JSON.parse(b.data);if("CLOSE"==c.type){this.en.NU(a,b.destinationId,b.sourceId);return}Fk.info("Got message "+(c.type||c.responseType)+" from "+e.getId())}else Fk.info("Got message in "+b.namespace_+" from "+e.getId());this.pB.Cba(e,b)}else Fk.u("Receiver "+c+" not found.")}else Fk.u("This message is from unknown receiver.")};
d.pL=function(a){chrome.cast.channel.close(a,function(){chrome.runtime.lastError||Fk.C("Channel close success")});var b=this.jj.get(a.channelId);b&&(this.jj.remove(a.channelId),this.gk.remove(b))};d.Bba=function(a,b){nh(1);Fk.u(function(){return"Channel error: "+JSON.stringify(a)+(b?", "+JSON.stringify(b):"")});b&&this.kfa(b);this.nL(a)};
d.kfa=function(a){var b;switch(a.errorState){case "unknown":b=0;break;case "authentication_error":b=1;break;case "connect_error":b=2;break;case "connect_timeout":b=6;break;case "ping_timeout":b=7;break;default:return}if(-8192<=a.nssErrorCode&&-7192>a.nssErrorCode||2==a.challengeReplyErrorType||8==a.challengeReplyErrorType||9==a.challengeReplyErrorType||11==a.challengeReplyErrorType||-200>=a.netReturnValue&&-300<a.netReturnValue||30==a.eventType||31==a.eventType||32==a.eventType)b=3;if(26==a.eventType||
-201==a.netReturnValue||-8181==a.nssErrorCode||-8162==a.nssErrorCode||-8161==a.nssErrorCode)b=4;-138==a.netReturnValue&&(b=5);if(-8182==a.nssErrorCode||10==a.eventType||12==a.eventType)b=1;Fk.u("Channel error code: "+b);gh("MediaRouter.Cast.Channel.Error",b,Zi)};
d.nL=function(a){var b=this,c=this.jj.get(a.channelId);this.pL(a);if(c){var e=this.pa(c);e&&this.Jn(e,!0).then(function(c){Fk.info("Re-connected to receiver: "+e.getId());b.en.gba(a,c);b.pB.Eba(e)},function(){Fk.info("Failed to re-connect to receiver: "+e.getId());b.en.Zfa(a);b.pB.BF(e,a.errorState)})}};
d.Jn=function(a,b){b=void 0===b?!1:b;var c=this,e=a.getId(),f=this.gk.get(e);return f&&"open"==f.readyState?Promise.resolve(f):this.X1.Jn(a,b).then(function(a){if(c.jj.Wa(a.channelId))return a;c.gk.get(e)&&(Fk.u("Duplicate channel to a receiver "+e),c.pL(c.gk.get(e)));Fk.info("Connected to: "+e);c.gk.set(e,a);c.jj.set(a.channelId,e);return a},null)};
d.uha=function(a,b,c,e,f){var h=this;this.en.h4(a,e,f);Mj(c);var k=wk(b,c,e,f);Fk.info("Channel is sending message");Fk.C(function(){return"....message was: "+JSON.stringify(k)});return new Promise(function(b,c){sk();chrome.cast.channel.send(a,k,function(a){a.errorState?(c(Error("Failed to send message")),h.nL(a)):b(!0)})})};d.Ca=function(){return"cast.ChannelService"};d.getData=function(){return[new Gk(this.gk.g(),this.jj.g())]};d.tb=function(){var a=Th(this);a&&(this.gk.addAll(a.hfa),this.jj.addAll(a.Y1))};
var Fk=D("mr.cast.ChannelService"),Gk=function(a,b){this.hfa=a;this.Y1=b};var Hk=function(){this.requestId=0;this.type="GET_APP_AVAILABILITY";this.appId=[]};var Ik=function(a,b){this.Hi=a;this.sa=b;this.uc=new Ee;this.Ad=new H};d=Ik.prototype;d.init=function(){Wh(this)};d.GG=function(a){var b=this.Ad.get(a);b?b.IG++:this.Ad.set(a,{IG:1});this.Uga()};d.AI=function(a){var b=this.Ad.get(a);b&&(b.IG--,0<b.IG||(re(this.sa.ul(),function(b){switch(b.Pf(a)){case "available":b.rt(a,"available_rescan");break;case "unavailable":b.rt(a,"unavailable_rescan")}}),this.Ad.remove(a)))};
d.Uga=function(){this.a.info("Scanning sinks for app availability");re(this.sa.ul(),this.mt,this)};
d.mt=function(a){var b=this;re(this.Ad.KO(),function(c){var e;a:{switch(a.Pf(c)){case "unknown":case "available_rescan":case "unavailable_rescan":e=!0;break a}e=!1}if(e){var f=a.getId()+":"+c;b.uc.contains(f)||(b.uc.add(f),e=function(){b.uc.remove(f)},(new Ge(b.b2.bind(b,a,c),5500,3)).yy(2).start().then(b.jY.bind(b,a,c),function(){b.a.error("Failed to get app availability response for "+a.getId()+", appId "+c+" after 3 attempts.");b.jY(a,c,"unknown")}).then(e,e))}})};
d.jY=function(a,b,c){c!=a.Pf(b)&&(this.a.info(b+" on "+a.getId()+" is "+c),a.rt(b,c),this.sa.Ee(a))};
d.b2=function(a,b){var c=this,e=new Hk;e.appId=[b];var f=new Yg("MediaRouter.Cast.App.Availability");return this.Hi.sendRequest(e,a,si,5E3).then(function(a){f.end("Success");c.a.C(function(){return"App availability response "+JSON.stringify(a)});for(var b in a.availability){if("APP_AVAILABLE"==a.availability[b])return"available";if("APP_UNAVAILABLE"==a.availability[b])return"unavailable"}return"unknown"},function(e){f.end("Failure");c.a.error("checkAppAvailability_ failed for "+a.getId()+", appId "+
b);throw e;})};d.Ca=function(){return"cast.AppDiscoveryService"};d.getData=function(){return[new Jk(this.Ad.g())]};d.tb=function(){var a=Th(this);a&&this.Ad.addAll(a.Ffa)};d.a=D("mr.cast.AppDiscoveryService");var Jk=function(a){this.Ffa=a};var Kk=function(a,b,c){var e;e=Error.call(this);this.message=e.message;"stack"in e&&(this.stack=e.stack);this.name="RouteRequestError";this.message=b||"";if(c)this.stack=c;else if(Error.captureStackTrace)Error.captureStackTrace(this,Kk);else if(b=Error().stack)this.stack=b;this.errorCode=a};ja(Kk,Error);var Lk=function(a,b){this.sinks=a;this.origins=b||null},Mk=new Lk([]);var Nk=function(a,b,c,e){return ni(c,"cast",b.getId(),a,e,"",null)};var Ok=function(a,b,c,e,f,h){this.routeId=a;this.clientId=b;this.appIds=c;this.autoJoinPolicy=e;this.origin=f;this.tabId=h;this.DR=this.isConnected=!1},Pk=function(){this.fc=[]};d=Pk.prototype;d.init=function(){Wh(this)};d.ma=function(){return this.fc.length};d.xe=function(a){return eb(this.fc,function(b){return b.clientId==a})};d.Dj=function(a){return eb(this.fc,function(b){return b.routeId==a})};d.AA=function(a,b,c,e,f,h){a=new Ok(a,b,c,e,f,h);this.fc.push(a);return a};
d.MG=function(a){this.fc=$a(this.fc,function(b){return b.clientId!=a})};d.Ca=function(){return"cast.ClientRecords"};d.getData=function(){return[new Qk(this.fc)]};d.tb=function(){var a=Th(this);a&&(this.fc=a.ay)};var Qk=function(a){this.ay=a};var Rk=function(a){this.sa=a},Sk=function(a){var b=[];a.forEach(function(a){var c="Receiver-"+a.replace(/\./g,"_"),f=Pi.ga().Cn||8009;b.push({serviceName:c+"._googlecast._tcp.local",serviceHostPort:c+":"+f,ipAddress:a,serviceData:["id=mdns:"+c,"ve=02","ca=5","st=1","fn="+c,"md=Chromecast"]})});return b};Rk.prototype.init=function(){var a=Sk(Pi.ga().jC);this.sa.xfa(a)};var Tk=chrome.i18n.getMessage("4528089202128275824");chrome.i18n.getMessage("2810417817914017289");chrome.i18n.getMessage("3413021810593924462");chrome.i18n.getMessage("7603034707785674700");chrome.i18n.getMessage("8009014317872238527");chrome.i18n.getMessage("8636962961150071298");chrome.i18n.getMessage("1802762746589457177");var Uk=function(a,b){this.Lh=[];this.yf=[];this.sinkId=a;this.session=b;this.fx=this.ts=null;this.offTheRecord=this.Ow=!1};d=Uk.prototype;d.AA=function(a){if(gb(this.Lh,a))return!1;this.Lh.push(a);return!0};d.MG=function(a){return nb(this.Lh,a)};d.Dg=function(a){if(gb(this.yf,a))return!1;this.yf.push(a);return!0};d.vm=function(a){return nb(this.yf,a)};d.x8=function(a,b){Ij(a)?(this.fx=a,this.ts=b):Ij(this.session)&&(this.fx=this.session,this.ts=this.sinkId,this.session=a,this.sinkId=b);return this};
var Vk=function(){this.a=D("mr.cast.SessionRecords");this.fc=[]};d=Vk.prototype;d.init=function(){Wh(this)};d.iK=function(a,b){this.a.info("Adding new session: "+b+", "+a.sessionId);var c=this.Wf(a.sessionId);if(c)return c.x8(a,b);a=new Uk(b,a);this.fc.push(a);return a};d.mp=function(a){this.a.info("Removing session "+a);this.fc=$a(this.fc,function(b){return b.session.sessionId!=a})};d.GN=function(a){return(a=this.Wf(a))?a.Lh:[]};d.rw=function(a){return(a=this.Kr(a))?a.session:null};
d.xe=function(a){return eb(this.fc,function(b){return gb(b.Lh,a)})};d.Dj=function(a){return eb(this.fc,function(b){return gb(b.yf,a)})};d.z7=function(a){return eb(this.fc,function(b){return null!=eb(b.yf,function(b){return li(b).hU==a})})};d.Kr=function(a){return eb(this.fc,function(b){return b.sinkId==a||b.ts==a})};d.Wf=function(a){return eb(this.fc,function(b){return b.session.sessionId==a})};d.gQ=function(a){return(a=this.Wf(a))?a.sinkId:null};d.QD=function(a){return(a=this.Wf(a))?a.session:null};
d.Kka=function(a,b){var c=this.QD(a);c&&(a=$a(b,function(a){return a.playerState!=chrome.cast.media.nu.IDLE}),a.forEach(function(a){if(!a.media){var b=eb(c.media,function(b){return b.mediaSessionId==a.mediaSessionId});b&&(a.media=b.media)}}),c.media=a)};d.Jea=function(a){for(var b=0;b<this.fc.length;b++)this.fc[b].MG(a)};d.Ca=function(){return"cast.SessionRecords"};d.getData=function(){return[new Wk(this.fc)]};
d.tb=function(){var a=Th(this);if(a)for(var b=0;b<a.ay.length;b++){var c=a.ay[b],e=new Uk(c.sinkId,c.session);e.Lh=c.Lh;e.yf=c.yf;e.Ow=c.Ow;e.fx=c.fx;e.ts=c.ts;this.fc.push(e)}};var Wk=function(a){this.ay=a};var Xk=function(a){this.Ke="sender-"+Ra();this.Ab=new H;this.Hl=null;Wh(this);this.L=a;this.jc=new Pk;this.Ka=new Vk;this.ae=new Ek(this.Ke,this);this.sa=new lj(this.ae,this);this.o3=new Rk(this.sa);this.re=new xj(this.ae,this.Ke);this.pe=new Ik(this.re,this.sa);this.Te=new ok(this.re,this.sa,this.jc,this.Ka,this.ae,this);this.SK=new Dj(this.sa,this.re);this.Qla=this.sa.start.bind(this.sa);this.um=new Map};d=Xk.prototype;d.getName=function(){return"cast"};
d.Tb=function(){this.re.init();this.Ka.init();this.Te.init();this.ae.init();this.sa.init();this.o3.init();this.pe.init();this.L.HG(this.Qla)};d.li=function(){var a=this.Ab.T(),b=[].concat(ka(this.um.values())).map(function(a){return a.KG.ki()});return a.concat(b)};d.ir=function(a){var b=this;if(this.zR(a))return new Lk([]);var c=new Ee;this.hr(a).forEach(function(a){b.sa.Y7(a).map(function(a){return a.Bj()}).forEach(function(a){c.add(a)})});return new Lk(c.T(),-1!=a.indexOf("0F5096E8")?sh:null)};
d.startObservingMediaSinks=function(a){var b=this,c=this.pN(a);c?(this.a.info("Received broadcast request "+a),re(this.sa.ul(),function(a){b.re.bha(c,a).catch(function(a){b.a.error("Broadcast failed "+a.message)})})):(this.hr(a).forEach(function(a){b.pe.GG(a)}),this.L.BE()&&this.sa.start())};d.stopObservingMediaSinks=function(a){var b=this;this.zR(a)||this.hr(a).forEach(function(a){b.pe.AI(a)})};d.startObservingMediaRoutes=function(){};d.stopObservingMediaRoutes=function(){};
d.pa=function(a){return(a=this.sa.pa(a))?a.Bj():null};d.gha=function(a){var b=new Mg(Tk,"warning","dismiss");b.routeId=a;this.L.ei().send(b)};d.XQ=function(a,b){this.a.error("Error launching.",b);this.vm(a.id,!1,!0,"error");this.gha(a.id)};
d.vv=function(a,b,c,e,f,h,k){var n=this;Pi.ga().sm=new Oi(b.xd,b.Ga);var q=Nk(a,b,c,!0);q.forDisplay=!1;q.offTheRecord=e;this.Ab.set(q.id,q);this.L.em(this,q);this.cu();(e=mk(a))&&e.ld()&&this.VJ(e,q.id,h,k);qh(a)||rh(a)?(q.lf={tabId:k,sessionId:"",mI:b.Ga||"",tX:b.xd||""},rh(a)&&(q.isOffscreenPresentation=!0),this.L.Kt(this,q,c,function(e){return Qg(n.jS(a,b,c,f,h,k,e))}).promise.then(function(){n.BW(q)},function(a){n.XQ(q,a)})):this.jS(a,b,c,f,h,k,q).then(null,function(a){n.XQ(q,a)});return Promise.resolve(q)};
d.jS=function(a,b,c,e,f,h,k){var n=this;return this.Te.YE(this.qG(a,b,e),b).then(function(e){n.Dg(a,b,c,e,f,h,k);return k})};
d.createRoute=function(a,b,c,e,f,h,k){var n=this,q=this.sa.pa(b);if(!q)return Pg(Error("No sink with ID "+b));var z=kk(a);if(z){setTimeout(function(){n.Te.vV(z,q,chrome.cast.nq.CAST)},0);var B=function(){return n.vv(a,q,c,e,f,h,k)},W=this.jc.xe(z);if(W)return Qg(this.terminateRoute(W.routeId).then(B,B));if(h&&k&&(b=this.EL(a,h,k,e,f,b)))return b}return Qg(this.vv(a,q,c,e,f,h,k))};d.F3=function(a,b){this.L.eg(this,a,b)};d.E3=function(a,b){var c=this.Ab.get(a);c&&c.Ln&&this.L.Cx(this,a,b)};
d.vm=function(a,b,c,e){c=void 0===c?!1:c;e=void 0===e?"closed":e;this.a.info("Remove route "+a);var f=this.jc.Dj(a);if(f){b=b||f.DR;var h=f.clientId;this.a.info("Remove client "+h);this.Ka.Jea(h);this.jc.MG(h)}if(h=this.Ka.Dj(a))h.vm(a),this.xS(h.yf);var k=this.Ab.get(a);if(k)if(k.Ln&&h&&(this.ae.oL(k.sinkId,f?f.clientId:this.Ke,h.session.transportId,b),k.forDisplay&&f&&(this.Hl={Fn:f,CV:h})),this.Ab.remove(a),this.L.Vj(this,k),this.cu(),c)this.L.onPresentationConnectionClosed(a,e,"Remove route");
else this.L.onPresentationConnectionStateChanged(a,"terminated")};d.hna=function(a){var b=this;a.yf.forEach(function(c){if(c=b.Ab.get(c)){var e=a.session;c.lf&&c.forDisplay?b.BW(c):(c.description=e.statusText||e.displayName,b.L.Wj(b,c))}})};d.dna=function(a){var b=this;bb(a,function(a){a=b.Ab.get(a,null);if(!a||!a.mediaSource)return!1;var c=mk(a.mediaSource),c=c?c.xE:!1;return a.isLocal&&!c})&&x(a,function(a){if(a=b.Ab.get(a,null))a.isLocal=!0})};
d.xS=function(a){var b=this,c=[],e=[],f=null;a.forEach(function(a){if(a=b.Ab.get(a)){a.forDisplay=!1;var h=mk(a.mediaSource);h&&eb(h.gr(),Pj)||(a.Ln?(h=h?h.vC():null,f||h==chrome.cast.Ch.CUSTOM_CONTROLLER_SCOPED||(c.push(a),f=a.sinkId)):f&&f!=a.sinkId?c.push(a):e.push(a))}});x(0<c.length?c:e,function(a){a.forDisplay=!0})};d.VJ=function(a,b,c,e){var f=a.ld();f&&!this.jc.xe(f)&&(this.a.info("Add client "+f),this.jc.AA(b,f,a.gr(),a.vC(),c||null,l(e)?e:null))};
d.BW=function(a){var b=this.Ka.Dj(a.id);b&&(b=b.session,b.statusText=a.description||b.statusText)};
d.Dg=function(a,b,c,e,f,h,k){var n=this.Ka.Kr(b.getId());n||(n=this.Ka.iK(e,b.getId()));var q=null!=a;if(!q&&Pj(e.appId))return null;var z;null==a?(z=new gk([{appId:e.appId,capabilities:e.capabilities}]),a=z.toString()):z=mk(a);var B=k;if(B){if(!this.Ab.get(B.id))return this.a.u("Route "+B.id+" not added"),B}else B=Nk(a,b,c||e.sessionId,q),this.Ab.set(B.id,B);c=B.id;this.a.info("Add route "+c);a=null;z&&(a=z.ld(),this.VJ(z,c,f,h));n.Dg(c);B.Ln&&this.ae.dda(b,a||this.Ke,e.transportId,!(z&&z.xE));n.offTheRecord=
B.offTheRecord;f=n.yf;this.dna(f);this.xS(f);f=B;h=e.sessionId;z=e.appId;("0F5096E8"==z||"85CDB22F"==z)&&h&&f.lf&&(f.lf.sessionId=h);!Nj(e,ui)||null!==e&&gb(Oj,e.appId)||(f.customControllerPath="cast_route_details.html?"+["sessionId="+h,"appId="+z].join("&"));f.description=e.statusText||e.displayName;k?this.L.Wj(this,B):this.L.em(this,B);this.cu();a&&n.AA(a)&&this.Te.pca(e,b,a);return B};
d.terminateRoute=function(a){var b=this,c=this.Ab.get(a);if(!c)return Promise.reject(new Kk(3,"Route in Cast provider not found for routeId  "+a));var e=this.Ka.Dj(a);if(!e)return this.vm(a,!0),Promise.resolve();var f=e.session.sessionId,h=this.sa.pa(c.sinkId);if(!h)return this.Te.mp(f),Promise.resolve();(a=this.jc.Dj(a))&&this.Te.vV(a.clientId,h,chrome.cast.nq.STOP);aj(0);return new Promise(function(a){var c=function(){b.Te.MU(h.getId());a()};b.re.gga(f,h).then(c,c)})};
d.G4=function(a){var b=this,c=null;se(this.Ab.eE(),function(e){if(!e.Ln)return!1;var f=b.sa.pa(e.sinkId);if(!f||!a.F$(b.qG(e.mediaSource,f)))return!1;c=e;return!0});if(!c||!c.mediaSource)return null;var e=nk(c.mediaSource);if(!e)return null;var f=this.jc.xe(e);return f?(e=this.Ka.xe(e))?{Fn:f,CV:e}:null:null};
d.O0=function(a,b,c){var e=this.G4(a);if(!e){if(!this.Hl||this.Hl.Fn.origin!=b||this.Hl.Fn.tabId!=c)return null;e=this.Hl}switch(a.vC()){case chrome.cast.Ch.PAGE_SCOPED:return null;case chrome.cast.Ch.ORIGIN_SCOPED:if(b!=e.Fn.origin)return null;break;case chrome.cast.Ch.TAB_AND_ORIGIN_SCOPED:if(b!=e.Fn.origin||c!=e.Fn.tabId)return null}return this.Ka.Wf(e.CV.session.sessionId)};
d.EL=function(a,b,c,e,f,h){var k=this,n=null;se(this.Ab.eE(),function(a){var b=a.lf;return b&&null!=b.tabId&&b.tabId==c&&oh(a.mediaSource)?(n=a,!0):!1});if(!n)return null;var q=function(){return k.createRoute(a,h||n.sinkId,"",e,f,b,null==c?void 0:c)};return Qg(this.terminateRoute(n.id).then(q,q))};
d.connectRouteByRouteId=function(a,b,c,e,f){if(!mk(a))return Pg(Error("Unsupported presentation URL"));b=li(b);b=this.Ka.Wf(b.hU);if(!b)return Pg(Error("No matching route"));var h=this.sa.pa(b.sinkId);return h?(a=this.Dg(a,h,c,b.session,e,f))?Og(a):Pg(Error("Failed to create route")):Pg(Error("No sink"))};
d.joinRoute=function(a,b,c,e,f,h){var k=mk(a);if(!k)return Pg(Error("Unsupported presentation URL"));var n;if(b==chrome.cast.vJ){if(n=this.O0(k,f,h),!n&&k.S5()!=chrome.cast.mu.CAST_THIS_TAB&&(e=this.EL(a,f,h,c,e)))return e}else n=this.LP(b);if(!n)return Pg(Error("No matching route"));if(n.offTheRecord!=c)return Pg(Error("Off the record mismatch"));e=this.sa.pa(n.sinkId);if(!e)return Pg(Error("No sink"));a=this.Dg(a,e,b,n.session,f,h);a.offTheRecord=c;return Og(a)};
d.detachRoute=function(a){this.vm(a,!1,!0)};d.qo=function(a){var b=new Kh,c=this.sa.pa(a);if(!c)return null;c=c.Zd;c&1||(b.shouldCaptureVideo=!1);c&4||(b.shouldCaptureAudio=!1);b.shouldCaptureAudio&&!b.shouldCaptureVideo&&(b.minLatencyMillis=b.maxLatencyMillis,b.animatedLatencyMillis=b.maxLatencyMillis);b.senderSideLetterboxing=!0;b.vS();this.a.info(function(){return"Settings for "+a+": "+b.Fz()});return b.shouldCaptureAudio||b.shouldCaptureVideo?b:null};d.po=function(){return"cast_streaming"};
d.sendRouteMessage=function(a,b,c){var e=this,f=this.um.get(a);if(f)return"string"!==typeof b?Promise.reject("String-typed message required"):f.KG.zea(b);if(!c)return new Promise(function(c,f){"string"!==typeof b&&f(Error("Cannot send non-string messages via ApiHandler."));e.Te.eg(a,b);c()});var h=this.Ka.Dj(a);if(!h)return Promise.reject(Error("Not managing the route "+a));var k=this.sa.pa(h.sinkId);if(!k)return Promise.reject(Error("Sink no longer accessible"));var n=(f=this.jc.Dj(a))?f.clientId:
this.Ke;return new Promise(function(a){e.ae.Hm(k,c.namespace,b,n,h.session.transportId).then(a,a)})};d.sendRouteBinaryMessage=function(a,b){var c=this.um.get(a);return c?c.KG.lha(b):Promise.reject(Error("Route "+a+" does not support sending binary data."))};d.Aq=function(a,b){var c=this.sa.pa(b);if(!c)return!1;a=this.qG(a,c);return(a=lk(a))&&0!=a.length?bb(a,function(a){return yi(c.Pf(a))}):!1};
d.zn=function(a,b,c){var e=this.hr(a);return e&&0!=e.length?b==chrome.cast.vJ?!0:c&&c.mediaSource?(a=lk(c.mediaSource),bb(a,function(a){return gb(e,a)})):void 0==b||this.LP(b)?!0:!1:!1};d.qG=function(a,b,c){return qh(a)||rh(a)?(a={appId:0==(b.Zd&1)?"85CDB22F":"0F5096E8",capabilities:Kj(b.Zd)},(new gk([a],void 0,void 0,void 0,c)).toString()):a};
d.hr=function(a){var b=[];if(qh(a)||rh(a)){var c=Ug();ph(a)&&"ChromeOS"!=c&&"Windows"!=c||b.push("85CDB22F");b.push("0F5096E8")}else(a=lk(a))&&(b=qb(b,a));return b};d.zR=function(a){return null!=this.pN(a)};d.pN=function(a){var b=mk(a);if(!b)return null;a=this.hr(a);var c=b.cB||"",b=b.bB;return c&&b?new sj(a,c,JSON.stringify(b)):null};d.LP=function(a){return 0==a.indexOf(chrome.cast.IJ)?this.Ka.Wf(a.substr(chrome.cast.IJ.length)):this.Ka.z7(a)};d.BF=function(a){this.sa.BF(a.getId());aj(2)};
d.Eba=function(a){this.Te.rU(a,!0)};d.Cba=function(a,b){this.SK.E8(a,b);this.Te.Ica(a.getId(),b)};d.fm=function(a){this.L.onSinkAvailabilityUpdated(this,1);this.Ee(a);this.Te.rU(a)};d.Fx=function(a){if(0==this.sa.SD())this.L.onSinkAvailabilityUpdated(this,0);this.Te.Fx(a.getId());this.bR()};d.Ee=function(a){this.pe.mt(a);this.bR()};d.bR=function(){this.SK.r9();this.L.sf()};d.Ca=function(){return"cast.Provider"};d.getData=function(){return[new Yk(this.Ke,this.Ab.g(),this.Hl)]};
d.tb=function(){var a=Th(this);a&&(this.Ke=a.AV,this.Ab.addAll(a.routes),this.Hl=a.T$)};d.searchSinks=function(){return null};d.cu=function(){this.L.np(this.Ca(),this.li().some(function(a){return a.isLocal}))};d.Dfa=function(a){var b=this,c=a.ki();if(this.um.has(c.id))throw Error("Cannot re-register for same route ID: "+c.id);this.a.info("Registering remoter with route: "+c.id);a=new Zk(a);this.um.set(c.id,a);this.L.em(this,c);this.cu();a.Zo=function(a){return b.L.eg(b,c.id,a)};return a};
d.Sma=function(a){a=a.ki();var b=this.um.get(a.id);b&&(this.a.info("Unregistering remoter with route: "+a.id),b.Zo=null,this.um.delete(a.id),this.L.Vj(this,a),this.cu())};d.a=D("mr.CastProvider");var Zk=function(a){this.KG=a;this.Zo=null};Zk.prototype.eha=function(a){this.Zo&&this.Zo(a)};Zk.prototype.mha=function(a){this.Zo&&this.Zo(a)};var Yk=function(a,b,c){this.AV=a;this.routes=b;this.T$=c};var $k=function(a,b){this.routeId=a;this.message=b},al=function(a){return"string"!=typeof a.message};var bl=function(a){this.ze=a;this.ug=this.Ww=null};d=bl.prototype;d.o2=function(){null!=this.ug&&(clearTimeout(this.ug),this.ug=null)};d.nV=function(){if(null==this.ug)if(null==this.Ww||Date.now()-this.Ww>=this.ze)this.Jc();else{var a=Math.max(this.Ww+this.ze-Date.now(),5);this.ug=setTimeout(this.Jc.bind(this),a)}};d.qV=function(){this.Jc()};d.Jc=function(){this.o2();this.oM();this.Ww=Date.now()};d.oM=function(){};var cl=function(a,b){bl.call(this,20);this.lh=new Map;this.Oj=new Set;this.lH=null;this.VA=this.an=0;this.rX=!1;this.L=a;this.Waa=b;this.a=D("mr.RouteMessageSender")};ja(cl,bl);d=cl.prototype;d.init=function(a){this.lH=a;Wh(this)};d.Z$=function(a){this.Oj.has(a)||(this.Oj.add(a),this.I9(a)&&this.nV())};d.stopListeningForRouteMessages=function(a){this.Oj.delete(a)};
d.send=function(a,b){var c=this.lh.get(a);c||(c=[],this.lh.set(a,c));b=new $k(a,b);c.push(b);50<c.length&&1==c.length%50&&this.a.u(function(){return"Message queue length is excessively large ("+c.length+") for route "+a});this.an+=al(b)?0:b.message.length;al(b)&&this.VA++;this.KI();this.Oj.has(a)&&this.nV()};d.Vj=function(a){this.Oj.delete(a);var b=this.lh.get(a);b&&(this.lh.delete(a),this.yT(b),this.KI())};
d.yT=function(a){if(0!=a.length){a=ia(a);for(var b=a.next();!b.done;b=a.next())b=b.value,this.an-=al(b)?0:b.message.length,al(b)&&this.VA--}};d.I9=function(a){a=this.lh.get(a);return!!a&&0<a.length};d.KI=function(){var a=0<this.VA||this.an>this.Waa;a!=this.rX&&(this.rX=a,this.L.np(this.Ca(),a))};d.oM=function(){if(this.lH){for(var a=ia(this.Oj),b=a.next();!b.done;b=a.next()){var b=b.value,c=this.lh.get(b);c&&0!=c.length&&(this.lH(b,c),this.yT(c),this.lh.set(b,[]))}this.KI()}else this.a.error("sendMessagesCallback not set. Messages not delivered.")};
d.Ca=function(){return"mr.RouteMessageSender"};d.getData=function(){var a=[].concat(ka(this.lh.entries())).map(function(a){return[a[0],a[1].map(function(a){return a.message})]});return[new dl(a,Array.from(this.Oj),this.an)]};
d.tb=function(){var a=Th(this);if(a){this.lh=new Map;for(var b={},c=ia(a.bfa),e=c.next();!e.done;b={routeId:b.routeId},e=c.next())e=e.value,b.routeId=e[0],e=e[1].map(function(a){return function(b){return new $k(a.routeId,b)}}(b)),this.lh.set(b.routeId,e);this.Oj=new Set(a.daa);this.an=a.Jma}};var dl=function(a,b,c){this.bfa=a;this.daa=b;this.Jma=c};var el=function(a,b,c){Qc.call(this);this.ti=null!=c?t(a,c):a;this.ze=b;this.Kk=t(this.QF,this);this.Hk=[]};v(el,Qc);d=el.prototype;d.rg=!1;d.hg=0;d.wb=null;d.er=function(a){this.Hk=arguments;this.wb||this.hg?this.rg=!0:this.Tn()};d.stop=function(){this.wb&&(me(this.wb),this.wb=null,this.rg=!1,this.Hk=[])};d.pause=function(){this.hg++};d.resume=function(){this.hg--;this.hg||!this.rg||this.wb||(this.rg=!1,this.Tn())};d.aa=function(){el.W.aa.call(this);this.stop()};
d.QF=function(){this.wb=null;this.rg&&!this.hg&&(this.rg=!1,this.Tn())};d.Tn=function(){this.wb=le(this.Kk,this.ze);this.ti.apply(null,this.Hk)};var fl=function(a,b){this.input=a;this.domain=b};var gl=function(a){this.gp=a;this.a=D("mr.ExternalMessageHandler")};
gl.prototype.onMessage=function(a,b,c){this.a.info("Received a message from "+b.id+" type: "+a.type);var e=chrome.runtime.id;"start"==a.type?(a=a.message,a=this.gp.searchSinks("pseudo:cloud","urn:x-org.chromium.media:source:desktop",new fl(a.meetingName,a.domain)),b="PresentationId"+b.id+hl++,this.gp.createRoute("urn:x-org.chromium.media:source:desktop",a,b).then(function(a){c(new Tf(e,"route",a.id))}).catch(function(a){c(new Tf(e,"error",a))})):"stop"==a.type?this.gp.terminateRoute(a.message.routeId).then(function(){c(new Tf(e,
"stopped"))}):(c(new Tf(e,"error",Error("Unhandled message type"))),this.a.error("Unhandled message type "+a.type))};var hl=0;var il=function(a){if(0>=a)throw Error("invalid buffer size");this.hf=[];this.Rp=[];this.Bs=a};d=il.prototype;d.enqueue=function(a){this.ma()>=this.Bs&&this.Wk();this.Rp.push(a)};d.Wk=function(){if(this.Ec())throw Error("Empty queue");0==this.hf.length&&(this.hf=this.Rp,this.hf.reverse(),this.Rp=[]);return this.hf.pop()};d.ma=function(){return this.hf.length+this.Rp.length};d.Ec=function(){return 0==this.ma()};
d.T=function(){var a=this.hf.slice();a.reverse();a.push.apply(a,[].concat(ka(this.Rp)));return a};d.clear=function(){this.hf=[];this.Rp=[]};var jl=function(){this.ra=new il(1E3);this.yk=Date.now()};d=jl.prototype;d.init=function(){yc=1;var a=D("browser"),b=window.onerror;window.onerror=function(c,f,h,k,n){b&&b(c,f,h,k,n);a.error("Error: "+c+" ("+f+" @ Line: "+h+")",n)};zc.push(this.oca.bind(this));var c=window.localStorage["debug.logs"];c&&(yc=Cc(c.toUpperCase(),0));window.localStorage["debug.console"]&&zc.push(this.fF.bind(this))};d.oca=function(a){this.ra.enqueue(this.RM(a,!1));a=a.Wh;a instanceof Error&&a.stack&&this.ra.enqueue(a.stack)};
d.fF=function(a){var b=[this.RM(a,!0)];a.Wh&&b.push(a.Wh);switch(a.level){case 3:console.error.apply(console,[].concat(ka(b)));break;case 2:console.warn.apply(console,[].concat(ka(b)));break;case 1:console.log.apply(console,[].concat(ka(b)));break;default:console.debug.apply(console,[].concat(ka(b)))}};
d.RM=function(a,b){var c=["["];if(b)c.push(("       "+((Date.now()-this.yk)/1E3).toFixed(3)).slice(-7));else{var e=new Date(a.time),f=function(a){return 10>a?"0"+a:a};c.push(e.getFullYear().toString(),"-",f(e.getMonth()+1),"-",f(e.getDate())," ",f(e.getHours()),":",f(e.getMinutes()),":",f(e.getSeconds()),".",f(Math.floor(e.getMilliseconds()/10)))}c.push("][",Bc[a.level],"][",a.A,"] ",a.message);if(!b&&null!=a.Wh)if(c.push("\n"),a.Wh instanceof Error)c.push(a.Wh.message);else try{c.push(JSON.stringify(a.Wh))}catch(h){c.push(a.Wh.toString())}c.push("\n");
return c.join("")};d.zj=function(){return 0==this.ra.ma()?"NA":this.ra.T().join("")};d.wfa=function(){Wh(this)};d.Ca=function(){return"LogManager"};d.getData=function(){return[this.ra.T()]};d.tb=function(){var a=this.ra.T();this.ra.clear();for(var b=ia(Th(this)||[]),c=b.next();!c.done;c=b.next())this.ra.enqueue(c.value);a=ia(a);for(c=a.next();!c.done;c=a.next())this.ra.enqueue(c.value)};oa(jl);var kl=function(a){this.gp=a;this.a=D("mr.InternalMessageHandler")};
kl.prototype.onMessage=function(a,b,c){var e=this;if("retrieve_log_data"!=a.type)c(new Tf(chrome.runtime.id,"error",Error("Unhandled message type")));else{var f={logs:jl.ga().zj(),device:Pi.ga().x7()};b=[];var h=Yf(f.device.ip).then(function(a){a&&(f.device.version=a)});b.push(h);var k=this.gp.ps;k&&(a=this.iaa(k,a.source).then(function(a){a&&(f.castStreamingLogs=a)},function(){e.a.error("Log upload failed for service: "+k)}),b.push(a));b.push(this.XJ(f,"mr.cast.SinkDiscoveryService","castDeviceCounts"));
b.push(this.XJ(f,"mr.dial.SinkDiscoveryService","dialDeviceCounts"));kj(b).then(function(){c(f)})}};kl.prototype.XJ=function(a,b,c){var e=this;return zh(b).then(function(b){b=b.Ng;a[c]=b.Lo+"."+b.vn},function(){e.a.error("Failed to get device counts for "+c+".")})};kl.prototype.iaa=function(a,b){return this.gp.lw(a).then(function(a){return a.Ge(b)})};var ll=function(){this.wd=null;this.a=D("mr.IssueSenderImpl")};ll.prototype.init=function(a){this.wd=a};ll.prototype.send=function(a){if(this.wd)if(this.wd.onIssue)this.wd.onIssue(a);else this.a.error("MediaRouterService.onIssue not defined.");else this.a.error("MediaRouterService is not set.")};var ml=function(a,b){E.call(this,"internal_message");this.routeId=a;this.message=b};ja(ml,E);var nl=function(a,b,c){this.ly=a;this.ph=b;this.Uaa=c;this.onMessage=function(){};c.listen("internal_message",this.Ex,!1,this)};nl.prototype.sendMessage=function(a,b){return this.ph(this.ly,a,b)};nl.prototype.Ex=function(a){if(a.routeId==this.ly)this.onMessage(a.message)};nl.prototype.fb=function(){this.onMessage=function(){};this.Uaa.Hd("internal_message",this.Ex,!1,this)};var ol=new nl("",function(){return Promise.resolve()},new F),pl=function(a){this.L=a};
pl.prototype.gw=function(a){var b=this.L.yD(a);return b?new nl(a,b.sendRouteMessage.bind(b),this.L.LD()):ol};var ql=function(){this.a=D("mr.ProviderManager");this.vf=[];this.Ie=new Map;this.pp=new Map;this.Pi=new Set;this.Cm=new Set;this.Hs=new Map;this.wd=this.ps=null;this.Gp=!1;this.fV=new F;this.gV=new el(this.rha,500,this);this.Cla=new el(this.o4,500,this);this.Zl=new cl(this,524288);this.nG=0;this.PR=new ll;this.Hp=new Map;this.qx=-1==window.navigator.userAgent.indexOf("Windows");this.px=[];this.Sw=[];this.vR=new kl(this);this.DM=new gl(this);this.onBeforeInvokeHandler=this.zba;this.createRoute=this.createRoute;
this.joinRoute=this.joinRoute;this.connectRouteByRouteId=this.connectRouteByRouteId;this.terminateRoute=this.terminateRoute;this.startObservingMediaSinks=this.startObservingMediaSinks;this.stopObservingMediaSinks=this.stopObservingMediaSinks;this.sendRouteMessage=this.sendRouteMessage;this.sendRouteBinaryMessage=this.sendRouteBinaryMessage;this.startListeningForRouteMessages=this.startListeningForRouteMessages;this.stopListeningForRouteMessages=this.stopListeningForRouteMessages;this.startObservingMediaRoutes=
this.startObservingMediaRoutes;this.stopObservingMediaRoutes=this.stopObservingMediaRoutes;this.onPresentationSessionDetached=this.detachRoute=this.detachRoute;this.enableMdnsDiscovery=this.enableMdnsDiscovery;this.searchSinksAndCreateRoute=this.searchSinksAndCreateRoute;this.searchSinks=this.searchSinks;this.updateMediaSinks=this.updateMediaSinks};ja(ql,uh);d=ql.prototype;
d.handleEvent=function(a,b){for(var c=[],e=1;e<arguments.length;++e)c[e-1]=arguments[e];if(a==chrome.runtime.onMessage)this.vR.onMessage.apply(this.vR,[].concat(ka(c)));else if(a==chrome.runtime.onMessageExternal)this.DM.onMessage.apply(this.DM,[].concat(ka(c)));else throw Error("Unhandled event");};d.lw=function(a){var b=this;a=this.Hs.get(a);return zh(a).then(function(a){a.Tb(b);return a})};d.vfa=function(a){a.forEach(this.Cfa,this)};
d.Tb=function(a,b){this.Hs.set("webrtc","mr.mirror.webrtc.WebRtcService");this.Hs.set("cast_streaming","mr.mirror.cast.Service");this.Hs.set("hangouts","mr.mirror.hangouts.HangoutsService");this.Hs.set("meetings","mr.mirror.hangouts.MeetingsService");var c=new pl(this);Lg||(Lg=c);this.wd=a;this.PR.init(a);this.Zl.init(this.wd.onRouteMessagesReceived.bind(this.wd));this.vfa(b);Wh(this);Eh("mr.ProviderManager",this)};
d.Cfa=function(a){if(this.Ir(a.getName()))this.a.u("Provider "+a.getName()+" already registered.");else try{a.Tb(),this.vf.push(a),this.Hp.set(a.getName(),0)}catch(b){this.a.u("Provider "+a.getName()+" failed to initialize.",b)}};
d.uu=function(a,b){var c=this;return new Promise(function(e,f){var h=null;c.xea();var h=window.setTimeout(function(){h=null;a.cancel(new Kk(2,"timeout after "+b+" ms."))},b),k=function(){c.A0();null!=h&&window.clearTimeout(h)};a.promise.then(function(a){k();e(a)},function(a){k();f(a instanceof Kk?a:a instanceof Error?new Kk(0,a.message,a.stack):new Kk(0))})})};d.ZJ=function(a,b){return this.uu(Qg(a),b)};d.xea=function(){this.nG++;this.iF()};d.A0=function(){this.nG--;this.iF()};d.zba=function(){nh(0)};
d.createRoute=function(a,b,c,e,f,h,k){var n=this,q=this.u7(a,b);if(!q)return Promise.reject(new Kk(7,"No provider supports createRoute with source: "+a+" and sink: "+b));h=h&&0<h?h:6E4;a=q.createRoute(a,b,c,k||!1,h,e,f);return this.uu(a,h).then(function(a){return a},function(a){n.a.error("Error creating route.",a);throw a;})};
d.connectRouteByRouteId=function(a,b,c,e,f,h){var k=this.Ie.get(b);if(!k)return Promise.reject(new Kk(7,"No provider supports join "+b));a=k.connectRouteByRouteId(a,b,c,e,f);return this.uu(a,h&&0<h?h:3E4)};d.joinRoute=function(a,b,c,e,f,h){var k=this.t7(a,b);if(!k)return Promise.reject(new Kk(7,"No provider supports join "+b));f=f&&0<f?f:3E4;a=k.joinRoute(a,b,h||!1,f,c,e);return this.uu(a,f)};
d.terminateRoute=function(a){var b=this.Ie.get(a);return b?this.ES(a).then(function(){return b.terminateRoute(a)}):Promise.reject(new Kk(3,"Route not found for routeId "+a))};d.startObservingMediaSinks=function(a){this.Pi.has(a)||(this.Pi.add(a),this.vf.forEach(function(b){b.startObservingMediaSinks(a)}));this.yG(a)};d.stopObservingMediaSinks=function(a){this.Pi.delete(a)?this.pM(a):this.a.info("No existing query "+a)};d.pM=function(a){this.vf.forEach(function(b){b.stopObservingMediaSinks(a)})};
d.yG=function(a){var b=this;if("urn:x-org.chromium.media:source:tab:-1"==a)this.a.u("No sinks for sourceUrn: "+a);else{var c=new Map,e=[];this.vf.forEach(function(f){var h=f.ir(a);0<h.sinks.length&&(e=h.origins);h.sinks.forEach(function(a){c.has(a.id)?b.a.u("Detected duplicate sink "+a.id+" from provider: "+f.getName()):c.set(a.id,a)})});this.sha(a,Array.from(c.values()),e||[])}};d.sha=function(a,b,c){this.a.info("Sending "+b.length+" sinks to MR for "+a);this.wd.onSinksReceived(a,b,c)};
d.sendRouteMessage=function(a,b,c){var e=this.Ie.get(a);return e?this.ZJ(e.sendRouteMessage(a,b,c),3E4):Promise.reject(Error("Invalid route ID "+a))};d.sendRouteBinaryMessage=function(a,b){var c=this.Ie.get(a);return c?this.ZJ(c.sendRouteBinaryMessage(a,b),3E4):Promise.reject(Error("Invalid route ID "+a))};d.startListeningForRouteMessages=function(a){this.Zl.Z$(a)};d.stopListeningForRouteMessages=function(a){this.Zl.stopListeningForRouteMessages(a)};
d.detachRoute=function(a){var b=this.Ie.get(a);b?b.detachRoute(a):this.a.info("Route "+a+" does not exist.")};d.enableMdnsDiscovery=function(){this.qx=!0;this.px.forEach(function(a){a()});this.px.length=0};d.u7=function(a,b){return this.vf.find(function(c){return c.Aq(a,b)})||null};d.t7=function(a,b){return this.vf.find(function(c){return c.zn(a,b)})||null};d.o4=function(){var a=this;this.Pi.forEach(function(b){a.yG(b)})};d.iF=function(){this.wd.setKeepAlive(0<this.nG||0<this.Sw.length)};
d.startObservingMediaRoutes=function(a){this.Cm.has(a)||(this.Gp=!0,this.Cm.add(a),this.vf.forEach(function(b){b.startObservingMediaRoutes(a)}));this.gV.er()};d.stopObservingMediaRoutes=function(a){this.Cm.delete(a)?(0==this.Cm.size&&(this.Gp=!1),this.vf.forEach(function(b){b.stopObservingMediaRoutes(a)})):this.a.info("No existing route query "+a)};
d.rha=function(){var a=this;if(this.Gp){var b=[];this.vf.forEach(function(a){b=b.concat(a.li())});this.Cm.forEach(function(c){var e=[];a.vf.forEach(function(a){a.li().forEach(function(b){!b.Ln&&a.zn(c,void 0,b)&&e.push(b.id)})});a.wd.onRoutesUpdated(b,c,e)})}};d.Ca=function(){return"ProviderManager"};
d.getData=function(){return[new rl(this.vf.map(function(a){return a.getName()}),Array.from(this.Pi),Array.from(this.Cm),this.Gp,Array.from(this.Ie,function(a){var b=ia(a);a=b.next().value;b=b.next().value;return[a,b.getName()]}),Array.from(this.Hp),this.qx,this.ps)]};
d.tb=function(){var a=Th(this);if(a){this.Pi=new Set(a.Bla);this.Cm=new Set(a.Hga);this.Gp=a.yla;for(var b=ia(a.Fga),c=b.next();!c.done;c=b.next()){var e=ia(c.value),c=e.next().value,e=e.next().value,e=this.Ir(e);this.Ie.set(c,e)}this.Hp=new Map(a.Ala);this.ps=a.V$||null;a.Iaa&&this.enableMdnsDiscovery()}};d.yD=function(a){return this.Ie.get(a)};d.em=function(a,b){this.Ie.set(b.id,a);this.Wj(a,b)};d.Vj=function(a,b){this.ES(b.id);this.Ie.delete(b.id);this.Zl.Vj(b.id);this.Wj(a,b)};
d.Wj=function(){this.Gp&&this.gV.er()};d.zT=function(a){var b=this.Ie.get(a.id);b&&this.Wj(b,a)};d.eg=function(a,b,c){this.Ie.has(b)?("string"===typeof c||c instanceof Uint8Array||(c=JSON.stringify(c)),this.Zl.send(b,c)):this.a.u("Got route message for closed route "+b)};d.onPresentationConnectionStateChanged=function(a,b){"terminated"==b&&this.Zl.qV();this.wd.onPresentationConnectionStateChanged(a,b)};
d.onPresentationConnectionClosed=function(a,b,c){this.Zl.qV();this.wd.onPresentationConnectionClosed(a,b,c)};d.IF=function(a){this.pp.delete(a);var b=this.Ie.get(a);b&&b.terminateRoute(a)};d.Cx=function(a,b,c){this.fV.dispatchEvent(new ml(b,c))};d.sf=function(){this.Cla.er()};
d.onSinkAvailabilityUpdated=function(a,b){var c=this;if(this.Hp.get(a.getName())!=b){var e=this.vL();this.Hp.set(a.getName(),b);a=this.vL();e!=a&&(this.wd.onSinkAvailabilityUpdated(a),0==a&&(this.Pi.forEach(function(a){c.pM(a)}),this.Pi.clear()))}};d.vL=function(){return Array.from(this.Hp.values()).reduce(function(a,b){return Math.max(a,b)},0)};d.LD=function(){return this.fV};d.ei=function(){return this.PR};
d.ES=function(a){var b=this;return this.pp.has(a)?this.lw(this.pp.get(a)).then(function(c){b.pp.delete(a);return c.CX()}):Promise.resolve(!1)};d.Kt=function(a,b,c,e){var f=this,h=a.po(b.sinkId);this.a.info("Starting mirroring using service: "+h);this.pp.set(b.id,h);return Rg(this.lw(h),function(k){f.ps=h;return k.Kt(b,b.mediaSource,a.qo(b.sinkId),c,e).catch(function(a){if(a instanceof jh&&3==a.reason)throw new Kk(8);throw a;})})};
d.Mz=function(a,b,c,e,f,h){var k=this,n=this.pp.get(b.id);return n?Rg(this.lw(n),function(q){k.ps=n;return q.Mz(b,c,a.qo(b.sinkId),e,f,h)}):Pg(Error("Route "+b.id+" is not mirroring"))};d.HG=function(a){this.qx?a():-1==this.px.indexOf(a)&&this.px.push(a)};d.BE=function(){return this.qx};d.np=function(a,b){var c=this.Sw.indexOf(a),e=0<=c;b&&!e?this.Sw.push(a):!b&&e&&this.Sw.splice(c,1);this.iF()};d.Ir=function(a){return this.vf.find(function(b){return b.getName()==a})||null};
d.HP=function(a){return a.startsWith("pseudo:")?a.substring(7):null};d.searchSinksAndCreateRoute=function(a,b,c,e,f,h,k,n){var q=this.HP(a),q=q?this.Ir(q):null,z=null;q&&(z=q.searchSinks(b,c));if(z)return this.wd.onSearchSinkIdReceived(a,z.id),this.createRoute(b,z.id,e,f,h,k,n);this.wd.onSearchSinkIdReceived(a,"");return Promise.reject(new Kk(0,"No sink found for search input: "+c.input+" and source: "+b))};
d.searchSinks=function(a,b,c){a=(a=this.HP(a))?this.Ir(a):null;var e=null;a&&(e=a.searchSinks(b,c));return e?e.id:""};d.updateMediaSinks=function(a){this.Pi.has(a)||this.yG(a)};var rl=function(a,b,c,e,f,h,k,n){this.Bla=b;this.Hga=c;this.yla=e;this.Fga=f;this.Ala=h;this.Iaa=k;this.V$=n};var sl=!ac&&!Zb||Zb&&9<=Number(uc)||ac&&tc("1.9.1");Zb&&tc("9");var tl=function(a,b){this.width=a;this.height=b};d=tl.prototype;d.clone=function(){return new tl(this.width,this.height)};d.toString=function(){return"("+this.width+" x "+this.height+")"};d.L0=function(){return this.width*this.height};d.Ec=function(){return!this.L0()};d.ceil=function(){this.width=Math.ceil(this.width);this.height=Math.ceil(this.height);return this};d.floor=function(){this.width=Math.floor(this.width);this.height=Math.floor(this.height);return this};
d.round=function(){this.width=Math.round(this.width);this.height=Math.round(this.height);return this};d.scale=function(a,b){b=r(b)?b:a;this.width*=a;this.height*=b;return this};var ul={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",frameborder:"frameBorder",height:"height",maxlength:"maxLength",nonce:"nonce",role:"role",rowspan:"rowSpan",type:"type",usemap:"useMap",valign:"vAlign",width:"width"},vl=function(a){a=a.document;a="CSS1Compat"==a.compatMode?a.documentElement:a.body;return new tl(a.clientWidth,a.clientHeight)},wl=function(a){return a?a.parentWindow||a.defaultView:window},yl=function(a,b,c,e){function f(c){c&&b.appendChild(p(c)?a.createTextNode(c):
c)}for(;e<c.length;e++){var h=c[e];!sa(h)||ua(h)&&0<h.nodeType?f(h):x(xl(h)?A(h):h,f)}},zl=function(a){return 9==a.nodeType?a:a.ownerDocument||a.document},Al=function(a,b){if("textContent"in a)a.textContent=b;else if(3==a.nodeType)a.data=b;else if(a.firstChild&&3==a.firstChild.nodeType){for(;a.lastChild!=a.firstChild;)a.removeChild(a.lastChild);a.firstChild.data=b}else{for(var c;c=a.firstChild;)a.removeChild(c);a.appendChild(zl(a).createTextNode(String(b)))}},xl=function(a){if(a&&"number"==typeof a.length){if(ua(a))return"function"==
typeof a.item||"string"==typeof a.item;if(ta(a))return"function"==typeof a.item}return!1},Bl=function(a){this.Uq=a||g.document||document};d=Bl.prototype;d.getElementsByTagName=function(a,b){return(b||this.Uq).getElementsByTagName(String(a))};d.setProperties=function(a,b){Bb(b,function(b,e){"style"==e?a.style.cssText=b:"class"==e?a.className=b:"for"==e?a.htmlFor=b:ul.hasOwnProperty(e)?a.setAttribute(ul[e],b):Da(e,"aria-")||Da(e,"data-")?a.setAttribute(e,b):a[e]=b})};d.createElement=function(a){return this.Uq.createElement(String(a))};
d.createTextNode=function(a){return this.Uq.createTextNode(String(a))};d.getWindow=function(){var a=this.Uq;return a.parentWindow||a.defaultView};d.appendChild=function(a,b){a.appendChild(b)};d.append=function(a,b){yl(zl(a),a,arguments,1)};d.canHaveChildren=function(a){if(1!=a.nodeType)return!1;switch(a.tagName){case "APPLET":case "AREA":case "BASE":case "BR":case "COL":case "COMMAND":case "EMBED":case "FRAME":case "HR":case "IMG":case "INPUT":case "IFRAME":case "ISINDEX":case "KEYGEN":case "LINK":case "NOFRAMES":case "NOSCRIPT":case "META":case "OBJECT":case "PARAM":case "SCRIPT":case "SOURCE":case "STYLE":case "TRACK":case "WBR":return!1}return!0};
d.removeNode=function(a){return a&&a.parentNode?a.parentNode.removeChild(a):null};d.getChildren=function(a){return sl&&void 0!=a.children?a.children:$a(a.childNodes,function(a){return 1==a.nodeType})};d.isElement=function(a){return ua(a)&&1==a.nodeType};d.contains=function(a,b){if(!a||!b)return!1;if(a.contains&&1==b.nodeType)return a==b||a.contains(b);if("undefined"!=typeof a.compareDocumentPosition)return a==b||!!(a.compareDocumentPosition(b)&16);for(;b&&a!=b;)b=b.parentNode;return b==a};var Cl=function(a){Qc.call(this);this.F=a;this.Ta={}};v(Cl,Qc);var Dl=[];d=Cl.prototype;d.listen=function(a,b,c,e){return this.oS(a,b,c,e)};d.baa=function(a,b,c,e,f){return this.oS(a,b,c,e,f)};d.oS=function(a,b,c,e,f){ra(b)||(b&&(Dl[0]=b.toString()),b=Dl);for(var h=0;h<b.length;h++){var k=jd(a,b[h],c||this.handleEvent,e||!1,f||this.F||this);if(!k)break;this.Ta[k.key]=k}return this};d.Kl=function(a,b,c,e){return this.mS(a,b,c,e)};
d.mS=function(a,b,c,e,f){if(ra(b))for(var h=0;h<b.length;h++)this.mS(a,b[h],c,e,f);else{a=rd(a,b,c||this.handleEvent,e,f||this.F||this);if(!a)return this;this.Ta[a.key]=a}return this};d.Hd=function(a,b,c,e,f){if(ra(b))for(var h=0;h<b.length;h++)this.Hd(a,b[h],c,e,f);else c=c||this.handleEvent,f=f||this.F||this,c=kd(c),e=!!e,b=bd(a)?a.zr(b,c,e,f):a?(a=nd(a))?a.zr(b,c,e,f):null:null,b&&(td(b),delete this.Ta[b.key]);return this};
d.removeAll=function(){Bb(this.Ta,function(a,b){this.Ta.hasOwnProperty(b)&&td(a)},this);this.Ta={}};d.aa=function(){Cl.W.aa.call(this);this.removeAll()};d.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented");};var El=function(){this.Of=[];this.Fg=[]};d=El.prototype;d.Baa=function(){hb(this.Of)&&(this.Of=this.Fg,this.Of.reverse(),this.Fg=[])};d.enqueue=function(a){this.Fg.push(a)};d.Wk=function(){this.Baa();return this.Of.pop()};d.ma=function(){return this.Of.length+this.Fg.length};d.Ec=function(){return hb(this.Of)&&hb(this.Fg)};d.clear=function(){this.Of=[];this.Fg=[]};d.contains=function(a){return gb(this.Of,a)||gb(this.Fg,a)};
d.remove=function(a){var b;b=this.Of;var c=Ya(b,a);0<=c?(mb(b,c),b=!0):b=!1;return b||nb(this.Fg,a)};d.T=function(){for(var a=[],b=this.Of.length-1;0<=b;--b)a.push(this.Of[b]);for(var c=this.Fg.length,b=0;b<c;++b)a.push(this.Fg[b]);return a};var Fl=function(a,b,c,e,f,h,k,n){this.df=null;this.lL=!1;this.kL=G();this.Ic=[];this.Cf=a?encodeURIComponent(String(a)):null;this.VM=null;!e&&b&&(this.VM=b);this.F0=c||null;this.Gu=!e;this.Av=null!=f?f:null;this.Ax=h||null;this.wna=!!k;this.WM=n||null};v(Fl,Qc);var Gl;var Hl=Se("https://apis.google.com/js/client.js");Hl instanceof Re&&Hl.constructor===Re&&Hl.y_===Qe?Gl=Hl.sI:(w("expected object of type Const, got '"+Hl+"'"),Gl="type_error:Const");var Il=new $e;Il.tG=Gl;d=Fl.prototype;
d.init=function(){var a=t(function(a){this.df=a;var b=ma("client.request",a),c=ma("auth",a);b&&c?this.UQ():a.load("client",t(this.UQ,this))},this),b=this.IM("gapi");b?a(b.gapi):this.gaa(a);return this.kL.promise};d.IM=function(a){for(var b=window,c=ma(a,b);!c&&b!=window.top&&this.M1(b.parent,a);)b=b.parent,c=ma(a,b);return c?b:null};d.M1=function(a,b){try{return!!a&&null!=a.location.href&&Wb(a,b)}catch(c){return!1}};
d.gaa=function(a){var b=this.IM("gapi_onload");if(b){var c=b.gapi_onload;b.gapi_onload=function(){c();a(b.gapi)}}else{window.gapi_onload=function(){a(window.gapi)};var e=document.createElement("script");e.src=af(Il);this.WM&&Al(e,kf(this.WM));document.getElementsByTagName("head")[0].appendChild(e)}};d.UQ=function(){for(var a=0;a<this.Ic.length;a++)this.Ic[a].Pb.resolve(this.xV(this.Ic[a].dga));this.lL=!0;this.kL.resolve(this.df)};
d.sendRequest=function(a){if(this.lL)return this.xV(a);var b=G();this.Ic.push({dga:a,Pb:b});return b.promise};
d.xV=function(a){var b,c,e,f=ma("config.get",this.df);this.Gu||(b=f("googleapis.config/auth/useFirstPartyAuth"),c=f("googleapis.config/auth/useOriginToken"));null!=this.Av&&(e=f("client/cors"));try{var h=ma("config.update",this.df);this.Gu||(h("googleapis.config/auth/useFirstPartyAuth",!1),h("googleapis.config/auth/useOriginToken",!1));null!=this.Av&&h("client/cors",this.Av);var k=ma("client.request",this.df),n=this.l5();a.headers&&Pb(n,a.headers);var q={headers:n,root:this.F0,path:a.path,method:a.method,
body:a.body},z=a.params||{};this.Cf&&!this.Ax?Pb(z,{key:this.Cf}):this.Ax&&Pb(z,{key:null});Ib(z)||(q.params=z);var B=Zd(k(q));a.callback&&B.then(function(b){a.callback.apply(null,[b.result,b])},function(b){a.callback.apply(null,[b.result,b])});return B}finally{h=ma("config.update",this.df),this.Gu||(h("googleapis.config/auth/useFirstPartyAuth",b),h("googleapis.config/auth/useOriginToken",c)),null!=this.Av&&h("client/cors",e)}};
d.l5=function(){if(this.Gu){if(this.Ax)return{Authorization:"Bearer "+this.Ax};var a=ma("auth.getAuthHeaderValueForFirstParty",this.df);return{Authorization:this.wna?a([]):a(),"X-Goog-AuthUser":this.VM}}return{}};var Jl=function(a,b){this.aj=a;this.Oma=b},Kl=new Jl("https://www.googleapis.com/clouddevices/v1","AIzaSyAOZM8ZYeov685QMjXT3sC7XNizfrTEKjA"),Ll=new Jl("https://www.googleapis.com/calendar/v3",""),Ml=new Jl("https://www.googleapis.com/hangouts/v1",""),Nl=new Jl("https://networktraversal.googleapis.com/v1alpha","AIzaSyAOZM8ZYeov685QMjXT3sC7XNizfrTEKjA");var Ol=function(a,b,c,e,f,h){c=void 0===c?null:c;a||null==c&&(c="default");this.FR=a;this.Na=b;this.Vn=c;this.To=void 0===e?null:e;this.vg=void 0===f?null:f;this.Am=void 0===h?null:h};d=Ol.prototype;d.ai=function(){var a="";this.vg?a=this.vg:this.To&&(a=this.To);return a};d.dh=function(){return this.FR};d.getId=function(){return this.Na};d.xj=function(){return this.Vn};d.merge=function(a){!this.Am&&a.Am&&(this.Am=a.Am);!this.vg&&a.vg&&(this.vg=a.vg);this.vg&&a.vg&&this.Am&&(this.vg=a.vg)};var Pl=function(a,b){this.Sb=a;this.td=b;this.a=D("mr.cloud.calendar.CalendarService")};d=Pl.prototype;d.I4=function(){var a=this;return this.Q5(this.td.wg,9E5).then(function(b){a.a.info(a.ZM(b.length)+" events discovered before filtering.");return a.x6(b)},function(b){a.a.u("Error getting Hangouts from calendar.",b);return[]})};d.ZM=function(a){return 20<a?"20+":a.toString()};d.Q5=function(a,b){var c=this,e=Date.now();return this.z5(a,new Date(e),new Date(e+b)).then(function(a){return a.filter(c.w$)})};
d.w$=function(a){return!(!a.start||!a.end||a.start.date||a.end.date||!a.start.dateTime||!a.end.dateTime)};d.z5=function(a,b,c){a=this.Sb.el(Ll.aj,["calendars",a,"events"],{timeMin:b.toJSON(),timeMax:c.toJSON(),singleEvents:!0});this.a.C("Retrieving Hangouts from Calendar: "+a);return this.Sb.fj(a,"GET").then(function(a){return a.items?a.items:[]})};
d.x6=function(a){var b=this,c=[];a.filter(function(a){return a.hangoutLink}).forEach(function(a){var e=new Vj(a.hangoutLink);if("meet.google.com"==e.xj())c.push(new Ol(!0,e.Hc.substring(1),void 0,void 0,a.summary));else if(e=b.Bda(e.Hc),2==e.length){var h=ia(e),e=h.next().value,h=h.next().value,k,n;-1!=e.indexOf(".")&&(k=h,n=e);c.push(new Ol(!1,h+"@"+e,n,k,a.summary,void 0))}else b.a.u("Invalid hangout link from calendar event: "+a.hangoutLink)});this.a.info(this.ZM(c.length)+" events discovered with Hangout links.");
return c};d.Bda=function(a){return a.substring(12).split("/")};var Ql=function(a){this.Bc=a;this.id=a.id;this.a=D("mr.cloud.devices.CloudDevice")};d=Ql.prototype;d.isAvailable=function(){if(this.getState().appStatus){var a=this.r$(),b=this.m$(),c=this.eL(864E5);this.a.C("Device id: "+this.id+", availability: GCM connected "+a+", app Available: "+b+", checked in: "+c);return a&&b&&c}a=this.eL(9E5);this.a.info("Availability for legacy receiver app: "+a);return a};d.eL=function(a){var b=this.E6();return!!(b&&b>Date.now()-a)};d.m$=function(){return"available"==this.getState().appStatus};
d.r$=function(){return"online"==this.Bc.connectionStatus};d.E6=function(){return this.Bc.lastUpdateTimeMs?Number(this.Bc.lastUpdateTimeMs):null};d.ai=function(){return this.getState().settings.receiverName};d.getId=function(){return this.id};d.getState=function(){return this.Bc.state._cloudCast};d.x$=function(){return this.Bc.invitations?0!=this.Bc.invitations.length:!1};var Rl=function(a,b){this.email=a;this.imageUrl=null!=b?b:null},Sl=function(a){this.type=a},Tl=function(a,b,c){this.type="__cloud_webrtc_session_message__";this.sessionDescription=a;this.user=null!=b?b:null;this.flungUrl=null!=c?c:null};ja(Tl,Sl);
var Ul=function(a,b,c){this.name=a;this.parameters=b;this.minimalRole=null!=c?c:"user"},Vl={_settings:{type:"string"},_presentationRequest:{type:"string"},_optMediaConstraints:{type:"string"},_webrtcMessage:{type:"string"},_user:{type:"string"}},Wl=new Ul("_knockingStartWebrtcSession",Vl,"viewer"),Xl=new Ul("_startWebrtcSession",Vl),Yl=new Ul("_stopSession",{},"viewer");var Zl=function(a){this.Sb=a;this.Yn=this.No=this.Il=null;this.Pw=this.Nw=!1;this.a=D("mr.cloud.devices.CloudDevicesService");Wh(this)};d=Zl.prototype;d.getDevice=function(a){a=this.Sb.el(Kl.aj,["devices",a]);return this.Sb.fj(a,"GET").then(function(a){return new Ql(a)})};d.Y$=function(){return this.lS({descriptionSubstring:"Chrome Streaming Receiver"})};
d.lS=function(a){var b=this,c=this.Sb.el(Kl.aj,["devices"],a);return this.Sb.fj(c,"GET").then(function(c){var e=(c.devices||[]).filter(function(a){return null!=a.commandDefs&&null!=a.commandDefs._cloudCast}).map(function(a){return new Ql(a)});if(c=c.nextPageToken){var h=Lb(a);h.token=c;return b.lS(h).then(function(a){return e.concat(a)})}return e})};d.Ca=function(){return"CloudDevicesService"};d.getData=function(){return[new $l(this.Il,this.Yn,this.No)]};
d.tb=function(){var a=Th(this);a&&(this.Il=a.U$,this.Yn=a.gcmRegistrationId,this.No=a.S$)};d.Afa=function(){var a=this;return new Promise(function(b,c){a.Nw?c(Error("Registering...")):(a.Nw=!0,a.Yn&&a.No&&a.No+864E5>=Date.now()?(a.Nw=!1,b(a.Yn)):chrome.gcm.register(["919648714761"],function(e){a.Nw=!1;e?(a.a.C("Got GCM ID: "+e),a.Yn=e,a.No=Date.now(),a.Il=null,b(e)):(a.a.u("Error: "+chrome.runtime.lastError.message),a.Yn=null,a.No=null,a.Il=null,c(Error(chrome.runtime.lastError.message)))}))})};
d.vla=function(){return!this.Il||this.Il+864E5<Date.now()};d.subscribe=function(a){var b=this;if(this.Pw)return Promise.resolve();this.Pw=!0;if(!a||!this.vla())return Promise.resolve();a={filters:["myDevices"],gcmRegistrationId:a,gcmSenderId:"919648714761",expirationTimeMs:864E5};var c=this.Sb.el(Kl.aj,["subscriptions","subscribe"],{});return this.Sb.fj(c,"POST",a).then(function(){b.a.C("Subscribed on: "+Date.now());b.Il=Date.now();b.Pw=!1;return Promise.resolve()},function(a){b.Pw=!1;throw a;})};
var $l=function(a,b,c){this.U$=a;this.gcmRegistrationId=b;this.S$=c};var am={ACCEPTED:0,tpa:1,TIMEOUT:2},bm={SUCCESS:0,AZ:1},cm={O_:0,l_:1,qta:2,gqa:3,fqa:4,Xqa:5,TIMEOUT:6,Wra:7},dm={dqa:0,Lsa:1},em={Dra:0,Mqa:1,USER:2,Ypa:3},fm=function(a){gh("MediaRouter.Cloud.Knock.Result",a,am)},gm=function(a){gh("MediaRouter.Cloud.Session.Start",a,bm)},hm=function(a){gh("MediaRouter.Cloud.Session.Type",a,dm)},im=function(a){gh("MediaRouter.Cloud.Device.UserRole",a,em)};var jm=function(a,b){for(var c=[],e=1;e<arguments.length;++e)c[e-1]=arguments[e];for(var e=a,c=ia(c),f=c.next();!f.done;f=c.next()){if(void 0==e||"object"!=typeof e)return;e=e[f.value]}return e};var km=function(){ej.call(this,5,"cloud.GcmEventListener","mr.cloud.discovery.CloudSinkDiscoveryService",chrome.gcm.onMessage);this.a=D("mr.CloudGcmEventListener")};ja(km,ej);km.prototype.Tz=function(a){a=jm(a,"data","notification");if(!a)return this.a.error("Notification json not found"),!1;try{var b=JSON.parse(a);return!!b&&Array.isArray(b.events)&&0<b.events.length}catch(c){return this.a.error("Invalid json: "+a),!1}};var mm=function(){lm||(lm=new km);return lm},lm=null;var nm=function(a,b,c,e,f,h,k){var n=Pi.ga().Zn(a);this.yb=new zi(n,b,h,k,f);this.deviceId=a;this.rma=c;this.model=e};nm.prototype.IX=function(a){return gb(this.rma,a)};var om=function(a,b,c,e,f){nm.call(this,a,b,["cloud"],"Chrome Streaming Receiver",e);this.xA=c;this.isAvailable=f};ja(om,nm);var pm=function(a){var b=a.xj(),c;a.To&&a.ai()!=a.To&&(c=a.To);nm.call(this,a.getId(),a.ai(),["mesi"],"Hangout",b,"hangout",c);this.dh=a.dh();this.zm=a.Am||""};ja(pm,nm);var qm=function(a,b,c){this.kna=a;this.he=b;this.Qi=new Map;this.iz=new Map;this.Mo=null;this.aba=c};d=qm.prototype;d.gf=function(){this.O1()&&(this.Mo=Date.now(),this.br());return Array.from(this.Qi.values())};d.rq=function(a){this.Qi.set(a.yb.id,a)};d.wm=function(a){return this.Qi.delete(a)};d.pa=function(a){return this.Qi.get(a)||null};d.O1=function(){var a=this.Mo+this.aba;return null==this.Mo||a<Date.now()};d.br=function(){var a=this;return this.kna().then(function(b){a.jna(b)})};
d.jna=function(a){var b=new Map(this.Qi),c=new Map,e=new Map,f=[],h=[];a.forEach(function(a){var k=a.yb.id;c.set(k,a);e.set(k,a.deviceId);b.has(k)?b.has(k)&&JSON.stringify(b.get(k))!=JSON.stringify(a)&&h.push(a.yb):f.push(a.yb);b.delete(k)});a=[].concat(ka(b.values())).map(function(a){return a.yb});this.iz.clear();this.iz=e;this.Qi.clear();this.Qi=c;this.L1(f,h,a)};d.L1=function(a,b,c){0<a.length&&this.he.OF(a);0<b.length&&this.he.sf(b);0<c.length&&this.he.fg(c)};
d.g=function(){for(var a={},b=ia(this.Qi.entries()),c=b.next();!c.done;c=b.next()){var e=ia(c.value),c=e.next().value,e=e.next().value;a[c]=e}b={};c=ia(this.iz.entries());for(e=c.next();!e.done;e=c.next()){var f=ia(e.value),e=f.next().value,f=f.next().value;b[e]=f}return new rm(a,b,this.Mo)};
d.qS=function(a){for(var b in a.sinks){var c=a.sinks[b],e=null;"Hangout"==c.model?e=new pm(new Ol(c.dh,c.deviceId,c.yb.domain,c.yb.description,c.yb.friendlyName,c.zm)):"Chrome Streaming Receiver"==c.model&&(e=new om(c.deviceId,c.yb.friendlyName,c.xA,c.yb.domain,c.isAvailable));this.Qi.set(b,e)}for(b in a.qL)this.iz.set(b,a.qL[b]);a.UR&&(this.Mo=a.UR)};d.JH=function(a){this.Mo=a};var rm=function(a,b,c){this.sinks=a;this.qL=b;this.UR=c};var sm=function(a){this.PB=a;this.a=D("mr.cloud.messaging.GcmMessageHandler")};sm.prototype.onMessage=function(a){var b=this;a=JSON.parse(a.data.notification);var c=Pi.ga();a.events.forEach(function(a){if(a.deviceId){var e=c.Zn(a.deviceId);switch(a.type){case "deviceCreated":b.Pba(a,e);break;case "deviceUpdated":b.Uba(a,e);break;case "deviceDeleted":b.Rba(e);break;default:b.a.C(function(){return"[unhandled event] "+JSON.stringify(a)})}}else b.a.error("Device ID not provided")})};
sm.prototype.Pba=function(a,b){var c=jm(a,"statePatch","_cloudCast","settings","receiverName");"string"!=typeof c?this.a.error("Receiver name not a string: "+c):(a=new om(a.deviceId,c,"owner","default",!0),this.PB.Oba({sinkId:b,cloudSink:a}))};sm.prototype.Uba=function(a,b){a=jm(a,"statePatch","_cloudCast","appStatus");"string"!=typeof a?this.a.error("App status not a string: "+a):this.PB.Tba({sinkId:b,isAvailable:"available"==a})};sm.prototype.Rba=function(a){this.PB.Qba({sinkId:a})};var tm=function(a,b){this.xB=a;this.he=b;this.Df=new qm(this.br.bind(this),b,2E4);this.XM=new sm(this);mm().addListener();Wh(this);Eh("mr.cloud.discovery.CloudSinkDiscoveryService",this)};ja(tm,uh);d=tm.prototype;d.gf=function(){var a=this;this.xB.Afa().then(function(b){a.xB.subscribe(b)},function(){});return this.Df.gf().filter(function(a){return a.isAvailable})};d.pa=function(a){return this.Df.pa(a)};
d.handleEvent=function(a,b){for(var c=[],e=1;e<arguments.length;++e)c[e-1]=arguments[e];if(a==chrome.gcm.onMessage)this.XM.onMessage.apply(this.XM,[].concat(ka(c)));else throw Error("Unhandled event: expected chrome.gcm.onMessage");};d.br=function(){return this.xB.Y$().then(function(a){return a.map(function(a){fh("MediaRouter.Cloud.CloudReceiver.Sink.Discovered");var b=a.isAvailable()&&!a.x$();return new om(a.getId(),a.ai(),a.Bc.personalizedInfo.maxRole,"default",b)})})};d.Ca=function(){return"CloudSinkDiscoveryService"};
d.getData=function(){return[{cache:this.Df.g()}]};d.tb=function(){var a=Th(this);a&&this.Df.qS(a.cache)};d.Oba=function(a){a=a.qva;this.Df.rq(a);this.Df.JH(Date.now());this.he.OF([a.yb])};d.Tba=function(a){var b=this.Df.pa(a.sinkId);b&&(b.isAvailable=a.isAvailable,this.Df.JH(Date.now()),this.he.sf([b.yb]))};d.Qba=function(a){if(a=this.Df.pa(a.sinkId))this.Df.wm(a.yb.id),this.Df.JH(Date.now()),this.he.fg([a.yb])};var wm=function(a,b,c){if(!um){Cf();var e=Bf;e.Ly(zf);e.f0(vm);um=!0}this.G1=a;this.Taa=b;this.xo=new qm(this.br.bind(this),c,2E4);this.ys=new Map;Wh(this)},vm=function(a){Ac({A:a.qaa,level:Dc(a.Jl.value),time:a.Dma,message:a.getMessage(),Wh:a.Yq})};wm.prototype.bK=function(a,b){a=new Ol(!1,a+"@"+b,b,a,void 0,void 0);this.ys.set(a.getId(),a);return a};wm.prototype.addManualHangout=wm.prototype.bK;wm.prototype.Qfa=function(a,b){this.gF(new Ol(!1,a+"@"+b,b,a,void 0,void 0))};
wm.prototype.removeManualHangout=wm.prototype.Qfa;d=wm.prototype;d.gf=function(){return this.xo.gf()};d.pa=function(a){return this.xo.pa(a)};
d.br=function(){var a=this;this.a.info("Fetching hangouts");return kj([this.Taa.F4(),this.G1.I4()]).then(function(b){var c=Array.from(a.ys.values());b.forEach(function(b){b.gl?c=c.concat(b.value):a.a.error("Error discovering Hangouts",b.reason)});var e=c.reduce(function(a,b){var c=a[b.getId()];c?c.merge(b):c=b;a[c.getId()]=c;return a},{});return Object.keys(e).map(function(b){b=e[b];fh("MediaRouter.Cloud.Hangout.Sink.Discovered");return a.gF(b)})})};d.gF=function(a){return new pm(a)};
d.h0=function(a){a=this.bK(a.input,a.domain);a=this.gF(a);this.xo.rq(a);return a.yb};d.Pfa=function(a){return this.ys.delete(a.deviceId)?(this.xo.wm(a.yb.id),!0):!1};d.Ca=function(){return"HangoutSinkDiscoveryService"};d.getData=function(){for(var a={},b=ia(this.ys.entries()),c=b.next();!c.done;c=b.next()){var e=ia(c.value),c=e.next().value,e=e.next().value;a[c]=e}return[{cache:this.xo.g(),manualHangouts:a}]};
d.tb=function(){var a=Th(this);if(a){this.xo.qS(a.cache);for(var b in a.manualHangouts){var c=a.manualHangouts[b];this.ys.set(b,new Ol(c.FR,c.Na,c.Vn,c.To,c.vg,c.Am))}}};d.a=D("mr.cloud.discovery.HangoutSinkDiscoveryService");var um=!1;var xm=function(a){this.td=a};d=xm.prototype;d.el=function(a,b,c){var e="";b.forEach(function(a){e+="/"+encodeURIComponent(a)});a=new Vj(a+e);c&&(c=fk(c),a.Ty(c));return a};d.fj=function(a,b,c){var e=this;return this.td.getAuthToken().then(function(f){var h=e.m5(f);return e.H1(h,a,b,c).catch(function(h){if("INVALID_ACCESS_ERROR"==h)return e.s4(f,a,b,c);throw h;})})};d.s4=function(a,b,c,e){var f=this;return this.td.r4(a).then(function(){return f.fj(b,c,e)})};
d.H1=function(a,b,c,e){var f=this;return new Promise(function(h,k){a.sendRequest(f.O4(b,c,function(a){a&&!a.error?h(a):f.t$(a)?k("INVALID_ACCESS_ERROR"):k(f.xda(a))},e))})};d.t$=function(a){return!!a&&401==a.error.code};d.m5=function(a){a=new Fl(void 0,void 0,void 0,!1,!1,a);a.init();return a};d.xda=function(a){return a&&a.error?a.error.errors?a.error.errors[0]:a:Error(a)};d.O4=function(a,b,c,e){a={callback:c,method:b,path:a.toString()};e&&(a.body=e);return a};var ym=function(){this.uh=!1;this.wg=null;this.Ko=!1;this.a=D("mr.cloud.identity.IdentityService");Wh(this);this.aaa();this.bX()};d=ym.prototype;d.s$=function(){return"google.com"==this.FQ()};d.K$=function(){return this.Ko||this.uh&&!!this.wg&&(-1!=zm.indexOf(this.wg)||-1!=zm.indexOf(this.FQ()))};d.FQ=function(){return this.wg?this.wg.substr(this.wg.indexOf("@")+1):""};
d.getAuthToken=function(){return chrome.identity?new Promise(function(a,b){chrome.identity.getAuthToken({interactive:!1},function(c){chrome.runtime.lastError?b(Error("Unable to get user auth token: "+chrome.runtime.lastError.message)):null==c?b(Error("User is not logged in (no token found)")):a(c)})}):Promise.reject(Error("chrome.identity permission required for auth."))};d.r4=function(a){return new Promise(function(b){chrome.identity.removeCachedAuthToken({token:a},function(){b()})})};
d.bX=function(){var a=this;this.getAuthToken().then(function(b){chrome.identity.getProfileUserInfo(function(c){a.uh=!!c.email||!!c.id;a.wg=c.email||null;b&&!a.uh&&(a.Ko=!0)})},function(b){a.a.C("Unable to set sign in and email.",b)})};d.aaa=function(){var a=this;chrome.identity.onSignInChanged.addListener(function(b,c){nh(6);a.uh=c;a.a.info("Signed in change: "+a.uh);a.uh?a.bX():(a.wg=null,a.Ko=!1)})};
d.sfa=function(){var a=this;return this.getAuthToken().then(function(b){var c=window.gapi;if(!c)return a.a.error("gapi not loaded."),!1;a.a.info("Setting gapi auth token");c.auth.setToken({access_token:b});return!0})};d.Ca=function(){return"IdentityService"};d.getData=function(){return[null,{signedIn:this.uh,userEmail:this.wg,kioskAuth:this.Ko}]};d.tb=function(){var a=Uh(this);a&&(a.signedIn&&(this.uh=a.signedIn),a.userEmail&&(this.wg=a.userEmail),a.kioskAuth&&(this.Ko=a.kioskAuth))};var zm="cloudview.test@gmail.com castouts.qa.nohangouts@gmail.com castouts.qa@gmail.com castouts-qa.com castouts-test.com google.com youtube.com nest.com waze.com netflix.com twitter.com yahoo.com salesforce.com whirlpool.com nytimes.com kohls.com squareup.com ivci.com".split(" ");var Am={wJ:{1E3:{other:"0K"},1E4:{other:"00K"},1E5:{other:"000K"},1E6:{other:"0M"},1E7:{other:"00M"},1E8:{other:"000M"},1E9:{other:"0B"},1E10:{other:"00B"},1E11:{other:"000B"},1E12:{other:"0T"},1E13:{other:"00T"},1E14:{other:"000T"}},qZ:{1E3:{other:"0 thousand"},1E4:{other:"00 thousand"},1E5:{other:"000 thousand"},1E6:{other:"0 million"},1E7:{other:"00 million"},1E8:{other:"000 million"},1E9:{other:"0 billion"},1E10:{other:"00 billion"},1E11:{other:"000 billion"},1E12:{other:"0 trillion"},1E13:{other:"00 trillion"},
1E14:{other:"000 trillion"}}},Bm=Am,Bm=Am;var Dm=function(a,b){var c=["0"];b=Cm[b][0]&7;if(0<b){c.push(".");for(var e=0;e<b;e++)c.push("0")}return a.replace(/0.00/g,c.join(""))},Cm={AED:[2,"dh","\u062f.\u0625.","DH"],ALL:[0,"Lek","Lek"],AUD:[2,"$","AU$"],BDT:[2,"\u09f3","Tk"],BGN:[2,"lev","lev"],BRL:[2,"R$","R$"],CAD:[2,"$","C$"],CDF:[2,"FrCD","CDF"],CHF:[2,"CHF","CHF"],CLP:[0,"$","CL$"],CNY:[2,"\u00a5","RMB\u00a5"],COP:[32,"$","COL$"],CRC:[0,"\u20a1","CR\u20a1"],CZK:[50,"K\u010d","K\u010d"],DKK:[50,"kr.","kr."],DOP:[2,"RD$","RD$"],EGP:[2,
"\u00a3","LE"],ETB:[2,"Birr","Birr"],EUR:[2,"\u20ac","\u20ac"],GBP:[2,"\u00a3","GB\u00a3"],HKD:[2,"$","HK$"],HRK:[2,"kn","kn"],HUF:[34,"Ft","Ft"],IDR:[0,"Rp","Rp"],ILS:[34,"\u20aa","IL\u20aa"],INR:[2,"\u20b9","Rs"],IRR:[0,"Rial","IRR"],ISK:[0,"kr","kr"],JMD:[2,"$","JA$"],JPY:[0,"\u00a5","JP\u00a5"],KRW:[0,"\u20a9","KR\u20a9"],LKR:[2,"Rs","SLRs"],LTL:[2,"Lt","Lt"],MNT:[0,"\u20ae","MN\u20ae"],MVR:[2,"Rf","MVR"],MXN:[2,"$","Mex$"],MYR:[2,"RM","RM"],NOK:[50,"kr","NOkr"],PAB:[2,"B/.","B/."],PEN:[2,"S/.",
"S/."],PHP:[2,"\u20b1","PHP"],PKR:[0,"Rs","PKRs."],PLN:[50,"z\u0142","z\u0142"],RON:[2,"RON","RON"],RSD:[0,"din","RSD"],RUB:[50,"\u20bd","RUB"],SAR:[2,"Rial","Rial"],SEK:[50,"kr","kr"],SGD:[2,"$","S$"],THB:[2,"\u0e3f","THB"],TRY:[2,"TL","YTL"],TWD:[2,"NT$","NT$"],TZS:[0,"TSh","TSh"],UAH:[2,"\u0433\u0440\u043d.","UAH"],USD:[2,"$","US$"],UYU:[2,"$","$U"],VND:[48,"\u20ab","VN\u20ab"],YER:[0,"Rial","Rial"],ZAR:[2,"R","ZAR"]};var Em={zJ:".",mA:",",GJ:"%",wA:"0",YZ:"+",PZ:"-",CJ:"E",HJ:"\u2030",nA:"\u221e",UZ:"NaN",yJ:"#,##0.###",v_:"#E0",XZ:"#,##0%",rZ:"\u00a4#,##0.00",uZ:"USD"},Fm=Em,Fm=Em;var Gm=function(a,b,c){this.es=b||Fm.uZ;this.m3=c||0;this.mx=40;this.cg=1;this.Pm=0;this.Sl=3;this.tx=this.xi=0;this.sX=this.GY=!1;this.Ss=this.lm="";this.Tj="-";this.Vo="";this.qf=1;this.bm=!1;this.zl=[];this.Qz=this.VL=!1;this.Eq=0;this.DK=null;"number"==typeof a?this.K0(a):this.rn(a)};d=Gm.prototype;d.xja=function(a){if(0<this.Pm&&0<a)throw Error("Can't combine significant digits and minimum fraction digits");this.xi=a;return this};d.sja=function(a){this.Sl=a;return this};
d.Mka=function(a){if(0<this.xi&&0<=a)throw Error("Can't combine significant digits and minimum fraction digits");this.Pm=a;return this};d.rn=function(a){a.replace(/ /g,"\u00a0");var b=[0];this.lm=this.Ix(a,b);var c=b[0];this.bea(a,b);c=b[0]-c;this.Ss=this.Ix(a,b);b[0]<a.length&&";"==a.charAt(b[0])?(b[0]++,1!=this.qf&&(this.bm=!0),this.Tj=this.Ix(a,b),b[0]+=c,this.Vo=this.Ix(a,b)):(this.Tj=this.lm+this.Tj,this.Vo+=this.Ss)};
d.K0=function(a){switch(a){case 1:this.rn(Fm.yJ);break;case 2:this.rn(Fm.v_);break;case 3:this.rn(Fm.XZ);break;case 4:this.rn(Dm(Fm.rZ,this.es));break;case 5:this.uK(1);break;case 6:this.uK(2);break;default:throw Error("Unsupported pattern type.");}};d.uK=function(a){this.Eq=a;this.rn(Fm.yJ);this.xja(0);this.sja(2);this.Mka(2)};
d.parse=function(a,b){b=b||[0];if(0!=this.Eq)throw Error("Parsing of compact numbers is unimplemented");var c;a=a.replace(/ /g,"\u00a0");var e=a.indexOf(this.lm,b[0])==b[0],f=a.indexOf(this.Tj,b[0])==b[0];e&&f&&(this.lm.length>this.Tj.length?f=!1:this.lm.length<this.Tj.length&&(e=!1));e?b[0]+=this.lm.length:f&&(b[0]+=this.Tj.length);a.indexOf(Fm.nA,b[0])==b[0]?(b[0]+=Fm.nA.length,c=Infinity):c=this.Kda(a,b);if(e){if(a.indexOf(this.Ss,b[0])!=b[0])return NaN;b[0]+=this.Ss.length}else if(f){if(a.indexOf(this.Vo,
b[0])!=b[0])return NaN;b[0]+=this.Vo.length}return f?-c:c};
d.Kda=function(a,b){var c=!1,e=!1,f=!1,h=1,k=Fm.zJ,n=Fm.mA,q=Fm.CJ;if(0!=this.Eq)throw Error("Parsing of compact style numbers is not implemented");for(var z="";b[0]<a.length;b[0]++){var B=a.charAt(b[0]),W=this.XN(B);if(0<=W&&9>=W)z+=W,f=!0;else if(B==k.charAt(0)){if(c||e)break;z+=".";c=!0}else if(B==n.charAt(0)&&("\u00a0"!=n.charAt(0)||b[0]+1<a.length&&0<=this.XN(a.charAt(b[0]+1)))){if(c||e)break}else if(B==q.charAt(0)){if(e)break;z+="E";e=!0}else if("+"==B||"-"==B)z+=B;else if(1==this.qf&&B==Fm.GJ.charAt(0)){if(1!=
h)break;h=100;if(f){b[0]++;break}}else if(1==this.qf&&B==Fm.HJ.charAt(0)){if(1!=h)break;h=1E3;if(f){b[0]++;break}}else break}1!=this.qf&&(h=this.qf);return parseFloat(z)/h};d.format=function(a){if(isNaN(a))return Fm.UZ;var b=[],c=this.h8(null===this.DK?a:this.DK,a);a/=Math.pow(10,c.RB);b.push(c.prefix);var e=0>a||0==a&&0>1/a;b.push(e?this.Tj:this.lm);isFinite(a)?(a=a*(e?-1:1)*this.qf,this.Qz?this.pma(a,b):this.tI(a,this.cg,b)):b.push(Fm.nA);b.push(e?this.Vo:this.Ss);b.push(c.HX);return b.join("")};
d.eV=function(a){var b=Math.pow(10,this.Sl),c=0>=this.Pm?Math.round(a*b):Math.round(this.Ega(a*b,this.Pm,this.Sl));isFinite(c)?(a=Math.floor(c/b),b=Math.floor(c-a*b)):b=0;return{uR:a,R4:b}};
d.tI=function(a,b,c){if(this.xi>this.Sl)throw Error("Min value must be less than max value");c||(c=[]);a=this.eV(a);var e=Math.pow(10,this.Sl),f=a.uR,h=a.R4,k=0==f?0:this.Gw(f)+1,n=0<this.xi||0<h||this.sX&&k<this.Pm;a=this.xi;n&&(a=this.sX&&0<this.Pm?this.Pm-k:this.xi);for(var q="",k=f;1E20<k;)q="0"+q,k=Math.round(k/10);var q=k+q,z=Fm.zJ,k=Fm.wA.charCodeAt(0),B=q.length,W=0;if(0<f||0<b){for(f=B;f<b;f++)c.push(String.fromCharCode(k));if(2<=this.zl.length)for(b=1;b<this.zl.length;b++)W+=this.zl[b];
b=B-W;if(0<b)for(var f=this.zl,W=B=0,Aa,Lf=Fm.mA,xe=q.length,Kd=0;Kd<xe;Kd++){if(c.push(String.fromCharCode(k+1*Number(q.charAt(Kd)))),1<xe-Kd)if(Aa=f[W],Kd<b){var gH=b-Kd;(1===Aa||0<Aa&&1===gH%Aa)&&c.push(Lf)}else W<f.length&&(Kd===b?W+=1:Aa===Kd-b-B+1&&(c.push(Lf),B+=Aa,W+=1))}else{b=q;q=this.zl;f=Fm.mA;Aa=b.length;Lf=[];for(B=q.length-1;0<=B&&0<Aa;B--){W=q[B];for(xe=0;xe<W&&0<=Aa-xe-1;xe++)Lf.push(String.fromCharCode(k+1*Number(b.charAt(Aa-xe-1))));Aa-=W;0<Aa&&Lf.push(f)}c.push.apply(c,Lf.reverse())}}else n||
c.push(String.fromCharCode(k));(this.VL||n)&&c.push(z);e=""+(h+e);for(h=e.length;"0"==e.charAt(h-1)&&h>a+1;)h--;for(f=1;f<h;f++)c.push(String.fromCharCode(k+1*Number(e.charAt(f))))};d.YJ=function(a,b){b.push(Fm.CJ);0>a?(a=-a,b.push(Fm.PZ)):this.GY&&b.push(Fm.YZ);a=""+a;for(var c=Fm.wA,e=a.length;e<this.tx;e++)b.push(c);b.push(a)};d.M6=function(a,b){var c=Math.pow(10,b);if(isFinite(c)&&0!==c)return a/c;c=Math.pow(10,Math.floor(b/2));a=a/c/c;1==b%2&&(a=0<b?a/10:10*a);return a};
d.pma=function(a,b){if(0==a)this.tI(a,this.cg,b),this.YJ(0,b);else{var c=Math.floor(Math.log(a)/Math.log(10)+2E-15);a=this.M6(a,c);var e=this.cg;if(1<this.mx&&this.mx>this.cg){for(;0!=c%this.mx;)a*=10,c--;e=1}else 1>this.cg?(c++,a/=10):(c-=this.cg-1,a*=Math.pow(10,this.cg-1));this.tI(a,e,b);this.YJ(c,b)}};d.XN=function(a){a=a.charCodeAt(0);if(48<=a&&58>a)return a-48;var b=Fm.wA.charCodeAt(0);return b<=a&&a<b+10?a-b:-1};
d.Ix=function(a,b){for(var c="",e=!1,f=a.length;b[0]<f;b[0]++){var h=a.charAt(b[0]);if("'"==h)b[0]+1<f&&"'"==a.charAt(b[0]+1)?(b[0]++,c+="'"):e=!e;else if(e)c+=h;else switch(h){case "#":case "0":case ",":case ".":case ";":return c;case "\u00a4":if(b[0]+1<f&&"\u00a4"==a.charAt(b[0]+1))b[0]++,c+=this.es;else switch(this.m3){case 0:c+=Cm[this.es][1];break;case 2:var h=this.es,k=Cm[h],c=c+(h==k[1]?h:h+" "+k[1]);break;case 1:c+=Cm[this.es][2]}break;case "%":if(!this.bm&&1!=this.qf)throw Error("Too many percent/permill");
if(this.bm&&100!=this.qf)throw Error("Inconsistent use of percent/permill characters");this.qf=100;this.bm=!1;c+=Fm.GJ;break;case "\u2030":if(!this.bm&&1!=this.qf)throw Error("Too many percent/permill");if(this.bm&&1E3!=this.qf)throw Error("Inconsistent use of percent/permill characters");this.qf=1E3;this.bm=!1;c+=Fm.HJ;break;default:c+=h}}return c};
d.bea=function(a,b){for(var c=-1,e=0,f=0,h=0,k=-1,n=a.length,q=!0;b[0]<n&&q;b[0]++)switch(a.charAt(b[0])){case "#":0<f?h++:e++;0<=k&&0>c&&k++;break;case "0":if(0<h)throw Error('Unexpected "0" in pattern "'+a+'"');f++;0<=k&&0>c&&k++;break;case ",":0<k&&this.zl.push(k);k=0;break;case ".":if(0<=c)throw Error('Multiple decimal separators in pattern "'+a+'"');c=e+f+h;break;case "E":if(this.Qz)throw Error('Multiple exponential symbols in pattern "'+a+'"');this.Qz=!0;this.tx=0;b[0]+1<n&&"+"==a.charAt(b[0]+
1)&&(b[0]++,this.GY=!0);for(;b[0]+1<n&&"0"==a.charAt(b[0]+1);)b[0]++,this.tx++;if(1>e+f||1>this.tx)throw Error('Malformed exponential pattern "'+a+'"');q=!1;break;default:b[0]--,q=!1}0==f&&0<e&&0<=c&&(f=c,0==f&&f++,h=e-f,e=f-1,f=1);if(0>c&&0<h||0<=c&&(c<e||c>e+f)||0==k)throw Error('Malformed pattern "'+a+'"');a=e+f+h;this.Sl=0<=c?a-c:0;0<=c&&(this.xi=e+f-c,0>this.xi&&(this.xi=0));this.cg=(0<=c?c:a)-e;this.Qz&&(this.mx=e+this.cg,0==this.Sl&&0==this.cg&&(this.cg=1));this.zl.push(Math.max(0,k));this.VL=
0==c||c==a};var Hm={prefix:"",HX:"",RB:0};Gm.prototype.AQ=function(a,b){var c=1==this.Eq?Bm.wJ:Bm.qZ;null==c&&(c=Bm.wJ);if(3>a)return Hm;a=Math.min(14,a);var e=c[Math.pow(10,a)];for(--a;!e&&3<=a;)e=c[Math.pow(10,a)],a--;if(!e)return Hm;b=e[b];return b&&"0"!=b?(b=/([^0]*)(0+)(.*)/.exec(b))?{prefix:b[1],HX:b[3],RB:a+1-(b[2].length-1)}:Hm:Hm};
Gm.prototype.h8=function(a,b){if(0==this.Eq)return Hm;a=Math.abs(a);b=this.AQ(1>=a?0:this.Gw(a),"other").RB;return this.AQ(b+this.Gw(this.eV(a/Math.pow(10,b)).uR),"other")};Gm.prototype.Gw=function(a){if(!isFinite(a))return 0<a?a:0;for(var b=0;1<=(a/=10);)b++;return b};Gm.prototype.Ega=function(a,b,c){if(!a)return a;b=b-this.Gw(a)-1;if(b<-c)return c=Math.pow(10,c),Math.round(a/c)*c;c=Math.pow(10,b);return Math.round(a*c)/c};var Im=function(a){return 1==a%10&&11!=a%100?"one":2==a%10&&12!=a%100?"two":3==a%10&&13!=a%100?"few":"other"},Jm=Im,Jm=Im;var Km=function(a,b){if(void 0===b){b=a+"";var c=b.indexOf(".");b=Math.min(-1==c?0:b.length-c-1,3)}return 1==(a|0)&&0==b?"one":"other"},Lm=Km,Lm=Km;var Mm=function(a){this.oR=[];this.Po=[];this.gG=[];this.yF=new Gm(1);this.Mda(a)},Nm=/'([{}#].*?)'/g,Om=/''/g;d=Mm.prototype;d.format=function(a){return this.Pv(a,!1)};d.Pv=function(a,b){if(0==this.gG.length)return"";this.Po=A(this.oR);var c=[];this.lC(this.gG,a,b,c);for(a=c.join("");0<this.Po.length;)a=a.replace(this.eB(this.Po),this.Po.pop());return a};
d.lC=function(a,b,c,e){for(var f=0;f<a.length;f++)switch(a[f].type){case 4:e.push(a[f].value);break;case 3:var h=a[f].value;this.Q4(h,b,e);break;case 2:h=a[f].value;this.P4(h,b,c,e);break;case 0:h=a[f].value;this.QM(h,b,Lm,c,e);break;case 1:h=a[f].value;this.QM(h,b,Jm,c,e);break;default:w("Unrecognized block type: "+a[f].type)}};d.Q4=function(a,b,c){b=b[a];l(b)?(this.Po.push(b),c.push(this.eB(this.Po))):c.push("Undefined parameter - "+a)};
d.P4=function(a,b,c,e){var f=a.Cu;l(b[f])?(f=a[b[f]],l(f)||(f=a.other),this.lC(f,b,c,e)):e.push("Undefined parameter - "+f)};d.QM=function(a,b,c,e,f){var h=a.Cu,k=a.wK,n=+b[h];isNaN(n)?f.push("Undefined or invalid parameter - "+h):(k=n-k,h=a[b[h]],l(h)||(c=this.yF.R6?c(k,this.yF.R6()):c(k),h=a[c],l(h)||(h=a.other)),a=[],this.lC(h,b,e,a),b=a.join(""),e?f.push(b):(e=this.yF.format(k),f.push(b.replace(/#/g,e))))};d.Mda=function(a){a&&(a=this.f$(a),this.gG=this.Jx(a))};
d.f$=function(a){var b=this.oR,c=t(this.eB,this);a=a.replace(Om,function(){b.push("'");return c(b)});return a=a.replace(Nm,function(a,f){b.push(f);return c(b)})};d.Iv=function(a){var b=0,c=[],e=[],f=/[{}]/g;f.lastIndex=0;for(var h;h=f.exec(a);){var k=h.index;"}"==h[0]?(c.pop(),0==c.length&&(h={type:1},h.value=a.substring(b,k),e.push(h),b=k+1)):(0==c.length&&(b=a.substring(b,k),""!=b&&e.push({type:0,value:b}),b=k+1),c.push("{"))}b=a.substring(b);""!=b&&e.push({type:0,value:b});return e};
var Pm=/^\s*(\w+)\s*,\s*plural\s*,(?:\s*offset:(\d+))?/,Qm=/^\s*(\w+)\s*,\s*selectordinal\s*,/,Rm=/^\s*(\w+)\s*,\s*select\s*,/;d=Mm.prototype;d.ida=function(a){return Pm.test(a)?0:Qm.test(a)?1:Rm.test(a)?2:/^\s*\w+\s*/.test(a)?3:5};
d.Jx=function(a){var b=[];a=this.Iv(a);for(var c=0;c<a.length;c++){var e={};if(0==a[c].type)e.type=4,e.value=a[c].value;else if(1==a[c].type)switch(this.ida(a[c].value)){case 2:e.type=2;e.value=this.Tda(a[c].value);break;case 0:e.type=0;e.value=this.Nda(a[c].value);break;case 1:e.type=1;e.value=this.Lda(a[c].value);break;case 3:e.type=3;e.value=a[c].value;break;default:w("Unknown block type for pattern: "+a[c].value)}else w("Unknown part of the pattern.");b.push(e)}return b};
d.Tda=function(a){var b="";a=a.replace(Rm,function(a,c){b=c;return""});var c={};c.Cu=b;a=this.Iv(a);for(var e=0;e<a.length;){var f=a[e].value;e++;if(1==a[e].type)var h=this.Jx(a[e].value);else w("Expected block type.");c[f.replace(/\s/g,"")]=h;e++}return c};
d.Nda=function(a){var b="",c=0;a=a.replace(Pm,function(a,e,f){b=e;f&&(c=parseInt(f,10));return""});var e={};e.Cu=b;e.wK=c;a=this.Iv(a);for(var f=0;f<a.length;){var h=a[f].value;f++;if(1==a[f].type)var k=this.Jx(a[f].value);else w("Expected block type.");e[h.replace(/\s*(?:=)?(\w+)\s*/,"$1")]=k;f++}return e};
d.Lda=function(a){var b="";a=a.replace(Qm,function(a,c){b=c;return""});var c={};c.Cu=b;c.wK=0;a=this.Iv(a);for(var e=0;e<a.length;){var f=a[e].value;e++;if(1==a[e].type)var h=this.Jx(a[e].value);else w("Expected block type.");c[f.replace(/\s*(?:=)?(\w+)\s*/,"$1")]=h;e++}return c};d.eB=function(a){return"\ufddf_"+(a.length-1).toString(10)+"_"};var Sm=chrome.i18n.getMessage("1522140683318860351"),Tm=chrome.i18n.getMessage("4246483347873264186"),Um=chrome.i18n.getMessage("5991427458288444010"),Vm=chrome.i18n.getMessage("6063910461797960050"),Wm=chrome.i18n.getMessage("7735695102441495789"),Xm=chrome.i18n.getMessage("4575332923598659024"),Ym=chrome.i18n.getMessage("2297080986956220930"),Zm=new Mm(Ym);var $m=function(a){this.Sb=a;this.a=D("mr.cloud.mesi.MesiService")};
$m.prototype.F4=function(){var a=Ml.aj;.1>Math.random()&&(a=a.replace("v1","v1_preprod"));a=this.Sb.el(a,["hangouts","search"]);this.a.info("Retrieving Hangouts from MESI: "+a);return this.Sb.fj(a,"POST",an).then(function(a){var b=[];a.result&&(b=a.result.map(function(a){var b=a.hangout,c=b.meeting_room_name,e;b.meeting_domain?e=b.meeting_domain:"BUSINESS"==b.type&&b.company_title&&(e=b.company_title.toLowerCase());var n=Zm.format({ORGANIZER:"",PARTICIPANTS:0});if((a=a.participant)&&0<a.length)var q=
a[0].display_name,n=a.reduce(function(a,b){a.add(b.user_id);"ORGANIZER"==b.role&&(q=b.display_name);return a},new Set),n=Zm.format({ORGANIZER:q,PARTICIPANTS:n.size});return c&&e?new Ol(!1,c+"@"+e,e,c,n,b.hangout_id):new Ol(!1,b.hangout_id,e,c,n,b.hangout_id)}));return b})};var an={request_header:{client_version:{client_id:"39"}},search_sources:["0"]};var bn=function(a,b,c){this.state=a;this.type=null!=b?b:null;this.results=null!=c?c:null},cn=function(a){this.Sb=a};d=cn.prototype;d.jha=function(a,b,c){var e=this;return this.tV(Wl,a,b,c,35E3).then(function(a){return e.WQ(a)})};d.oha=function(a,b,c){var e=this;return this.tV(Xl,a,b,c,23E3).then(function(a){var b=a.state;return"done"==b?(a=e.XT(a),new bn(b,a.type,new Tl(a.sessionDescription))):new bn(b)})};d.tha=function(a){return this.ph(a,Yl,{})};
d.tV=function(a,b,c,e,f){var h={_webrtcMessage:JSON.stringify(c.presentationUrl?new Tl(c.description,null,c.presentationUrl):new Tl(c.description))};c.settings&&(h._settings=c.settings.Fz());c.mediaConstraints&&(h._optMediaConstraints=JSON.stringify(c.mediaConstraints));e&&(h._user=JSON.stringify(e));return this.ph(b,a,h,f)};
d.WQ=function(a){var b=this,c=a.state;switch(c){case "done":return Promise.resolve(this.sda(a));case "queued":case "inProgress":return this.Cna(a).then(function(a){return b.WQ(a)});default:return Promise.resolve(new bn(c))}};d.Cna=function(a){var b=this;return new Promise(function(c){var e=setInterval(function(){b.w4(a.id).then(function(a){"queued"!=a.state&&"inProgress"!=a.state&&(clearInterval(e),c(a))})},2E3)})};
d.sda=function(a){a=this.XT(a);return"__cloud_webrtc_session_message__"==a.type?new bn("done","knocking_cloud_webrtc_session_message",new Tl(a.sessionDescription)):new bn("done",a.type)};d.ph=function(a,b,c,e){a={deviceId:a,name:"_cloudCast."+b.name,parameters:c,expirationTimeoutMs:e||1E4};b={};e&&(b.responseAwaitMs=Math.min(e+5E3,25E3));e=this.Sb.el(Kl.aj,["commands"],b);return this.Sb.fj(e,"POST",a)};d.XT=function(a){return a.results&&a.results.results?JSON.parse(a.results.results):null};
d.w4=function(a){a=this.Sb.el(Kl.aj,["commands",a]);return this.Sb.fj(a,"GET")};cn.$inject=["gapiService"];var dn=function(a,b,c,e){this.Zh=a;this.td=b;this.Yt=c;this.xc=e};d=dn.prototype;d.b9=function(a,b,c){var e=this;return this.dha(a,b,c).then(function(a){return e.G8(a,b.id)})};d.P8=function(a){var b=this;return this.Yt.P5().then(function(c){b.xc.Je(new Lh("TURN_CREDENTIALS",{credentials:c}),a.id)})};
d.dha=function(a,b,c){b=c.deviceId;var e=this.td.wg,e=e?new Rl(e):void 0;a=a.data;switch(c.xA){case "owner":im(0);break;case "manager":im(1);break;case "user":im(2);break;case "viewer":im(3)}return"viewer"==c.xA?this.Zh.jha(b,a,e):this.Zh.oha(b,a,e)};
d.G8=function(a,b){if("done"!=a.state)return Promise.reject(Error("Offer not executed by receiver. State: "+a.state));switch(a.type){case "__cloud_webrtc_session_message__":a=new Lh("ANSWER",a.results.sessionDescription);this.xc.Je(a,b);break;case "knocking_cloud_webrtc_session_message":fm(0);a=new Lh("KNOCK_ANSWER",a.results.sessionDescription);this.xc.Je(a,b);break;case "knock_denied":fm(1);this.VQ(Tm,b);break;case "knock_timeout":fm(2);this.VQ(Um,b);break;default:return Promise.reject(Error("Invalid message type: "+
a.type))}return Promise.resolve()};d.VQ=function(a,b){a=new Mg(a,"warning","dismiss");a.eja(!0);this.xc.ei().send(a);this.xc.Je(new Lh("STOP"),b)};var en=function(a,b){this.td=a;this.xc=b};
en.prototype.X8=function(a,b,c){var e=this;switch(a.type){case "REFRESH_AUTH":var f=c.dh,h=c.deviceId,k=c.zm;return this.td.sfa().then(function(){e.xc.Je(new Lh("AUTH_READY",{dh:f,ka:h,zm:k}),b.id)});case "LOCAL_PRESENT":return this.xc.Je(new Lh("AUTH_READY",{dh:c.dh,ka:c.deviceId,zm:c.zm,Ok:!a.data.local}),b.id),Promise.resolve();case "STATUS_REQUEST":return this.xc.Je(a,b.id),Promise.resolve();case "STATUS_RESPONSE":return this.xc.Je(a,b.id,!0),a.data.routeDescription||this.xc.Je(a,b.id),Promise.resolve();
case "HANGOUT_INACTIVE":return this.xc.Zm(b,4,new Mg(Wm,"warning","dismiss"));case "HANGOUT_INVALID":return this.xc.Zm(b,3,new Mg(Xm,"warning","dismiss"));default:return Promise.reject(Error("Unknown type: "+a.type))}};var fn=function(a,b,c){this.Hn=a;this.Zr=b;this.xc=c};
fn.prototype.Bea=function(a,b,c,e){var f=this;return new Promise(function(h){switch(a){case "cloud":case "mesi":break;default:throw Error("Unrecognized channel type");}if(!b.type)throw Error("Message has no type");switch(b.type){case "STOP":h(f.xc.Zm(c,1,null));return;case "SESSION_START_SUCCESS":gm(0);break;case "SESSION_END":break;case "SESSION_FAILURE":gm(1);h(f.xc.Zm(c,2,new Mg(Sm,"warning","dismiss")));return;case "__webrtc_stats__":break;case "PRESENTATION_CONNECTION_MESSAGE":f.xc.Je(b.data,
c.id,!0);break;case "OFFER":h(f.Hn.b9(b,c,e));return;case "GET_TURN_CREDENTIALS":h(f.Hn.P8(c));return;case "REFRESH_AUTH":case "LOCAL_PRESENT":case "MUTE":case "STATUS_REQUEST":case "STATUS_RESPONSE":case "HANGOUT_INACTIVE":case "HANGOUT_INVALID":h(f.Zr.X8(b,c,e));return;case "new_session":f.xc.Je(b,c.id,!0);break;case "remove_session":f.xc.Je(b,c.id,!0);f.xc.terminateRoute(c.id);break;default:throw Error("Unknown type: "+b.type);}h()})};var gn=function(){var a=this;this.a=D("mr.cloud.settings.SettingsService");this.CF=null;chrome.settingsPrivate.onPrefsChanged.addListener(function(b){nh(13);if(a.CF){b=ia(b);for(var c=b.next();!c.done;c=b.next())if(c=c.value,"media_router.cloudservices.enabled"==c.key){a.CF.call(null,c.value);break}}})};d=gn.prototype;d.Pja=function(a){this.CF=a};
d.Nma=function(){var a=this.a;chrome.storage.sync.set({"mr.cloud.cloudEnabled":!0},function(){chrome.runtime.lastError&&a.u("Error setting cloud setting: "+JSON.stringify(chrome.runtime.lastError))})};d.I5=function(){var a=this;return this.LN().catch(function(){return a.LN().catch(function(b){a.a.u("Error retrieving cloud on setting.",b);return!1})})};d.LN=function(){return this.JO("mr.cloud.cloudEnabled").then(function(a){return!!a["mr.cloud.cloudEnabled"]})};
d.JO=function(a){return new Promise(function(b,c){chrome.storage.sync.get(a,function(a){chrome.runtime.lastError?c(chrome.runtime.lastError):b(a)})})};d.G5=function(){var a=this;return this.KN().catch(function(){return a.KN().catch(function(b){a.a.u("Error retrieving cloud enabled setting.",b);return!1})})};d.KN=function(){return this.n7("media_router.cloudservices.enabled").then(function(a){return!!a.value})};
d.n7=function(a){return new Promise(function(b,c){chrome.settingsPrivate.getPref(a,function(a){chrome.runtime.lastError?c(chrome.runtime.lastError):b(a)})})};d.Oja=function(){var a=this.a;chrome.storage.sync.set({"mr.cloud.notifiedHangouts":!0},function(){chrome.runtime.lastError&&a.u("Error setting notified Hangout privacy.",chrome.runtime.lastError)})};
d.a7=function(){var a=this;return this.wP().catch(function(){return a.wP().catch(function(b){a.a.u("Error retrieving hangouts notified setting.",b);return!1})})};d.wP=function(){return this.JO("mr.cloud.notifiedHangouts").then(function(a){return!!a["mr.cloud.notifiedHangouts"]})};var hn=function(a){this.a=D("mr.cloud.CredentialService");this.Sb=a};hn.prototype.P5=function(){var a=this,b=new Ec,c=Nl.aj+"/iceconfig?key="+Nl.Oma;this.a.info("Requesting TURN credentials from "+c);var e=Pf(c,function(){return a.Zca(e,b)},"POST",void 0,{"Content-Type":"application/json"});return b.promise};hn.prototype.Zca=function(a,b){a.Od()?(this.a.info("Got TURN credentials: "+a.ff()),b.resolve(this.Yba(a.F7()))):b.resolve(this.Zba(null))};
hn.prototype.Yba=function(a){try{var b=[];a.iceServers.forEach(function(a){a.urls.forEach(function(c){0==c.indexOf("turn:")&&b.push({url:c,credential:a.credential,username:a.username})})});return b}catch(c){return this.a.error("Error parsing TURN credentials.",c),[]}};hn.prototype.Zba=function(a){this.a.error("XHR failed fetching TURN credentials.",a);return[]};var jn=function(){this.Yt=this.qg=this.Uo=this.Zr=this.Hn=this.Zh=this.kE=this.hB=this.oF=this.yB=this.wB=this.Sb=this.QA=null};d=jn.prototype;d.ci=function(){null==this.QA&&(this.QA=new ym);return this.QA};d.vr=function(){null==this.Sb&&(this.Sb=new xm(this.ci()));return this.Sb};d.F5=function(){null==this.wB&&(this.wB=new Zl(this.vr()));return this.wB};d.J5=function(a){null==this.yB&&(this.yB=new tm(this.F5(),a));return this.yB};d.P6=function(){null==this.oF&&(this.oF=new $m(this.vr()));return this.oF};
d.A5=function(){null==this.hB&&(this.hB=new Pl(this.vr(),this.ci()));return this.hB};d.w6=function(a){null==this.kE&&(this.kE=new wm(this.A5(),this.P6(),a));return this.kE};d.mO=function(){null==this.Zh&&(this.Zh=new cn(this.vr()));return this.Zh};d.H5=function(a){null==this.Hn&&(this.Hn=new dn(this.mO(),this.ci(),this.g8(),a));return this.Hn};d.v6=function(a){null==this.Zr&&(this.Zr=new en(this.ci(),a));return this.Zr};d.Q6=function(a){null==this.Uo&&(this.Uo=new fn(this.H5(a),this.v6(a),a));return this.Uo};
d.U7=function(){null==this.qg&&(this.qg=new gn);return this.qg};d.g8=function(){null==this.Yt&&(this.Yt=new hn(this.vr()));return this.Yt};oa(jn);
